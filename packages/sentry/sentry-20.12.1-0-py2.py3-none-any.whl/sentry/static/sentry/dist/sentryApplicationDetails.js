(window.sntryWpJsonp=window.sntryWpJsonp||[]).push([[223],{1938:function(e,t,n){"use strict";n.d(t,"a",(function(){return m}));var r=n(9),o=n.n(r),i=n(10),a=n.n(i),c=n(12),s=n.n(c),u=n(13),l=n.n(u),f=n(5),p=n.n(f),d=(n(1),n(247)),b=n.n(d),h=n(408),v=n(0);function y(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=p()(e);if(t){var o=p()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return l()(this,n)}}var m=function(e){s()(n,e);var t=y(n);function n(){return o()(this,n),t.apply(this,arguments)}return a()(n,[{key:"getTitle",value:function(){return""}},{key:"render",value:function(){var e=this.getTitle();return Object(v.f)(b.a,{title:"".concat(e?"".concat(e," - "):"","Sentry")},this.renderComponent())}}]),n}(h.a);m.displayName="AsyncView"},1939:function(e,t,n){"use strict";var r=n(16),o=n.n(r),i=n(9),a=n.n(i),c=n(10),s=n.n(c),u=n(12),l=n.n(u),f=n(13),p=n.n(f),d=n(5),b=n.n(d),h=n(3),v=n(1),y=n.n(v),m=n(204),O=n(8),j=n(0);function g(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=b()(e);if(t){var o=b()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return p()(this,n)}}var w=function(e){l()(n,e);var t=g(n);function n(){return a()(this,n),t.apply(this,arguments)}return s()(n,[{key:"render",value:function(){var e=this.props,t=e.icon,n=e.title,r=e.subtitle,i=e.action,a=e.tabs,c=e.noTitleStyles,s=o()(e,["icon","title","subtitle","action","tabs","noTitleStyles"]);return Object(j.f)("div",s,Object(j.f)(k,null,Object(j.f)(S,null,t&&Object(j.f)(R,null,t),n&&Object(j.f)(x,{tabs:a,styled:c},Object(j.f)(m.a,null,n),r&&Object(j.f)(P,null,r))),i&&Object(j.f)(D,{tabs:a},i)),a&&Object(j.f)("div",null,a))}}]),n}(y.a.Component);w.displayName="UnstyledSettingsPageHeader",w.defaultProps={noTitleStyles:!1};var k=Object(h.a)("div",{target:"e1uay4fd0",label:"TitleAndActions"})({name:"70qvj9",styles:"display:flex;align-items:center;"}),S=Object(h.a)("div",{target:"e1uay4fd1",label:"TitleWrapper"})({name:"1rr4qq7",styles:"flex:1;"}),x=Object(h.a)("div",{target:"e1uay4fd2",label:"Title"})((function(e){return!e.styled&&"\n    font-size: 20px;\n    font-weight: bold;"}),";margin:",(function(e){return e.tabs?"".concat(Object(O.a)(4)," ").concat(Object(O.a)(2)," ").concat(Object(O.a)(2)," 0"):"".concat(Object(O.a)(4)," ").concat(Object(O.a)(2)," ").concat(Object(O.a)(4)," 0")}),";"),P=Object(h.a)("div",{target:"e1uay4fd3",label:"Subtitle"})("color:",(function(e){return e.theme.gray400}),";font-weight:400;font-size:",(function(e){return e.theme.fontSizeLarge}),";padding:",Object(O.a)(1.5)," 0 ",Object(O.a)(3),";"),R=Object(h.a)("div",{target:"e1uay4fd4",label:"Icon"})("margin-right:",Object(O.a)(1),";"),D=Object(h.a)("div",{target:"e1uay4fd5",label:"Action"})((function(e){return e.tabs?"margin-top: ".concat(Object(O.a)(2)):null}),";"),C=Object(h.a)(w,{target:"e1uay4fd6",label:"SettingsPageHeader"})("font-size:14px;margin-top:-",Object(O.a)(4),";");t.a=C},1941:function(e,t,n){"use strict";t.a=function(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],r="".concat(e," - ").concat(t);return n?"".concat(r," - Sentry"):r}},1945:function(e,t,n){"use strict";var r=n(6),o=n.n(r),i=n(7),a=n.n(i),c=n(16),s=n.n(c),u=n(9),l=n.n(u),f=n(10),p=n.n(f),d=n(12),b=n.n(d),h=n(13),v=n.n(h),y=n(5),m=n.n(y),O=n(1),j=n.n(O),g=n(47),w=n(2),k=n.n(w),S=n(278),x=n(677),P=n.n(x),R=n(21),D=n(674),C=n(1947),I=n(0);function T(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function F(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?T(Object(n),!0).forEach((function(t){a()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):T(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function E(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=m()(e);if(t){var o=m()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return v()(this,n)}}var A=function(e){b()(n,e);var t=E(n);function n(){var e;l()(this,n);for(var r=arguments.length,o=new Array(r),i=0;i<r;i++)o[i]=arguments[i];return(e=t.call.apply(t,[this].concat(o))).state={highlighted:z(e.props,e.context).hash},e}return p()(n,[{key:"componentDidMount",value:function(){this.scrollToHash()}},{key:"UNSAFE_componentWillReceiveProps",value:function(e){if(z(this.props,this.context).hash!==z(e,this.context).hash){var t=z(e,this.context).hash;this.scrollToHash(t),this.setState({highlighted:t})}}},{key:"scrollToHash",value:function(e){var t=e||z(this.props,this.context).hash;if(t)try{P()(Object(D.a)(decodeURIComponent(t)),{align:"middle",offset:-100})}catch(e){g.c(e)}}},{key:"shouldDisplayForm",value:function(e){var t=e.filter((function(e){return"function"!=typeof e&&Object(R.d)(null==e?void 0:e.visible)}));if(e.length===t.length){var n=this.props,r=n.additionalFieldProps,o=s()(n,["additionalFieldProps"]);return!t.every((function(e){return"function"==typeof e.visible?!e.visible(F(F({},o),r)):!e.visible}))}return!0}},{key:"renderForm",value:function(e){var t=e.fields,n=e.formPanelProps,r=e.title;return this.shouldDisplayForm(t)||(null==n?void 0:n.renderFooter)||(null==n?void 0:n.renderHeader)?Object(I.f)(C.a,o()({title:r,fields:t},n)):null}},{key:"render",value:function(){var e=this,t=this.props,n=t.access,r=t.fields,o=t.title,i=t.forms,a=t.disabled,c=t.features,u=t.additionalFieldProps,l=t.renderFooter,f=t.renderHeader,p=(t.location,s()(t,["access","fields","title","forms","disabled","features","additionalFieldProps","renderFooter","renderHeader","location"])),d={access:n,disabled:a,features:c,additionalFieldProps:u,renderFooter:l,renderHeader:f,highlighted:this.state.highlighted};return Object(I.f)(S.Box,p,void 0!==i&&i.map((function(t,n){return Object(I.f)(j.a.Fragment,{key:n},e.renderForm(F({formPanelProps:d},t)))})),void 0===i&&void 0!==r&&this.renderForm({fields:r,formPanelProps:d,title:o}))}}]),n}(j.a.Component);function z(e,t){return e.location||t.location||{}}A.displayName="JsonForm",A.contextTypes={location:k.a.object},A.defaultProps={additionalFieldProps:{}},t.a=A},1947:function(e,t,n){"use strict";n.d(t,"a",(function(){return S}));var r=n(6),o=n.n(r),i=n(16),a=n.n(i),c=n(9),s=n.n(c),u=n(10),l=n.n(u),f=n(12),p=n.n(f),d=n(13),b=n.n(d),h=n(5),v=n.n(h),y=n(1),m=n.n(y),O=n(164),j=n(674),g=n(1964),w=n(0);function k(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=v()(e);if(t){var o=v()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return b()(this,n)}}var S=function(e){p()(n,e);var t=k(n);function n(){return s()(this,n),t.apply(this,arguments)}return l()(n,[{key:"render",value:function(){var e=this,t=this.props,n=t.title,r=t.fields,i=t.access,c=t.disabled,s=t.additionalFieldProps,u=t.renderFooter,l=t.renderHeader,f=a()(t,["title","fields","access","disabled","additionalFieldProps","renderFooter","renderHeader"]);return Object(w.f)(O.a,{id:"string"==typeof n?Object(j.a)(n):void 0},n&&Object(w.f)(O.e,null,n),Object(w.f)(O.c,null,"function"==typeof l&&l({title:n,fields:r}),r.map((function(t){if("function"==typeof t)return t();t.defaultValue;var n=a()(t,["defaultValue"]);return!0===c&&(n.disabled=!0,n.disabledReason=void 0),Object(w.f)(g.a,o()({access:i,disabled:c,key:t.name},f,s,{field:n,highlighted:e.props.highlighted==="#".concat(t.name)}))})),"function"==typeof u&&u({title:n,fields:r})))}}]),n}(m.a.Component);S.displayName="FormPanel"},2073:function(e,t,n){var r=n(689),o=n(1101),i=Object.prototype.hasOwnProperty,a=o((function(e,t,n){i.call(e,n)?e[n].push(t):r(e,n,[t])}));e.exports=a},2163:function(e,t,n){"use strict";n.d(t,"a",(function(){return k})),n.d(t,"b",(function(){return w}));var r=n(33),o=n.n(r),i=n(28),a=n.n(i),c=n(7),s=n.n(c),u=n(2073),l=n.n(u),f=n(2164),p=n.n(f),d=n(276),b=n.n(d);function h(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function v(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?h(Object(n),!0).forEach((function(t){s()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):h(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var y={read:0,write:1,admin:2},m={project:"Project",team:"Team",release:"Release",event:"Event",org:"Organization",member:"Member"},O={Project:"no-access",Team:"no-access",Release:"no-access",Event:"no-access",Organization:"no-access",Member:"no-access"},j=function(e){var t=e.split(":")[1];return y[t]},g=function(e,t){return j(e)-j(t)};function w(e){var t,n=v({},O),r=a()(e);return e.includes("project:releases")&&(n.Release="admin",r=e.filter((function(e){return"project:releases"!==e}))),(t=r,Object.values(l()(t,(function(e){return e.split(":")[0]}))).map((function(e){return e.sort(g)})).map((function(e){return e.pop()}))).forEach((function(e){if(e){var t=e.split(":"),r=o()(t,2),i=r[0],a=r[1];n[m[i]]=a}})),n}function k(e){var t=w(e),n=b()(p()(t),["read","write","admin"]);return v(v({},{read:[],write:[],admin:[]}),n)}},2164:function(e,t,n){var r=n(281),o=n(2165),i=Object.prototype,a=i.hasOwnProperty,c=i.toString,s=o((function(e,t,n){null!=t&&"function"!=typeof t.toString&&(t=c.call(t)),a.call(e,t)?e[t].push(n):e[t]=[n]}),r);e.exports=s},2165:function(e,t,n){var r=n(2166);e.exports=function(e,t){return function(n,o){return r(n,e,t(o),{})}}},2166:function(e,t,n){var r=n(711);e.exports=function(e,t,n,o){return r(e,(function(e,r,i){t(o,n(e),r,i)})),o}},2256:function(e,t,n){"use strict";n.r(t),n.d(t,"publicIntegrationForms",(function(){return l})),n.d(t,"internalIntegrationForms",(function(){return f}));n(1);var r,o,i=n(58),a=n(4),c=n(21),s=n(0),u=function(){return[{name:"name",type:"string",required:!0,placeholder:"e.g. My Integration",label:"Name",help:"Human readable name of your Integration."},{name:"author",type:"string",required:!0,placeholder:"e.g. Acme Software",label:"Author",help:"The company or person who built and maintains this Integration."},{name:"webhookUrl",type:"string",required:!0,label:"Webhook URL",placeholder:"e.g. https://example.com/sentry/webhook/",help:Object(a.c)("All webhook requests for your integration will be sent to this URL. Visit the [webhook_docs:documentation] to see the different types and payloads.",{webhook_docs:Object(s.f)(i.a,{href:"https://docs.sentry.io/workflow/integrations/integration-platform/webhooks/"})})},{name:"redirectUrl",type:"string",label:"Redirect URL",placeholder:"e.g. https://example.com/sentry/setup/",help:"The URL Sentry will redirect users to after installation."},{name:"verifyInstall",label:"Verify Installation",type:"boolean",help:"If enabled, installations will need to be verified before becoming installed."},{name:"isAlertable",type:"boolean",label:"Alert Rule Action",disabled:function(e){return e.webhookDisabled},disabledReason:"Cannot enable alert rule action without a webhook url",help:Object(a.c)("If enabled, this integration will be available in Issue Alert rules and Metric Alert rules in Sentry. The notification destination is the Webhook URL specified above. More on actions [learn_more:here].",{learn_more:Object(s.f)(i.a,{href:"https://docs.sentry.io/product/notifications/#actions"})})},{name:"schema",type:"textarea",label:"Schema",autosize:!0,help:Object(a.c)("Schema for your UI components. Click [schema_docs:here] for documentation.",{schema_docs:Object(s.f)(i.a,{href:"https://docs.sentry.io/workflow/integrations/integration-platform/ui-components/"})}),getValue:function(e){return""===e?{}:JSON.parse(e)},setValue:function(e){var t=JSON.stringify(e,null,2);return"{}"===t?"":t},validate:function(e){var t=e.id,n=e.form;if(!n.schema)return[];try{JSON.parse(n.schema)}catch(e){return[[t,"Invalid JSON"]]}return[]}},{name:"overview",type:"textarea",label:"Overview",autosize:!0,help:"Description of your Integration and its functionality."},{name:"allowedOrigins",type:"string",multiline:!0,placeholder:"e.g. example.com",label:"Authorized JavaScript Origins",help:"Separate multiple entries with a newline.",getValue:function(e){return Object(c.i)(e)},setValue:function(e){return e&&"function"==typeof e.join&&e.join("\n")||""}}]},l=[{title:"Public Integration Details",fields:u()}],f=[{title:"Internal Integration Details",fields:(r=u().filter((function(e){return!["redirectUrl","verifyInstall","author"].includes(e.name||"")})),o=r.find((function(e){return"webhookUrl"===e.name})),o&&(o.required=!1),r)}]},2471:function(e,t,n){var r=n(2472)(n(1061));e.exports=r},2472:function(e,t,n){var r=n(281),o=n(282),i=n(316);e.exports=function(e){return function(t,n,a){var c=Object(t);if(!o(t)){var s=r(n,3);t=i(t),n=function(e){return s(c[e],e,c)}}var u=e(t,n,a);return u>-1?c[s?t[u]:u]:void 0}}},2912:function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return He}));var r=n(28),o=n.n(r),i=n(7),a=n.n(i),c=n(22),s=n.n(c),u=n(30),l=n.n(u),f=n(19),p=n.n(f),d=n(115),b=n.n(d),h=n(33),v=n.n(h),y=n(9),m=n.n(y),O=n(10),j=n.n(O),g=n(12),w=n.n(g),k=n(13),S=n.n(k),x=n(5),P=n.n(x),R=n(3),D=n(1),C=n.n(D),I=n(11),T=n(131),F=n.n(T),E=n(264),A=n(677),z=n.n(A),N=n(35),U=n(4);function q(e,t){return V.apply(this,arguments)}function V(){return(V=l()(s.a.mark((function e(t,n){var r;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return Object(N.b)(),e.prev=1,e.next=4,t.requestPromise("/sentry-apps/".concat(n.slug,"/api-tokens/"),{method:"POST"});case 4:return r=e.sent,Object(N.d)(Object(U.b)("Token successfully added.")),e.abrupt("return",r);case 9:throw e.prev=9,e.t0=e.catch(1),Object(N.a)(Object(U.b)("Unable to create token")),e.t0;case 13:case"end":return e.stop()}}),e,null,[[1,9]])})))).apply(this,arguments)}function H(e,t,n){return L.apply(this,arguments)}function L(){return(L=l()(s.a.mark((function e(t,n,r){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return Object(N.b)(),e.prev=1,e.next=4,t.requestPromise("/sentry-apps/".concat(n.slug,"/api-tokens/").concat(r,"/"),{method:"DELETE"});case 4:return Object(N.d)(Object(U.b)("Token successfully deleted.")),e.abrupt("return");case 8:throw e.prev=8,e.t0=e.catch(1),Object(N.a)(Object(U.b)("Unable to delete token")),e.t0;case 12:case"end":return e.stop()}}),e,null,[[1,8]])})))).apply(this,arguments)}var J=n(29),_=n(412),M=n(164),W=n(31),B=n(32),G=n(2256),Y=n(15),$=n(191),K=n(1941),Q=n(1938),X=n(411),Z=n(1944),ee=n(692),te=n(1945),ne=n(2102),re=n(680),oe=n(1939),ie=n(2),ae=n.n(ie),ce=n(2163),se=n(2471),ue=n.n(se),le=n(731),fe=n.n(le),pe=n(686),de=n(0);function be(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=P()(e);if(t){var o=P()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return S()(this,n)}}var he=function(e){w()(n,e);var t=be(n);function n(){var e;m()(this,n);for(var r=arguments.length,o=new Array(r),i=0;i<r;i++)o[i]=arguments[i];return(e=t.call.apply(t,[this].concat(o))).state={permissions:e.props.permissions},e.onChange=function(t,n){var r=e.state.permissions;r[t]=n,e.save(r)},e.save=function(t){e.setState({permissions:t}),e.props.onChange(t),e.context.form.setValue("scopes",e.permissionStateToList())},e}return j()(n,[{key:"permissionStateToList",value:function(){var e=this.state.permissions;return fe()(Object.entries(e),(function(e){var t,n,r,o=v()(e,2),i=o[0],a=o[1];return null===(t=function(e){return ue()(B.E,["resource",e])}(i))||void 0===t?void 0:null===(n=t.choices)||void 0===n?void 0:null===(r=n[a])||void 0===r?void 0:r.scopes}))}},{key:"render",value:function(){var e=this,t=this.state.permissions;return Object(de.f)(C.a.Fragment,null,B.E.map((function(n){var r=Object.entries(n.choices).map((function(e){var t=v()(e,2);return[t[0],t[1].label]})),o=t[n.resource];return Object(de.f)(pe.a,{deprecatedSelectControl:!0,name:"".concat(n.resource,"--permission"),key:n.resource,choices:r,help:Object(U.b)(n.help),label:Object(U.b)(n.label||n.resource),onChange:e.onChange.bind(e,n.resource),value:o,defaultValue:o,disabled:e.props.appPublished,disabledReason:Object(U.b)("Cannot update permissions on a published integration")})})))}}]),n}(C.a.Component);he.displayName="PermissionSelection",he.contextTypes={router:ae.a.object.isRequired,form:ae.a.object};var ve=["issue","error"],ye={issue:"created, resolved, assigned",error:"created"},me={issue:"Event",error:"Event"},Oe=n(309),je=n(57);function ge(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=P()(e);if(t){var o=P()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return S()(this,n)}}var we=function(e){w()(n,e);var t=ge(n);function n(){var e;m()(this,n);for(var r=arguments.length,o=new Array(r),i=0;i<r;i++)o[i]=arguments[i];return(e=t.call.apply(t,[this].concat(o))).onChange=function(t){var n=t.target.checked,r=e.props.resource;e.props.onChange(r,n)},e}return j()(n,[{key:"render",value:function(){var e=this.props,t=e.resource,n=e.organization,r=e.webhookDisabled,o=e.checked,i=new Set(n.features),a=this.props.disabledFromPermissions||r,c="Must have at least 'Read' permissions enabled for ".concat(t);return"error"!==t||i.has("integrations-event-hooks")||(a=!0,c="Your organization does not have access to the error subscription resource."),r&&(c="Cannot enable webhook subscription without specifying a webhook url"),Object(de.f)(C.a.Fragment,null,Object(de.f)(Pe,{key:t},Object(de.f)(W.a,{disabled:!a,title:c},Object(de.f)(xe,{disabled:a},Object(de.f)(Se,null,Object(de.f)(De,null,Object(U.b)("".concat(t))),Object(de.f)(Re,null,Object(U.b)("".concat(ye[t])))),Object(de.f)(Oe.a,{key:"".concat(t).concat(o),disabled:a,id:t,value:t,checked:o,onChange:this.onChange})))))}}]),n}(C.a.Component);we.displayName="SubscriptionBox",we.defaultProps={webhookDisabled:!1};var ke=Object(je.a)(we),Se=Object(R.a)("div",{target:"e146sawj0",label:"SubscriptionInfo"})({name:"j7qwjs",styles:"display:flex;flex-direction:column;"}),xe=Object(R.a)("div",{target:"e146sawj1",label:"SubscriptionGridItem"})("display:flex;flex-direction:row;justify-content:space-between;background:",(function(e){return e.theme.backgroundSecondary}),";opacity:",(function(e){return e.disabled?.3:1}),";border-radius:3px;flex:1;padding:12px;height:100%;"),Pe=Object(R.a)("div",{target:"e146sawj2",label:"SubscriptionGridItemWrapper"})({name:"ys2khs",styles:"padding:12px;width:33%;"}),Re=Object(R.a)("div",{target:"e146sawj3",label:"SubscriptionDescription"})("font-size:12px;line-height:1;color:",(function(e){return e.theme.gray300}),";white-space:nowrap;"),De=Object(R.a)("div",{target:"e146sawj4",label:"SubscriptionTitle"})("font-size:16px;line-height:1;color:",(function(e){return e.theme.textColor}),";white-space:nowrap;margin-bottom:5px;");function Ce(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=P()(e);if(t){var o=P()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return S()(this,n)}}var Ie=function(e){w()(n,e);var t=Ce(n);function n(e,r){var o;return m()(this,n),(o=t.call(this,e,r)).onChange=function(e,t){var n=new Set(o.props.events);t?n.add(e):n.delete(e),o.save(Array.from(n))},o.save=function(e){o.props.onChange(e),o.context.form.setValue("events",e)},o.context.form.setValue("events",o.props.events),o}return j()(n,[{key:"UNSAFE_componentWillReceiveProps",value:function(e){e.webhookDisabled&&this.props.events.length&&this.save([])}},{key:"componentDidUpdate",value:function(){var e=this.props,t=e.permissions,n=e.events,r=n.filter((function(e){return"no-access"!==t[me[e]]}));JSON.stringify(n)!==JSON.stringify(r)&&this.save(r)}},{key:"render",value:function(){var e=this,t=this.props,n=t.permissions,r=t.webhookDisabled,o=t.events;return Object(de.f)(Te,null,ve.map((function(t){var i="no-access"===n[me[t]];return Object(de.f)(C.a.Fragment,{key:t},Object(de.f)(ke,{key:t,disabledFromPermissions:i,webhookDisabled:r,checked:o.includes(t)&&!i,resource:t,onChange:e.onChange}))})))}}]),n}(C.a.Component);Ie.displayName="Subscriptions",Ie.contextTypes={router:ae.a.object.isRequired,form:ae.a.object},Ie.defaultProps={webhookDisabled:!1};var Te=Object(R.a)("div",{target:"eglb30u0",label:"SubscriptionGrid"})({name:"2imjyh",styles:"display:flex;flex-wrap:wrap;"});function Fe(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=P()(e);if(t){var o=P()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return S()(this,n)}}var Ee=function(e){w()(n,e);var t=Fe(n);function n(e){var r;return m()(this,n),(r=t.call(this,e)).onPermissionChange=function(e){r.setState({permissions:e})},r.onEventChange=function(e){r.setState({events:e})},r.state={permissions:r.scopeListToPermissionState(),events:r.props.events},r}return j()(n,[{key:"scopeListToPermissionState",value:function(){return Object(ce.b)(this.props.scopes)}},{key:"render",value:function(){var e=this.state,t=e.permissions,n=e.events;return Object(de.f)(C.a.Fragment,null,Object(de.f)(M.a,null,Object(de.f)(M.e,null,Object(U.b)("Permissions")),Object(de.f)(M.c,null,Object(de.f)(he,{permissions:t,onChange:this.onPermissionChange,appPublished:this.props.appPublished}))),Object(de.f)(M.a,null,Object(de.f)(M.e,null,Object(U.b)("Webhooks")),Object(de.f)(M.c,null,Object(de.f)(Ie,{permissions:t,events:n,onChange:this.onEventChange,webhookDisabled:this.props.webhookDisabled}))))}}]),n}(C.a.Component);function Ae(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ze(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ae(Object(n),!0).forEach((function(t){a()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ae(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Ne(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=P()(e);if(t){var o=P()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return S()(this,n)}}function Ue(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return qe(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return qe(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,c=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return a=e.done,e},e:function(e){c=!0,i=e},f:function(){try{a||null==n.return||n.return()}finally{if(c)throw i}}}}function qe(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}Ee.displayName="PermissionsObserver",Ee.contextTypes={router:ae.a.object.isRequired,form:ae.a.object},Ee.defaultProps={webhookDisabled:!1,appPublished:!1};var Ve=function(e){w()(n,e);var t=Ne(n);function n(){return m()(this,n),t.apply(this,arguments)}return j()(n,[{key:"getData",value:function(){return Object.entries(this.fields.toJSON()).reduce((function(e,t){var n=v()(t,2),r=n[0],o=n[1];return r.endsWith("--permission")||(e[r]=o),e}),{})}},{key:"mapFormErrors",value:function(e){if(!e)return e;var t=F()(e,["scopes"]);return e.scopes&&e.scopes.forEach((function(e){var n=e.match(/Requested permission of (\w+:\w+)/);if(n){var r=function(e){var t,n=Ue(B.E);try{for(n.s();!(t=n.n()).done;){var r=t.value;if(Object.values(r.choices).reduce((function(e,t){var n;return e.concat(null!==(n=null==t?void 0:t.scopes)&&void 0!==n?n:[])}),[]).includes(e))return r.resource}}catch(e){n.e(e)}finally{n.f()}}(n[1]);r&&(t["".concat(r,"--permission")]=[e])}})),t}}]),n}(ne.a),He=function(e){w()(n,e);var t=Ne(n);function n(){var e;m()(this,n);for(var r=arguments.length,o=new Array(r),i=0;i<r;i++)o[i]=arguments[i];return(e=t.call.apply(t,[this].concat(o))).form=new Ve,e.handleSubmitSuccess=function(t){var n=e.state.app,r=e.props.params.orgId,o="/settings/".concat(r,"/developer-settings/"),i=n?o:"".concat(o).concat(t.slug,"/");n?Object(N.d)(Object(U.b)("%s successfully saved.",t.name)):Object(N.d)(Object(U.b)("%s successfully created.",t.name)),I.browserHistory.push(i)},e.handleSubmitError=function(t){var n,r=Object(U.b)("Unknown Error");t.status>=400&&t.status<500&&(r=null!==(n=null==t?void 0:t.responseJSON.detail)&&void 0!==n?n:r);if(Object(N.a)(r),e.form.formErrors){var o=Object.keys(e.form.formErrors)[0];o&&z()("#".concat(o),{align:"middle",offset:0})}},e.onAddToken=function(){var t=l()(s.a.mark((function t(n){var r,o,i,a,c,u;return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n.preventDefault(),r=e.state,o=r.app,i=r.tokens,o){t.next=4;break}return t.abrupt("return");case 4:return a=e.api,t.next=7,q(a,o);case 7:c=t.sent,u=i.concat(c),e.setState({tokens:u});case 10:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e.onRemoveToken=function(){var t=l()(s.a.mark((function t(n,r){var o,i,a,c,u;return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r.preventDefault(),o=e.state,i=o.app,a=o.tokens,i){t.next=4;break}return t.abrupt("return");case 4:return c=e.api,u=a.filter((function(e){return e.token!==n.token})),t.next=8,H(c,i,n.token);case 8:e.setState({tokens:u});case 9:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}(),e.renderTokens=function(){var t=e.state.tokens;return t.length>0?t.map((function(t){return Object(de.f)(Le,{key:t.token},Object(de.f)(Je,null,Object(de.f)(W.a,{disabled:e.showAuthInfo,position:"right",containerDisplayMode:"inline",title:Object(U.b)("You do not have access to view these credentials because the permissions for this integration exceed those of your role.")},Object(de.f)(re.a,null,Object($.a)({value:t.token,fixed:"xxxxxx"})))),Object(de.f)(Me,null,Object(de.f)(_e,null,"Created:"),Object(de.f)(_.a,{date:Object($.a)({value:t.dateCreated,fixed:new Date(150820808e4)})})),Object(de.f)(J.a,{onClick:e.onRemoveToken.bind(p()(e),t),size:"small",icon:Object(de.f)(Y.r,null),"data-test-id":"token-delete",type:"button"},Object(U.b)("Revoke")))})):Object(de.f)(X.a,{description:Object(U.b)("No tokens created yet.")})},e.onFieldChange=function(t,n){"webhookUrl"===t&&!n&&e.isInternal&&e.form.setValue("isAlertable",!1)},e}return j()(n,[{key:"getDefaultState",value:function(){return ze(ze({},b()(P()(n.prototype),"getDefaultState",this).call(this)),{},{app:null,tokens:[]})}},{key:"getEndpoints",value:function(){var e=this.props.params.appSlug;return e?[["app","/sentry-apps/".concat(e,"/")],["tokens","/sentry-apps/".concat(e,"/api-tokens/")]]:[]}},{key:"getTitle",value:function(){var e=this.props.params.orgId;return Object(K.a)(Object(U.b)("Sentry Integration Details"),e,!1)}},{key:"normalize",value:function(e){return 0===e.length?e:e.map((function(e){return e.split(".").shift()}))}},{key:"renderBody",value:function(){var e,t=this,n=this.props.params.orgId,r=this.state.app,i=r&&o()(r.scopes)||[],a=r&&this.normalize(r.events)||[],c=r?"PUT":"POST",s=r?"/sentry-apps/".concat(r.slug,"/"):"/sentry-apps/",u=this.isInternal?G.internalIntegrationForms:G.publicIntegrationForms;return e=!this.isInternal&&(!r||r.verifyInstall),Object(de.f)("div",null,Object(de.f)(oe.a,{title:this.getTitle()}),Object(de.f)(Z.a,{apiMethod:c,apiEndpoint:s,allowUndo:!0,initialData:ze(ze({organization:n,isAlertable:!1,isInternal:this.isInternal,schema:{},scopes:[]},r),{},{verifyInstall:e}),model:this.form,onSubmitSuccess:this.handleSubmitSuccess,onSubmitError:this.handleSubmitError,onFieldChange:this.onFieldChange},Object(de.f)(E.a,null,(function(){var e=t.isInternal&&!t.form.getValue("webhookUrl");return Object(de.f)(C.a.Fragment,null,Object(de.f)(te.a,{location:t.props.location,additionalFieldProps:{webhookDisabled:e},forms:u}),Object(de.f)(Ee,{webhookDisabled:e,appPublished:!!r&&"published"===r.status,scopes:i,events:a}))})),r&&"internal"===r.status&&Object(de.f)(M.a,null,Object(de.f)(M.e,{hasButtons:!0},Object(U.b)("Tokens"),Object(de.f)(J.a,{size:"xsmall",icon:Object(de.f)(Y.b,{size:"xs",isCircled:!0}),onClick:function(e){return t.onAddToken(e)},"data-test-id":"token-add",type:"button"},Object(U.b)("New Token"))),Object(de.f)(M.c,null,this.renderTokens())),r&&Object(de.f)(M.a,null,Object(de.f)(M.e,null,Object(U.b)("Credentials")),Object(de.f)(M.c,null,"internal"!==r.status&&Object(de.f)(ee.a,{name:"clientId",label:"Client ID"},(function(e){var t=e.value;return Object(de.f)(re.a,null,Object($.a)({value:t,fixed:"CI_CLIENT_ID"}))})),Object(de.f)(ee.a,{name:"clientSecret",label:"Client Secret"},(function(e){var n=e.value;return n?Object(de.f)(W.a,{disabled:t.showAuthInfo,position:"right",containerDisplayMode:"inline",title:Object(U.b)("You do not have access to view these credentials because the permissions for this integration exceed those of your role.")},Object(de.f)(re.a,null,Object($.a)({value:n,fixed:"CI_CLIENT_SECRET"}))):Object(de.f)("em",null,"hidden")}))))))}},{key:"isInternal",get:function(){var e=this.state.app;return e?"internal"===e.status:"new-internal/"===this.props.route.path}},{key:"showAuthInfo",get:function(){var e=this.state.app;return!(e&&e.clientSecret&&"*"===e.clientSecret[0])}}]),n}(Q.a),Le=Object(R.a)(M.f,{target:"e13hfg1z0",label:"StyledPanelItem"})({name:"gg4vpm",styles:"display:flex;justify-content:space-between;"}),Je=Object(R.a)("div",{target:"e13hfg1z1",label:"TokenItem"})({name:"6gs9hh",styles:"width:70%;"}),_e=Object(R.a)("span",{target:"e13hfg1z2",label:"CreatedTitle"})("color:",(function(e){return e.theme.gray300}),";margin-bottom:2px;"),Me=Object(R.a)("div",{target:"e13hfg1z3",label:"CreatedDate"})({name:"9lkchr",styles:"display:flex;flex-direction:column;font-size:14px;margin:0 10px;"})}}]);
//# sourceMappingURL=sentryApplicationDetails.js.map