# This file is a template, and might need editing before it works on your project.
# Official language image. Look for the different tagged releases at:
# https://hub.docker.com/r/library/python/tags/
image: python:latest

before_script:
  - apt-get update -q -y
  - apt-get install -y pypy3
  - export LC_ALL=C
  - python --version
  - pip install -e ".[dev]"

stages:
  - Lint & Coverage
  - Test

lint:
  stage: Lint & Coverage
  script:
    - make lint

coverage:
  stage: Lint & Coverage
  coverage: '/TOTAL.+?(\d+)%/'
  script:
    - make coverage

test-py36:
  stage: Test
  image: python:3.6
  script:
    - tox -e py36

test-py37:
  stage: Test
  image: python:3.7
  script:
    - tox -e py37

test-py38:
  stage: Test
  image: python:3.8
  script:
    - tox -e py38

test-py39:
  stage: Test
  image: python:3.9
  script:
    - tox -e py39
