(self.webpackChunkjupyterlab_requirements=self.webpackChunkjupyterlab_requirements||[]).push([[979],{979:(e,t,a)=>{"use strict";a.r(t),a.d(t,{commandIDs:()=>x,default:()=>P});var s=a(460),n=a(271),i=a.n(n),l=a(211),o=a(510),r=a(486),c=a.n(r);const d="thoth-row-button";class h extends n.Component{constructor(e){super(e),this.state={name:"",version:"*"},this.handleChange=this.handleChange.bind(this)}handleChange(e){"package_name"==e.target.name&&this.setState({name:e.target.value}),"package_version"==e.target.name&&this.setState({version:e.target.value})}handleItemDeleted(e){this.props.deleteSavedRow(e)}handleItemEdited(e,t){this.props.editSavedRow(e,t)}render(){var e=this;return n.createElement("tr",null,n.createElement("td",null,n.createElement("input",{className:"thoth-package-name-input",disabled:!0,type:"text",name:"package_name",value:this.props.name})),n.createElement("td",null,n.createElement("input",{className:"thoth-constraint-input",disabled:!0,type:"text",name:"package_version",value:this.props.version})),n.createElement("td",null,this.props.installed),n.createElement("td",null,n.createElement("td",null,n.createElement("button",{className:"thoth-row-button-deactivated"},"Add")),n.createElement("td",null,n.createElement("button",{title:"Edit saved package",className:d,onClick:e.handleItemEdited.bind(e,this.props.name,this.props.version)},"Edit")),n.createElement("td",null,n.createElement("button",{title:"Delete saved package",className:d,onClick:e.handleItemDeleted.bind(e,this.props.name)},"Delete"))))}}const p="thoth-row-button";class g extends n.Component{constructor(e){super(e),this.state={name:"",version:"*"},this.handleItemAdded=this.handleItemAdded.bind(this),this.handleChange=this.handleChange.bind(this)}handleChange(e){"package_name"==e.target.name&&this.setState({name:e.target.value}),"package_version"==e.target.name&&this.setState({version:e.target.value})}handleItemAdded(){var e=this.state.name.toString(),t=this.state.version.toString();this.props.storeRow(e,t)}handleItemDeleted(e){this.props.deleteRow(e)}render(){var e=this;return n.createElement("tr",null,n.createElement("td",null,n.createElement("input",{className:"thoth-package-name-input",type:"text",name:"package_name",value:this.state.name,onChange:this.handleChange})),n.createElement("td",null,n.createElement("input",{className:"thoth-constraint-input",type:"text",name:"package_version",value:this.state.version,onChange:this.handleChange})),n.createElement("td",null,this.props.installed),n.createElement("td",null,n.createElement("td",null,n.createElement("button",{title:"Include new package",className:p,onClick:e.handleItemAdded.bind(e)},"Add")),n.createElement("td",null,n.createElement("button",{className:"thoth-row-button-deactivated"},"Edit")),n.createElement("td",null,n.createElement("button",{title:"Delete new package",className:p,onClick:e.handleItemDeleted.bind(e,this.state.name)},"Delete"))))}}const u="thoth-table";class m extends n.Component{constructor(e){super(e),this.state={headers:["Package","Constraint","Installed","Actions"]}}renderTableHeader(){return this.state.headers.map(((e,t)=>n.createElement("th",{key:t},e.toUpperCase())))}renderRows(){var e=this,t=this.props.packages,a=this.props.initial_packages,s=this.props.installed_packages,i=[];for(let[l,o]of Object.entries(a))c().has(s,l)?i.push(n.createElement(h,{name:l,version:o,installed:"Y",packages:t,editSavedRow:e.props.editSavedRow,deleteSavedRow:e.props.deleteSavedRow})):i.push(n.createElement(h,{name:l,version:o,installed:"N",packages:t,editSavedRow:e.props.editSavedRow,deleteSavedRow:e.props.deleteSavedRow}));for(let[a,s]of Object.entries(t))i.push(n.createElement(g,{name:a,installed:"N",packages:t,storeRow:e.props.storeRow,deleteRow:e.props.deleteRow}));return i}render(){return n.createElement("table",{id:u,className:u},n.createElement("thead",null,this.renderTableHeader()),n.createElement("tbody",null,this.renderRows()))}}class k extends n.Component{constructor(e){super(e)}render(){return n.createElement(m,{packages:this.props.packages,initial_packages:this.props.initial_packages,installed_packages:this.props.installed_packages,storeRow:this.props.storeRow,editSavedRow:this.props.editSavedRow,deleteRow:this.props.deleteRow,deleteSavedRow:this.props.deleteSavedRow})}}class w extends n.Component{constructor(e){super(e)}saveRequirements(){this.props.onSave()}render(){return n.createElement("button",{title:"Save dependencies",className:"thoth-save-button",onClick:this.saveRequirements.bind(this)},"Save")}}class v extends n.Component{constructor(e){super(e)}onInstall(){this.props.install()}render(){return n.createElement("button",{title:"Install dependencies",className:"thoth-install-button",onClick:this.onInstall.bind(this)},"Install")}}class _ extends n.Component{constructor(e){super(e)}addNewEmptyRow(){this.props.addNewRow()}render(){return n.createElement("button",{title:"Add new line! Only one empty line is displayed.",className:"thoth-new-package-button",onClick:this.addNewEmptyRow.bind(this)},"New")}}class R{constructor(e="pypi",t="https://pypi.org/simple",a=!0,s,n){this.name=e,this.url=t,this.verify_ssl=a,this.warehouse=s,this.warehouse_api_url=n}}function E(e){const t=function(e){const t=JSON.stringify(e.sessionContext.session.kernel.info);if(c().isUndefined(t))throw Error("Unable to retrieve Kernel info");return t}(e);console.log("kernel info:",t);const a="3.8";console.log("python version identified:",a);const s=a.match(/\d.\d/);if(console.log("match identified:",s),null==s)throw new Error("Python version '3.8' does not match required pattern.");return s[0]}function S(e,t){const a=e.model.metadata;if(0!=a.has("requirements"))return console.log("Notebook requirements already exist. Updating..."),console.log(),void 0===t.packages?void a.set("requirements",{}):void a.set("requirements",JSON.stringify(t));a.set("requirements",JSON.stringify(t)),console.log("Notebook requirements have been set successfully.")}function b(e,t){const a=e.model.metadata;0==a.has("requirements_lock")||console.debug("Notebook requirement_lock already exist. Updating."),a.set("requirements_lock",JSON.stringify(t)),console.log("Notebook requirements_lock have been set successfully.")}var f=a(112),y=a(581);async function q(e="",t={}){const a=y.ServerConnection.makeSettings(),s=f.URLExt.join(a.baseUrl,"jupyterlab-requirements",e);let n;try{n=await y.ServerConnection.makeRequest(s,t,a)}catch(e){throw new y.ServerConnection.NetworkError(e)}const i=await n.json();if(!n.ok)throw new y.ServerConnection.ResponseError(n,i.message);return i}async function N(e,t,a={}){const s={notebook_path:e,kernel_name:t||""};try{return await q("kernel/install",{body:JSON.stringify(s),method:"POST"})}catch(e){console.error(`Error on POST /jupyterlab-requirements/kernel/install.\n${e}`)}}async function I(e,t,a={}){const s={notebook_path:e,kernel_name:t};try{return await q("kernel/create",{body:JSON.stringify(s),method:"POST"})}catch(e){console.error(`Error on POST /jupyterlab-requirements/kernel/create.\n${e}`)}}const C="thoth-ok-button",O="thoth-kernel-name-input";class U extends n.Component{constructor(e){super(e),this.onStart=this.onStart.bind(this),this.changeUIstate=this.changeUIstate.bind(this),this.addNewRow=this.addNewRow.bind(this),this.editSavedRow=this.editSavedRow.bind(this),this.storeRow=this.storeRow.bind(this),this.deleteRow=this.deleteRow.bind(this),this.deleteSavedRow=this.deleteSavedRow.bind(this),this.onSave=this.onSave.bind(this),this.checkInstalledPackages=this.checkInstalledPackages.bind(this),this.install=this.install.bind(this),this.install_backup=this.install_backup.bind(this),this.createConfig=this.createConfig.bind(this),this.setKernelName=this.setKernelName.bind(this),this.state={kernel_name:"jupyterlab_requirements",status:"loading",packages:{},initial_packages:{},installed_packages:{},requirements:{packages:{},requires:{python_version:E(this.props.panel)},sources:[new R]}}}changeUIstate(e,t,a,s,n){var i=this.state;console.log("initial",i),c().set(i,"status",e),c().set(i,"packages",t),c().set(i,"initial_packages",a),c().set(i,"installed_packages",s),c().set(i,"requirements",n),console.log("new",i),this.setState(i)}setKernelName(e){const t=e.target.value;this.setState({kernel_name:t})}addNewRow(){const e=this.state.packages;c().set(e,"",""),console.log("added package",e),this.changeUIstate("editing",e,this.state.initial_packages,this.state.installed_packages,this.state.requirements)}editSavedRow(e,t){const a=this.state.initial_packages,s=this.state.packages;c().unset(a,e),c().set(s,e,t),console.log("After editing (initial)",a),console.log("After editing (current)",s),this.changeUIstate("editing",s,a,this.state.installed_packages,this.state.requirements)}deleteRow(e){const t=this.state.packages;c().unset(t,e),console.log("After deleting",t),this.changeUIstate("editing",t,this.state.initial_packages,this.state.installed_packages,this.state.requirements)}deleteSavedRow(e){const t=this.state.initial_packages;c().unset(t,e),console.log("After deleting saved",t),this.changeUIstate("editing",this.state.packages,t,this.state.installed_packages,this.state.requirements)}storeRow(e,t){let a=this.state.packages;c().set(a,e,t);const s={};c().forIn(a,(function(e,t){console.log(t+" goes "+e),""!=t&&c().set(s,t,e)})),console.log("new packages",s),this.changeUIstate("editing",s,this.state.initial_packages,this.state.installed_packages,this.state.requirements)}onSave(){const e=this.state.requirements,t=this.state.packages;console.log("added_packages",t);const a=this.state.initial_packages;console.log("initial_packages",a);const s={};c().forIn(a,(function(e,t){0==c().has(a,"")&&c().set(s,t,e)}));const n={};if(c().forIn(t,(function(e,a){0==c().has(t,"")&&(c().set(s,a,e),c().set(n,a,e))})),c().size(s)>0){if(c().isEqual(s,this.state.installed_packages))return void this.changeUIstate("stable",this.state.packages,this.state.initial_packages,this.state.installed_packages,this.state.requirements);console.log("total packages",s);var i={packages:s,requires:e.requires,sources:e.sources};return console.log("Requirements before installing are: ",i),S(this.props.panel,i),this.props.panel.context.save(),void this.changeUIstate("saved",{},s,this.state.installed_packages,i)}var l={packages:s,requires:e.requires,sources:e.sources};return console.log("Requirements are: ",l),S(this.props.panel,l),void this.changeUIstate("failed_no_reqs",n,this.state.initial_packages,this.state.installed_packages,this.state.requirements)}async install(){this.changeUIstate("locking_requirements",this.state.packages,this.state.initial_packages,this.state.installed_packages,this.state.requirements);const e=this.props.panel.context.path.toString(),t=await this.createConfig();console.log("thoth config submitted",JSON.stringify(t));const a=this.state.requirements;console.log("Requirements submitted",JSON.stringify(a));try{const s=await async function(e,t,a,s={}){const n={notebook_path:e,thoth_config:t,requirements:a};try{const e=await q("thoth/resolution",{body:JSON.stringify(n),method:"POST"});return JSON.parse(JSON.stringify(e))}catch(e){console.error(`Error on POST /jupyterlab-requirements/thoth/resolution.\n${e}`)}}(e,JSON.stringify(t),JSON.stringify(a));if(console.log("Advise received",s),0==s.error){S(this.props.panel,s.requirements),b(this.props.panel,s.requirement_lock),function(e,t){const a=e.model.metadata;0==a.has("thoth_config")||console.debug("Notebook Thoth config already exist. Updating."),a.set("thoth_config",JSON.stringify(t)),console.log("Notebook Thoth config have been set successfully.")}(this.props.panel,t);const a=await async function(e,t,a,s={}){const n={notebook_path:e,requirements:t,requirement_lock:a};try{return await q("file/dependencies",{body:JSON.stringify(n),method:"POST"})}catch(e){console.error(`Error on POST /jupyterlab-requirements/file/dependencies.\n${e}`)}}(e,JSON.stringify(s.requirements),JSON.stringify(s.requirement_lock));console.log("Store message",a),this.changeUIstate("installing_requirements",{},this.state.initial_packages,this.state.installed_packages,s.requirements);const n=await N(e);console.log("Install message",n),this.changeUIstate("setting_kernel",{},this.state.initial_packages,this.state.initial_packages,s.requirements);const i=await I(e,this.state.kernel_name);console.log("Kernel message",i),this.changeUIstate("ready",{},this.state.initial_packages,this.state.initial_packages,s.requirements),this.changeUIstate("ready")}else this.install_backup()}catch(e){console.log(e),this.install_backup()}}async install_backup(){this.changeUIstate("installing_requirements_using_pipenv",this.state.packages,this.state.initial_packages,this.state.installed_packages,this.state.requirements);const e=this.props.panel.context.path.toString(),t=this.state.requirements;console.log("Requirements for pipenv",JSON.stringify(t));try{const a=await async function(e,t,a={}){const s={notebook_path:e,requirements:t};try{const e=await q("pipenv",{body:JSON.stringify(s),method:"POST"});return JSON.parse(JSON.stringify(e))}catch(e){console.error(`Error on POST /jupyterlab-requirements/pipenv.\n${e}`)}}(e,JSON.stringify(t));if(console.log("Result received",a),0==a.error){b(this.props.panel,a.requirements_lock),this.changeUIstate("setting_kernel",{},this.state.initial_packages,this.state.initial_packages,t),this.changeUIstate("installing_requirements",{},this.state.initial_packages,this.state.installed_packages,t);const s=await N(e,this.state.kernel_name);console.log("installed packages message",s);const n=await I(e,this.state.kernel_name);return console.log("Kernel message",n),void this.changeUIstate("ready",{},this.state.initial_packages,this.state.initial_packages,t)}return void this.changeUIstate("failed",this.state.packages,this.state.initial_packages,this.state.installed_packages,this.state.requirements)}catch(e){return console.log(e),void this.changeUIstate("failed",this.state.packages,this.state.initial_packages,this.state.installed_packages,this.state.requirements)}}async onStart(e){var t=this.props.initial_requirements;console.log("initial requirements",t);var a=t.packages;if(0==c().size(a))return void this.changeUIstate(status="initial",this.state.packages,a,this.state.installed_packages,t);const s=this.props.initial_requirements_lock;if(null==s)return void this.changeUIstate(status="only_install",this.state.packages,a,this.state.installed_packages,t);const n={};return c().forIn(s.default,(function(e,t){c().set(n,t,e.version.replace("==",""))})),console.log(n),1==await this.checkInstalledPackages(n)?void this.changeUIstate("stable",this.state.packages,a,a,t):void this.changeUIstate("only_install",this.state.packages,a,this.state.installed_packages,t)}async checkInstalledPackages(e){const t=this.props.panel.context.path.toString(),a=await async function(e,t,a={}){const s={notebook_path:e,kernel_name:t||""};try{const e=await q("kernel/packages",{body:JSON.stringify(s),method:"POST"});return JSON.parse(JSON.stringify(e))}catch(e){console.error(`Error on POST /jupyterlab-requirements/kernel/packages.\n${e}`)}}(t,this.state.kernel_name);console.log("packages installed (pip list)",a);const s={};return c().forIn(a,(function(t,a){c().has(e,a.toLowerCase())&&c().get(e,a.toLowerCase())==t&&c().set(s,a,t)})),console.log("Installed packages:",s),!!c().isEqual(c().size(e),c().size(s))}async createConfig(){const e=await async function(e={}){try{return await q("thoth/config")}catch(e){console.error(`Error on GET /jupyterlab-requirements/thoth/config.\n${e}`)}}();return console.log("Config file",e),e}render(){let e="float:left";return"loading"==this.state.status?(this.onStart(this.props.panel),n.createElement("div",null,"Loading...")):"initial"==this.state.status?n.createElement("div",null,n.createElement("div",null,n.createElement(k,{initial_packages:this.state.initial_packages,installed_packages:this.state.installed_packages,packages:this.state.packages,storeRow:this.storeRow,deleteRow:this.deleteRow,editSavedRow:this.editSavedRow,deleteSavedRow:this.deleteSavedRow})),n.createElement("div",{className:e},n.createElement(_,{addNewRow:this.addNewRow})),n.createElement("div",{className:e},n.createElement(w,{onSave:this.onSave,changeUIstate:this.changeUIstate})),n.createElement("div",null,n.createElement("p",null," No dependencies found! Click New to add package. "))):"no_reqs_to_save"==this.state.status?n.createElement("div",null,n.createElement("div",null,n.createElement(k,{initial_packages:this.state.initial_packages,installed_packages:this.state.installed_packages,packages:this.state.packages,storeRow:this.storeRow,deleteRow:this.deleteRow,editSavedRow:this.editSavedRow,deleteSavedRow:this.deleteSavedRow})),n.createElement("div",null,n.createElement(_,{addNewRow:this.addNewRow})),n.createElement("div",null,n.createElement(w,{onSave:this.onSave,changeUIstate:this.changeUIstate})),n.createElement("p",null," Dependencies missing! Click New to add package. ")):"only_install"==this.state.status?n.createElement("div",null,n.createElement("div",null,n.createElement(k,{initial_packages:this.state.initial_packages,installed_packages:this.state.installed_packages,packages:this.state.packages,storeRow:this.storeRow,deleteRow:this.deleteRow,editSavedRow:this.editSavedRow,deleteSavedRow:this.deleteSavedRow})),n.createElement("div",null,n.createElement(_,{addNewRow:this.addNewRow})),n.createElement("div",null,n.createElement(v,{changeUIstate:this.changeUIstate,install:this.install_backup})),n.createElement("div",null,n.createElement("p",null,"Dependencies found in notebook metadata but lock file is missing. ")),n.createElement("br",null)," OPTIONS",n.createElement("div",null,"Kernel name ",n.createElement("input",{title:"Kernel name",className:O,type:"text",name:"kernel_name",value:this.state.kernel_name,onChange:this.setKernelName}))):"editing"==this.state.status?n.createElement("div",null,n.createElement("div",null,n.createElement(k,{initial_packages:this.state.initial_packages,installed_packages:this.state.installed_packages,packages:this.state.packages,storeRow:this.storeRow,deleteRow:this.deleteRow,editSavedRow:this.editSavedRow,deleteSavedRow:this.deleteSavedRow})),n.createElement("div",null,n.createElement(_,{addNewRow:this.addNewRow})),n.createElement("div",null,n.createElement(w,{onSave:this.onSave,changeUIstate:this.changeUIstate}))):"saved"==this.state.status?n.createElement("div",null,n.createElement("div",null,n.createElement(k,{initial_packages:this.state.initial_packages,installed_packages:this.state.installed_packages,packages:this.state.packages,storeRow:this.storeRow,deleteRow:this.deleteRow,editSavedRow:this.editSavedRow,deleteSavedRow:this.deleteSavedRow})),n.createElement("div",null,n.createElement(_,{addNewRow:this.addNewRow})),n.createElement("div",null,n.createElement(v,{changeUIstate:this.changeUIstate,install:this.install})),"OPTIONS",n.createElement("div",null," Kernel name",n.createElement("input",{title:"Kernel name",className:O,type:"text",name:"kernel_name",value:this.state.kernel_name,onChange:this.setKernelName}))):"locking_requirements"==this.state.status?n.createElement("div",null,n.createElement("div",null,n.createElement(k,{initial_packages:this.state.initial_packages,installed_packages:this.state.installed_packages,packages:this.state.packages,storeRow:this.storeRow,deleteRow:this.deleteRow,editSavedRow:this.editSavedRow,deleteSavedRow:this.deleteSavedRow})),n.createElement("fieldset",null,n.createElement("p",null,"Contacting thoth for advise... please be patient!"))):"installing_requirements"==this.state.status?n.createElement("div",null,n.createElement("div",null,n.createElement(k,{initial_packages:this.state.initial_packages,installed_packages:this.state.installed_packages,packages:this.state.packages,storeRow:this.storeRow,deleteRow:this.deleteRow,editSavedRow:this.editSavedRow,deleteSavedRow:this.deleteSavedRow})),n.createElement("fieldset",null,n.createElement("p",null,"Requirements locked and saved!",n.createElement("br",null),"Installing new requirements..."))):"setting_kernel"==this.state.status?n.createElement("div",null,n.createElement("div",null,n.createElement(k,{initial_packages:this.state.initial_packages,installed_packages:this.state.installed_packages,packages:this.state.packages,storeRow:this.storeRow,deleteRow:this.deleteRow,editSavedRow:this.editSavedRow,deleteSavedRow:this.deleteSavedRow})),n.createElement("fieldset",null,n.createElement("p",null,"Requirements locked and saved!",n.createElement("br",null),"Requirements installed!",n.createElement("br",null),"Setting new kernel for your notebook..."))):"failed_no_reqs"==this.state.status?n.createElement("div",null,n.createElement("div",null,n.createElement(k,{initial_packages:this.state.initial_packages,installed_packages:this.state.installed_packages,packages:this.state.packages,storeRow:this.storeRow,deleteRow:this.deleteRow,editSavedRow:this.editSavedRow,deleteSavedRow:this.deleteSavedRow})),n.createElement("div",{className:e},n.createElement("button",{title:"Add requirements.",className:C,onClick:()=>this.changeUIstate("loading",this.state.packages,this.state.initial_packages,this.state.installed_packages,this.state.requirements)},"Ok")),n.createElement("div",null,n.createElement("p",null,"No requirements have been added please click add after inserting package name!"))):"installing_requirements_using_pipenv"==this.state.status?n.createElement("div",null,n.createElement("p",null,"Thoth resolution engine failed... pipenv will be used to lock and install dependencies!")):"failed"==this.state.status?n.createElement("div",null,n.createElement("div",null,n.createElement(k,{initial_packages:this.state.initial_packages,installed_packages:this.state.installed_packages,packages:this.state.packages,storeRow:this.storeRow,deleteRow:this.deleteRow,editSavedRow:this.editSavedRow,deleteSavedRow:this.deleteSavedRow})),n.createElement("div",{className:e},n.createElement("button",{title:"Finish.",className:C,onClick:()=>this.changeUIstate("loading",this.state.packages,this.state.initial_packages,this.state.installed_packages,this.state.requirements)},"Ok")),n.createElement("div",null,n.createElement("p",null,"pipenv resolution engine failed... please contact Thoth team!"))):"stable"==this.state.status?(this.props.panel.sessionContext.session.changeKernel({name:this.state.kernel_name}),n.createElement("div",null,n.createElement(k,{initial_packages:this.state.initial_packages,installed_packages:this.state.installed_packages,packages:this.state.packages,storeRow:this.storeRow,deleteRow:this.deleteRow,editSavedRow:this.editSavedRow,deleteSavedRow:this.deleteSavedRow}),n.createElement("div",null,n.createElement(_,{addNewRow:this.addNewRow})),n.createElement("div",null,n.createElement("p",null," Everything installed and ready to use!")))):"ready"==this.state.status?n.createElement("div",null,n.createElement(k,{initial_packages:this.state.initial_packages,installed_packages:this.state.installed_packages,packages:this.state.packages,storeRow:this.storeRow,deleteRow:this.deleteRow,editSavedRow:this.editSavedRow,deleteSavedRow:this.deleteSavedRow}),n.createElement("div",{className:e},n.createElement("button",{title:"Reload Page and assign kernel.",className:C,onClick:()=>this.changeUIstate("stable",this.state.packages,this.state.initial_packages,this.state.installed_packages,this.state.requirements)},"Ok")),n.createElement("div",null,n.createElement("fieldset",null,n.createElement("p",null,"Requirements locked and saved!",n.createElement("br",null),"Requirements installed!",n.createElement("br",null),"New kernel created!",n.createElement("br",null),"Click ok to shutdown current kernel and start new one.",n.createElement("br",null))))):void 0}}class J{constructor(){this.openWidget=async()=>{const e=this.panel.content.model.toString();console.log("metadata",e);const t=await(a=this.panel,new Promise((async(e,t)=>{try{const t=a.model.metadata.get("requirements");if(void 0===t)return console.log("requirements key is not in notebook metadata! Initialize requirements for user..."),e({packages:{},requires:{python_version:E(a)},sources:[new R]});let s=JSON.parse(t.toString());return 0==c().size(s)?(console.log("requirements key is not in notebook metadata! Initialize requirements for user..."),e({packages:{},requires:{python_version:E(a)},sources:[new R]})):(console.log("requirements key is in notebook metadata!"),e(s))}catch(e){t(e)}})));var a;console.log("requirements",t);const n=await function(e){return new Promise((async(t,a)=>{try{const a=e.model.metadata.get("requirements_lock");void 0===a&&(console.log("requirement_lock key is not in notebook metadata!"),t(null));var s=JSON.parse(a.toString());console.log("requirements_lock key is in notebook metadata!"),t(s)}catch(e){a(e)}}))}(this.panel);console.log("requirements_lock",n);const r=function(e){let t=e.model.metadata.get("thoth_config");return null==t?(console.log("thoth_config key is not in notebook metadata!"),null):JSON.parse(JSON.stringify(t))}(this.panel);console.log("Thoth config from notebook metadata",r);const d=s.ReactWidget.create(i().createElement(U,{panel:this.panel,initial_requirements:t,initial_requirements_lock:n,initial_config_file:r}));l.MessageLoop.sendMessage(d,o.Widget.Msg.UpdateRequest);const h={title:"Manage Dependencies",body:d,buttons:[s.Dialog.cancelButton()]};new s.Dialog(h).launch(),this.panel.context.save()}}createNew(e,t){this.panel=e;const a=new s.ToolbarButton({label:"Manage Dependencies ...",onClick:this.openWidget,tooltip:"Manage Dependencies ..."});return e.toolbar.insertItem(10,"dependencyManagement",a),a}}const x={dependencyManagement:"notebook:manage-dependencies"},P={id:"jupyterlab_requirements",autoStart:!0,activate:function(e){const t=new J;e.docRegistry.addWidgetExtension("Notebook",t),e.contextMenu.addItem({selector:".jp-Notebook",command:x.dependencyManagement,rank:-.5})}}}}]);