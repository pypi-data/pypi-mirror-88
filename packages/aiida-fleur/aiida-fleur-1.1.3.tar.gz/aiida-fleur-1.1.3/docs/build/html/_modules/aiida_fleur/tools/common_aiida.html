

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>aiida_fleur.tools.common_aiida &mdash; AiiDA-FLEUR 1.1.3 documentation</title>
  

  
  <link rel="stylesheet" href="../../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../../_static/theme_overrides.css" type="text/css" />

  
  
  
  

  
  <!--[if lt IE 9]>
    <script src="../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../../" src="../../../_static/documentation_options.js"></script>
        <script src="../../../_static/jquery.js"></script>
        <script src="../../../_static/underscore.js"></script>
        <script src="../../../_static/doctools.js"></script>
        <script src="../../../_static/language_data.js"></script>
    
    <script type="text/javascript" src="../../../_static/js/theme.js"></script>

    
    <link rel="search" type="application/opensearchdescription+xml"
          title="Search within AiiDA-FLEUR 1.1.3 documentation"
          href="../../../_static/opensearch.xml"/>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../../index.html" class="icon icon-home" alt="Documentation Home"> AiiDA-FLEUR
          

          
          </a>

          
            
            
              <div class="version">
                1.1
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../../../user_guide/ug_index.html">User’s guide</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../devel_guide/dg_index.html">Developer’s guide</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../module_guide/mg_index.html">Source code Documentation (API reference)</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">AiiDA-FLEUR</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="../../index.html">Module code</a> &raquo;</li>
        
      <li>aiida_fleur.tools.common_aiida</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <h1>Source code for aiida_fleur.tools.common_aiida</h1><div class="highlight"><pre>
<span></span><span class="c1"># -*- coding: utf-8 -*-</span>
<span class="c1">###############################################################################</span>
<span class="c1"># Copyright (c), Forschungszentrum Jülich GmbH, IAS-1/PGI-1, Germany.         #</span>
<span class="c1">#                All rights reserved.                                         #</span>
<span class="c1"># This file is part of the AiiDA-FLEUR package.                               #</span>
<span class="c1">#                                                                             #</span>
<span class="c1"># The code is hosted on GitHub at https://github.com/JuDFTteam/aiida-fleur    #</span>
<span class="c1"># For further information on the license, see the LICENSE.txt file            #</span>
<span class="c1"># For further information please visit http://www.flapw.de or                 #</span>
<span class="c1"># http://aiida-fleur.readthedocs.io/en/develop/                               #</span>
<span class="c1">###############################################################################</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">In here we put all things util (methods, code snipets) that are often useful, but not yet in AiiDA</span>
<span class="sd">itself.</span>
<span class="sd">So far it contains:</span>

<span class="sd">export_extras</span>
<span class="sd">import_extras</span>
<span class="sd">delete_nodes (FIXME)</span>
<span class="sd">delete_trash (FIXME)</span>
<span class="sd">create_group</span>

<span class="sd">&quot;&quot;&quot;</span>
<span class="c1"># TODO import, export of descriptions, and labels...?</span>
<span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="n">absolute_import</span>
<span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="n">print_function</span>
<span class="kn">import</span> <span class="nn">json</span>
<span class="kn">import</span> <span class="nn">six</span>
<span class="kn">from</span> <span class="nn">six.moves</span> <span class="kn">import</span> <span class="nb">input</span> <span class="k">as</span> <span class="n">input_six</span>

<span class="kn">from</span> <span class="nn">aiida.orm</span> <span class="kn">import</span> <span class="n">load_node</span>
<span class="kn">from</span> <span class="nn">aiida.orm.querybuilder</span> <span class="kn">import</span> <span class="n">QueryBuilder</span>
<span class="kn">from</span> <span class="nn">aiida.orm</span> <span class="kn">import</span> <span class="n">Group</span><span class="p">,</span> <span class="n">Node</span>
<span class="kn">from</span> <span class="nn">aiida.common.exceptions</span> <span class="kn">import</span> <span class="n">NotExistent</span>


<div class="viewcode-block" id="export_extras"><a class="viewcode-back" href="../../../module_guide/tools.html#aiida_fleur.tools.common_aiida.export_extras">[docs]</a><span class="k">def</span> <span class="nf">export_extras</span><span class="p">(</span><span class="n">nodes</span><span class="p">,</span> <span class="n">filename</span><span class="o">=</span><span class="s1">&#39;node_extras.txt&#39;</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Writes uuids and extras of given nodes to a json-file.</span>
<span class="sd">    This is useful for import/export because currently extras are lost.</span>
<span class="sd">    Therefore this can be used to save and restore the extras via</span>
<span class="sd">    :func:`~aiida_fleur.tools.common_aiida.import_extras`.</span>

<span class="sd">    :param: nodes: list of AiiDA nodes, pks, or uuids</span>
<span class="sd">    :param: filename, string where to store the file and its name</span>

<span class="sd">    example use:</span>
<span class="sd">    .. code-block:: python</span>

<span class="sd">        node_list = [120,121,123,46]</span>
<span class="sd">        export_extras(node_list)</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">outdict</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="n">nodes</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">node</span><span class="p">,</span> <span class="n">Node</span><span class="p">):</span>  <span class="c1"># pk or uuid</span>
            <span class="n">node</span> <span class="o">=</span> <span class="n">load_node</span><span class="p">(</span><span class="n">node</span><span class="p">)</span>

        <span class="n">uuid</span> <span class="o">=</span> <span class="n">node</span><span class="o">.</span><span class="n">uuid</span>
        <span class="n">extras_dict</span> <span class="o">=</span> <span class="n">node</span><span class="o">.</span><span class="n">extras</span>
        <span class="n">outdict</span><span class="p">[</span><span class="n">uuid</span><span class="p">]</span> <span class="o">=</span> <span class="n">extras_dict</span>

    <span class="n">json</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">outdict</span><span class="p">,</span> <span class="nb">open</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">),</span> <span class="n">sort_keys</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">separators</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">,</span> <span class="s1">&#39;: &#39;</span><span class="p">))</span></div>


<div class="viewcode-block" id="import_extras"><a class="viewcode-back" href="../../../module_guide/tools.html#aiida_fleur.tools.common_aiida.import_extras">[docs]</a><span class="k">def</span> <span class="nf">import_extras</span><span class="p">(</span><span class="n">filename</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Reads in node uuids and extras from a file (most probably generated by</span>
<span class="sd">    :func:`~aiida_fleur.tools.common_aiida.export_extras`) and applies them to nodes in the DB.</span>

<span class="sd">    This is useful for import/export because currently extras are lost.</span>
<span class="sd">    Therefore this can be used to save and restore the extras on the nodes.</span>

<span class="sd">    :param: filename, string what file to read from (has to be json format)</span>

<span class="sd">    example use:</span>
<span class="sd">    import_extras(&#39;node_extras.txt&#39;)</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">all_extras</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file1</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">all_extras</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">file1</span><span class="p">)</span>
        <span class="k">except</span> <span class="n">json</span><span class="o">.</span><span class="n">JSONDecodeError</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;The file has to be loadable by json. i.e json format (which it is not).&#39;</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">uuid</span><span class="p">,</span> <span class="n">extras</span> <span class="ow">in</span> <span class="n">six</span><span class="o">.</span><span class="n">iteritems</span><span class="p">(</span><span class="n">all_extras</span><span class="p">):</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">node</span> <span class="o">=</span> <span class="n">load_node</span><span class="p">(</span><span class="n">uuid</span><span class="p">)</span>
        <span class="k">except</span> <span class="n">NotExistent</span><span class="p">:</span>
            <span class="c1"># Does not exists</span>
            <span class="nb">print</span><span class="p">((</span><span class="s1">&#39;node with uuid </span><span class="si">{}</span><span class="s1"> does not exist in DB&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">uuid</span><span class="p">)))</span>
            <span class="n">node</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="k">continue</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">node</span><span class="p">,</span> <span class="n">Node</span><span class="p">):</span>
            <span class="n">node</span><span class="o">.</span><span class="n">set_extra_many</span><span class="p">(</span><span class="n">extras</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;node is not instance of an AiiDA node&#39;</span><span class="p">)</span></div>
        <span class="c1">#print(extras)</span>


<span class="sd">&#39;&#39;&#39;</span>
<span class="sd"># uncommented this, since it is for sure out of date and dangerous to use</span>
<span class="sd"># for current version see aiida-core docs</span>
<span class="sd">def delete_nodes(pks_to_delete):</span>
<span class="sd">    &quot;&quot;&quot;</span>
<span class="sd">    Delete a set of nodes. (From AiiDA cockbook)</span>
<span class="sd">    Note: TODO this has to be improved for workchain removal. (checkpoints and co)</span>
<span class="sd">    Also you will be backchecked.</span>

<span class="sd">    BE VERY CAREFUL!</span>

<span class="sd">    .. note::</span>

<span class="sd">        The script will also delete</span>
<span class="sd">        all children calculations generated from the specified nodes.</span>

<span class="sd">    :params pks_to_delete: a list of the PKs of the nodes to delete</span>
<span class="sd">    &quot;&quot;&quot;</span>
<span class="sd">    # TODO: CHECK IF THIS IS UP TO DATE!</span>
<span class="sd">    from django.db import transaction</span>
<span class="sd">    from django.db.models import Q</span>
<span class="sd">    from aiida.backends.djsite.db import models</span>

<span class="sd">    # Delete also all children of the given calculations</span>
<span class="sd">    # Here I get a set of all pks to actually delete, including</span>
<span class="sd">    # all children nodes.</span>
<span class="sd">    all_pks_to_delete = set(pks_to_delete)</span>
<span class="sd">    for pk in pks_to_delete:</span>
<span class="sd">        all_pks_to_delete.update(</span>
<span class="sd">            models.DbNode.objects.filter(input_links__in=pks_to_delete).values_list(&#39;pk&#39;, flat=True))</span>

<span class="sd">    print((&#39;I am going to delete {} nodes, including ALL THE CHILDREN&#39;</span>
<span class="sd">           &#39;of the nodes you specified. Do you want to continue? [y/N]&#39;</span>
<span class="sd">           &#39;&#39;.format(len(all_pks_to_delete))))</span>
<span class="sd">    answer = input_six()</span>

<span class="sd">    if answer.strip().lower() == &#39;y&#39;:</span>
<span class="sd">        # Recover the list of folders to delete before actually deleting</span>
<span class="sd">        # the nodes.  I will delete the folders only later, so that if</span>
<span class="sd">        # there is a problem during the deletion of the nodes in</span>
<span class="sd">        # the DB, I don&#39;t delete the folders</span>

<span class="sd">        # There seem to be no folders in AiiDA 1.0</span>
<span class="sd">        #folders = [load_node(pk).folder for pk in all_pks_to_delete]</span>

<span class="sd">        with transaction.atomic():</span>
<span class="sd">            # Delete all links pointing to or from a given node</span>
<span class="sd">            models.DbLink.objects.filter(Q(input__in=all_pks_to_delete) | Q(output__in=all_pks_to_delete)).delete()</span>
<span class="sd">            # now delete nodes</span>
<span class="sd">            models.DbNode.objects.filter(pk__in=all_pks_to_delete).delete()</span>

<span class="sd">        # If we are here, we managed to delete the entries from the DB.</span>
<span class="sd">        # I can now delete the folders</span>

<span class="sd">        # There seem to be no folders in AiiDA 1.0</span>
<span class="sd">        # for f in folders:</span>
<span class="sd">        #     f.erase()</span>


<span class="sd">def delete_trash():</span>
<span class="sd">    &quot;&quot;&quot;</span>
<span class="sd">    This method deletes all AiiDA nodes in the DB, which have a extra trash=True</span>
<span class="sd">    And all their children. Could be advanced to a garbage collector.</span>

<span class="sd">    Be careful to use it.</span>
<span class="sd">    &quot;&quot;&quot;</span>

<span class="sd">    #query db for marked trash</span>
<span class="sd">    q = QueryBuilder()</span>
<span class="sd">    nodes_to_delete_pks = []</span>

<span class="sd">    q.append(Node, filters={&#39;extras.trash&#39;: {&#39;==&#39;: True}})</span>

<span class="sd">    res = q.all()</span>
<span class="sd">    for node in res:</span>
<span class="sd">        nodes_to_delete_pks.append(node[0].pk)</span>
<span class="sd">        print((&#39;pk {}, extras {}&#39;.format(node[0].pk, node[0].extras)))</span>

<span class="sd">    #Delete the trash nodes</span>

<span class="sd">    print((&#39;deleting nodes {}&#39;.format(nodes_to_delete_pks)))</span>
<span class="sd">    delete_nodes(nodes_to_delete_pks)</span>

<span class="sd">    return</span>
<span class="sd">&#39;&#39;&#39;</span>


<div class="viewcode-block" id="create_group"><a class="viewcode-back" href="../../../module_guide/tools.html#aiida_fleur.tools.common_aiida.create_group">[docs]</a><span class="k">def</span> <span class="nf">create_group</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">nodes</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">add_if_exist</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Creates a group for a given node list.</span>

<span class="sd">    !!! Now aiida-core has these functionality, use it from there instead!!!</span>
<span class="sd">    So far this is only an AiiDA verdi command.</span>

<span class="sd">    :params name: string name for the group</span>
<span class="sd">    :params nodes: list of AiiDA nodes, pks, or uuids</span>
<span class="sd">    :params description: optional string that will be stored as description for the group</span>

<span class="sd">    :returns: the group, AiiDa group</span>

<span class="sd">    Usage example:</span>

<span class="sd">    .. code-block:: python</span>

<span class="sd">        group_name = &#39;delta_structures_gustav&#39;</span>
<span class="sd">        nodes_to_group_pks =[2142, 2084]</span>
<span class="sd">        create_group(group_name, nodes_to_group_pks,</span>
<span class="sd">                     description=&#39;delta structures added by hand. from Gustavs inpgen files&#39;)</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1">#from aiida.common import NotExistent</span>

    <span class="n">group</span><span class="p">,</span> <span class="n">created</span> <span class="o">=</span> <span class="n">Group</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">get_or_create</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="n">name</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">created</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">((</span><span class="s1">&#39;Group created with PK=</span><span class="si">{}</span><span class="s1"> and name </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">group</span><span class="o">.</span><span class="n">pk</span><span class="p">,</span> <span class="n">group</span><span class="o">.</span><span class="n">label</span><span class="p">)))</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">((</span><span class="s1">&#39;Group with name </span><span class="si">{}</span><span class="s1"> and pk </span><span class="si">{}</span><span class="s1"> already exists.&#39;</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">group</span><span class="o">.</span><span class="n">label</span><span class="p">,</span> <span class="n">group</span><span class="o">.</span><span class="n">pk</span><span class="p">)))</span>

        <span class="k">if</span> <span class="n">add_if_exist</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Adding nodes to the existing group </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">group</span><span class="o">.</span><span class="n">label</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Nodes were not added to the existing group </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">group</span><span class="o">.</span><span class="n">label</span><span class="p">))</span>
            <span class="k">return</span>

    <span class="n">nodes2</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="n">nodes</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">node</span><span class="p">,</span> <span class="n">Node</span><span class="p">):</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">node</span> <span class="o">=</span> <span class="n">load_node</span><span class="p">(</span><span class="n">node</span><span class="p">)</span>
            <span class="k">except</span> <span class="n">NotExistent</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Skipping </span><span class="si">{}</span><span class="s1">, it does not exist in the DB&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">node</span><span class="p">))</span>
                <span class="k">continue</span>
        <span class="n">nodes2</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">node</span><span class="p">)</span>

    <span class="n">group</span><span class="o">.</span><span class="n">add_nodes</span><span class="p">(</span><span class="n">nodes2</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">((</span><span class="s1">&#39;added nodes: </span><span class="si">{}</span><span class="s1"> to group </span><span class="si">{}</span><span class="s1"> </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">([</span><span class="n">x</span><span class="o">.</span><span class="n">pk</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">nodes2</span><span class="p">],</span> <span class="n">group</span><span class="o">.</span><span class="n">label</span><span class="p">,</span> <span class="n">group</span><span class="o">.</span><span class="n">pk</span><span class="p">)))</span>

    <span class="k">if</span> <span class="n">description</span><span class="p">:</span>
        <span class="n">group</span><span class="o">.</span><span class="n">description</span> <span class="o">=</span> <span class="n">description</span>

    <span class="k">return</span> <span class="n">group</span></div>


<div class="viewcode-block" id="get_nodes_from_group"><a class="viewcode-back" href="../../../module_guide/tools.html#aiida_fleur.tools.common_aiida.get_nodes_from_group">[docs]</a><span class="k">def</span> <span class="nf">get_nodes_from_group</span><span class="p">(</span><span class="n">group</span><span class="p">,</span> <span class="n">return_format</span><span class="o">=</span><span class="s1">&#39;uuid&#39;</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns a list of pk or uuid of a nodes in a given group. Since 1.1.0, this function does</span>
<span class="sd">    !!! Now aiida-core has these functionality, use it from there instead!!!</span>

<span class="sd">    not load a group using the label or any other identification. Use Group.objects.get(filter=ID) to</span>
<span class="sd">    pre-load this, available filters are: id, uuid, label, type_string, time, description, user_id.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="n">return_format</span> <span class="o">==</span> <span class="s1">&#39;uuid&#39;</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">x</span><span class="o">.</span><span class="n">uuid</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">group</span><span class="o">.</span><span class="n">nodes</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">return_format</span> <span class="o">==</span> <span class="s1">&#39;pk&#39;</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">x</span><span class="o">.</span><span class="n">pk</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">group</span><span class="o">.</span><span class="n">nodes</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;return_format should be &#39;uuid&#39; or &#39;pk&#39;.&quot;</span><span class="p">)</span></div>
</pre></div>

           </div>
           
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright 2016-2020, FZ Jülich GmbH, Germany. All rights reserved

    </p>
  </div>
    
    
    
    Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>