{"version":3,"file":"store.js","sources":["../../../packages/store/node_modules/redux-persist/es/stateReconciler/autoMergeLevel2.js","../../../packages/store/src/storage.js","../../../packages/store/src/store.js"],"sourcesContent":["function _typeof(obj) { if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }; } return _typeof(obj); }\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(source, true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(source).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\n/*\n  autoMergeLevel2: \n    - merges 2 level of substate\n    - skips substate if already modified\n    - this is essentially redux-perist v4 behavior\n*/\nexport default function autoMergeLevel2(inboundState, originalState, reducedState, _ref) {\n  var debug = _ref.debug;\n\n  var newState = _objectSpread({}, reducedState); // only rehydrate if inboundState exists and is an object\n\n\n  if (inboundState && _typeof(inboundState) === 'object') {\n    Object.keys(inboundState).forEach(function (key) {\n      // ignore _persist data\n      if (key === '_persist') return; // if reducer modifies substate, skip auto rehydration\n\n      if (originalState[key] !== reducedState[key]) {\n        if (process.env.NODE_ENV !== 'production' && debug) console.log('redux-persist/stateReconciler: sub state for key `%s` modified, skipping.', key);\n        return;\n      }\n\n      if (isPlainEnoughObject(reducedState[key])) {\n        // if object is plain enough shallow merge the new values (hence \"Level2\")\n        newState[key] = _objectSpread({}, newState[key], {}, inboundState[key]);\n        return;\n      } // otherwise hard set\n\n\n      newState[key] = inboundState[key];\n    });\n  }\n\n  if (process.env.NODE_ENV !== 'production' && debug && inboundState && _typeof(inboundState) === 'object') console.log(\"redux-persist/stateReconciler: rehydrated keys '\".concat(Object.keys(inboundState).join(', '), \"'\"));\n  return newState;\n}\n\nfunction isPlainEnoughObject(o) {\n  return o !== null && !Array.isArray(o) && _typeof(o) === 'object';\n}","import localForage from 'localforage';\n\nexport function createStorage(name) {\n    return localForage.createInstance({ name });\n}\n\nexport const serialize = false;\nexport const deserialize = false;\n","import {\n    createStore,\n    combineReducers,\n    applyMiddleware,\n    compose,\n    bindActionCreators\n} from 'redux';\nimport logger from 'redux-logger';\nimport { persistStore, persistReducer, createTransform } from 'redux-persist';\nimport autoMergeLevel2 from 'redux-persist/lib/stateReconciler/autoMergeLevel2';\nimport { createStorage, serialize, deserialize } from './storage';\n\nimport 'whatwg-fetch';\n\nconst REMOVE = '@@KVP_REMOVE';\nconst SET = '@@KVP_SET';\nconst CLEAR = '@@KVP_CLEAR';\n\n// Internal variables and functions\nvar _verbosity = {\n    Network: 1,\n    Lookup: 2,\n    Values: 3\n};\n\nclass Store {\n    constructor(name) {\n        if (_stores[name]) {\n            throw name + ' store already exists!';\n        }\n        this.name = name;\n        _stores[name] = this;\n\n        this.debug = false;\n\n        // Base URL of web service\n        this.service = undefined;\n\n        // Default parameters (e.g f=json)\n        this.defaults = {};\n\n        this.ready = {\n            then: function () {\n                throw new Error('Call init first!');\n            }\n        };\n\n        // Registered redux functions\n        this._reducers = {};\n        this._enhanceReducers = [];\n        this._persistKeys = [];\n        this._transforms = [];\n        this._middleware = [];\n        this._enhancers = [];\n        this._subscribers = [];\n        this._deferActions = [];\n        this._thunkHandler = null;\n\n        this._promises = {}; // Save promises to prevent redundant fetches\n\n        this.addReducer(\n            'kvp',\n            (state, action) => this.kvpReducer(state, action),\n            true\n        );\n    }\n\n    init(opts = {}) {\n        var self = this;\n        var optlist = [\n            'debug',\n            'storageFail',\n\n            'service',\n            'defaults',\n            'fetchFail',\n            'ajax',\n            'formatKeyword'\n        ];\n        optlist.forEach(function (opt) {\n            if (opts.hasOwnProperty(opt)) {\n                self[opt] = opts[opt];\n            }\n        });\n        if (self.debug) {\n            for (var level in _verbosity) {\n                if (self.debug >= _verbosity[level]) {\n                    self['debug' + level] = true;\n                }\n            }\n            self.addMiddleware(logger);\n        }\n\n        var storeReady;\n        self.ready = new Promise(resolve => (storeReady = resolve));\n\n        var reducer = combineReducers(this._reducers);\n        this._enhanceReducers.forEach(enhanceReducer => {\n            reducer = enhanceReducer(reducer);\n        });\n        const enhancers = compose(\n            ...this._enhancers,\n            applyMiddleware(...this._middleware)\n        );\n\n        this.lf = createStorage(this.name);\n\n        const persistConfig = {\n            key: 'root',\n            storage: this.lf,\n            stateReconciler: autoMergeLevel2,\n            serialize,\n            deserialize,\n            transforms: this._transforms,\n            whitelist: this._persistKeys,\n            writeFailHandler: error => this.storageFail(error)\n        };\n        const persistedReducer = persistReducer(persistConfig, reducer);\n        this._store = createStore(persistedReducer, {}, enhancers);\n        this._persistor = persistStore(this._store);\n        this._persistor.subscribe(() => {\n            const { bootstrapped } = this._persistor.getState();\n            if (bootstrapped) {\n                storeReady();\n            }\n        });\n        this._unsubscribers = this._subscribers.map(fn =>\n            this._store.subscribe(fn)\n        );\n        this._deferActions.forEach(this._store.dispatch);\n    }\n\n    dispatch(action) {\n        if (this._store) {\n            return this._store.dispatch(action);\n        } else {\n            this._deferActions.push(action);\n        }\n    }\n\n    subscribe(fn) {\n        this._subscribers.push(fn);\n        if (this._store) {\n            return this._store.subscribe(fn);\n        } else {\n            const index = this._subscribers.length - 1;\n            return () => {\n                if (!this._unsubscribers) {\n                    throw new Error('Store was never fully initialized!');\n                }\n                this._unsubscribers[index]();\n            };\n        }\n    }\n\n    getState() {\n        return this._store.getState();\n    }\n\n    addReducer(name, reducer, persist, deserialize) {\n        this._reducers[name] = reducer;\n        if (persist) {\n            this.persistKey(name, persist, deserialize);\n        }\n    }\n\n    addEnhanceReducer(name, enhanceReducer, persist, deserialize) {\n        this._enhanceReducers.push(enhanceReducer);\n        if (persist) {\n            this.persistKey(name, persist, deserialize);\n        }\n    }\n\n    persistKey(name, serialize, deserialize) {\n        this._persistKeys.push(name);\n        if (serialize && deserialize) {\n            this._transforms.push(\n                createTransform(serialize, deserialize, { whitelist: [name] })\n            );\n        }\n    }\n\n    addMiddleware(middleware) {\n        this._middleware.push(middleware);\n    }\n\n    addEnhancer(enhancer) {\n        this._enhancers.push(enhancer);\n    }\n\n    bindActionCreators(actions) {\n        return bindActionCreators(actions, this.dispatch.bind(this));\n    }\n\n    addThunk(name, thunk) {\n        if (!this._thunkHandler) {\n            throw new Error('@wq/router is required to handle thunks');\n        }\n        this._thunkHandler(name, thunk);\n    }\n\n    setThunkHandler(handler) {\n        this._thunkHandler = handler;\n    }\n\n    kvpReducer(state = {}, action) {\n        if (action.type === REMOVE) {\n            state = { ...state };\n            delete state[action.payload.key];\n        } else if (action.type === SET) {\n            state = {\n                ...state,\n                [action.payload.key]: action.payload.value\n            };\n        } else if (action.type === CLEAR) {\n            state = {};\n        }\n        return state;\n    }\n\n    // Get value from datastore\n    async get(query) {\n        await this.ready;\n        var self = this;\n        if (Array.isArray(query)) {\n            var promises = query.map(row => self.get(row));\n            return Promise.all(promises);\n        }\n        query = self.normalizeQuery(query);\n        var key = self.toKey(query);\n\n        if (self.debugLookup) {\n            console.log('looking up ' + key);\n        }\n\n        // Check storage first\n        const kvp = this.getState().kvp;\n        if (kvp[key]) {\n            if (self.debugLookup) {\n                console.log('in storage');\n            }\n            return kvp[key];\n        } else {\n            // Search ends here if query is a simple string\n            if (typeof query == 'string') {\n                if (self.debugLookup) {\n                    console.log('not found');\n                }\n                return null;\n            }\n\n            // More complex queries are assumed to be server requests\n            return self.fetch(query, true);\n        }\n    }\n\n    // Set value\n    async set(query, value) {\n        var self = this;\n        var key = self.toKey(query);\n        if (value === null) {\n            if (self.debugLookup) {\n                console.log('deleting ' + key);\n            }\n            self.dispatch({\n                type: REMOVE,\n                payload: { key }\n            });\n            return;\n        } else {\n            if (self.debugLookup) {\n                console.log('saving new value for ' + key);\n                if (self.debugValues) {\n                    console.log(value);\n                }\n            }\n            self.dispatch({\n                type: SET,\n                payload: { key, value }\n            });\n            return;\n        }\n    }\n\n    // Callback for localStorage failure - override to inform the user\n    storageFail(error) {\n        console.warn('Error persisting store:');\n        console.warn(error);\n    }\n\n    // Convert \"/url\" to {'url': \"url\"} (simplify common use case)\n    normalizeQuery(query) {\n        if (typeof query === 'string' && query.charAt(0) == '/') {\n            query = { url: query.replace(/^\\//, '') };\n        }\n        return query;\n    }\n\n    // Helper to allow simple objects to be used as keys\n    toKey(query) {\n        var self = this;\n        query = self.normalizeQuery(query);\n        if (!query) {\n            throw 'Invalid query!';\n        }\n        if (typeof query == 'string') {\n            return query;\n        } else {\n            return new URLSearchParams(query).toString();\n        }\n    }\n\n    // Helper to check existence of a key without loading the object\n    exists(query) {\n        var self = this;\n        var key = self.toKey(query);\n        return self.keys().then(function (keys) {\n            var found = false;\n            keys.forEach(function (k) {\n                if (k === key) {\n                    found = true;\n                }\n            });\n            return found;\n        });\n    }\n\n    // Fetch data from server\n    fetch(query, cache) {\n        var self = this;\n        query = self.normalizeQuery(query);\n        var key = self.toKey(query);\n        var data = { ...self.defaults, ...query };\n        var url = self.service;\n        if (data.hasOwnProperty('url')) {\n            url = url + '/' + data.url;\n            delete data.url;\n        }\n        if (data.format && !self.formatKeyword) {\n            url += '.' + data.format;\n            delete data.format;\n        }\n\n        if (this._promises[key]) {\n            return this._promises[key];\n        }\n\n        if (self.debugNetwork) {\n            console.log('fetching ' + key);\n        }\n\n        var promise = self.ajax(url, data, 'GET');\n        this._promises[key] = promise.then(\n            async data => {\n                delete this._promises[key];\n                if (!data) {\n                    self.fetchFail(query, 'Error parsing data!');\n                    return;\n                }\n                if (self.debugNetwork) {\n                    console.log('received result for ' + key);\n                    if (self.debugValues) {\n                        console.log(data);\n                    }\n                }\n                if (cache) {\n                    await self.set(query, data);\n                }\n                return data;\n            },\n            error => {\n                delete this._promises[key];\n                console.error(error);\n                self.fetchFail(query, 'Error parsing data!');\n            }\n        );\n        return this._promises[key];\n    }\n\n    // Hook to allow full AJAX customization\n    ajax(url, data, method, headers) {\n        var urlObj = new URL(url, window.location);\n        if (!method) {\n            method = 'GET';\n        } else {\n            method = method.toUpperCase();\n        }\n        if (method == 'GET') {\n            Object.entries(data || {}).forEach(([key, value]) =>\n                urlObj.searchParams.append(key, value)\n            );\n            data = null;\n        }\n        return fetch(urlObj, {\n            method: method,\n            body: data,\n            headers: headers\n        }).then(response => {\n            if (response.ok) {\n                if (response.status === 204) {\n                    return null;\n                } else {\n                    return response.json();\n                }\n            } else {\n                return response.text().then(result => {\n                    var error = new Error();\n                    try {\n                        error.json = JSON.parse(result);\n                    } catch (e) {\n                        error.text = result;\n                    }\n                    error.status = response.status;\n                    throw error;\n                });\n            }\n        });\n    }\n\n    // Callback for fetch() failures - override to inform the user\n    fetchFail(query, error) {\n        var self = this;\n        var key = self.toKey(query);\n        console.warn('Error loading ' + key + ': ' + error);\n    }\n\n    // Helper function for prefetching data\n    prefetch(query) {\n        var self = this;\n        return self.fetch(query, true);\n    }\n\n    // Clear local caches\n    async reset() {\n        this.dispatch({ type: CLEAR });\n        await this._persistor.purge();\n    }\n\n    // List storage keys matching this store's key prefix\n    async keys() {\n        return Object.keys(this.getState().kvp);\n    }\n}\n\nvar _stores = {};\n\n// Hybrid module object provides/is a singleton instance...\nvar ds = new Store('main');\n\n// ... and a way to retrieve/autoinit other stores\nds.getStore = getStore;\nfunction getStore(name) {\n    if (_stores[name]) {\n        return _stores[name];\n    } else {\n        return new Store(name);\n    }\n}\n\nexport default ds;\nexport { getStore, Store };\n"],"names":["_typeof","obj","Symbol","_typeof2","iterator","constructor","prototype","ownKeys","object","enumerableOnly","keys","Object","getOwnPropertySymbols","symbols","filter","sym","getOwnPropertyDescriptor","enumerable","push","apply","_objectSpread","target","i","arguments","length","source","forEach","key","_defineProperty","getOwnPropertyDescriptors","defineProperties","defineProperty","value","configurable","writable","autoMergeLevel2","inboundState","originalState","reducedState","_ref","debug","newState","isPlainEnoughObject","o","Array","isArray","createStorage","name","localForage","createInstance","serialize","deserialize","REMOVE","SET","CLEAR","_verbosity","Network","Lookup","Values","Store","_stores","service","undefined","defaults","ready","then","Error","_reducers","_enhanceReducers","_persistKeys","_transforms","_middleware","_enhancers","_subscribers","_deferActions","_thunkHandler","_promises","addReducer","state","action","kvpReducer","opts","self","optlist","opt","hasOwnProperty","level","addMiddleware","logger","storeReady","Promise","resolve","reducer","combineReducers","enhanceReducer","enhancers","compose","applyMiddleware","lf","persistConfig","storage","stateReconciler","transforms","whitelist","writeFailHandler","error","storageFail","persistedReducer","persistReducer","_store","createStore","_persistor","persistStore","subscribe","getState","bootstrapped","_unsubscribers","map","fn","dispatch","index","persist","persistKey","createTransform","middleware","enhancer","actions","bindActionCreators","bind","thunk","handler","type","payload","query","promises","row","get","all","normalizeQuery","toKey","debugLookup","console","log","kvp","fetch","debugValues","warn","charAt","url","replace","URLSearchParams","toString","found","k","cache","data","format","formatKeyword","debugNetwork","promise","ajax","fetchFail","set","method","headers","urlObj","URL","window","location","toUpperCase","entries","searchParams","append","body","response","ok","status","json","text","result","JSON","parse","e","purge","ds","getStore"],"mappings":"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"}