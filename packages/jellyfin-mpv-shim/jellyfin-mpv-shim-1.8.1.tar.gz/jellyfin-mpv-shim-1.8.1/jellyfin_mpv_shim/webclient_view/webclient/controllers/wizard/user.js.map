{"version":3,"sources":["controllers/wizard/user.js"],"names":["define","loading","globalize","getApiClient","ApiClient","onUpdateUserComplete","result","console","debug","hide","nextWizardPage","Dashboard","navigate","onSubmit","e","this","querySelector","value","require","toast","translate","submit","form","show","apiClient","ajax","type","data","Name","Password","url","getUrl","then","preventDefault","onViewShow","page","getJSON","user","view","params","addEventListener","document","classList","add","remove"],"mappings":"AAAA,aAAAA,OAAO,CAAC,UAAW,YAAa,eAAgB,aAAc,cAAe,gBAAgB,SAAUC,QAASC,WAG5G,SAASC,eACL,OAAOC,UAOX,SAASC,qBAAqBC,QAC1BC,QAAQC,MAAM,yBAA2BF,QACzCL,QAAQQ,OANZ,SAASC,iBACLC,UAAUC,SAAS,sBAMnBF,GAgBJ,SAASG,SAASC,GAYd,OAXWC,KAEFC,cAAc,sBAAsBC,OAFlCF,KAEgDC,cAAc,uBAAuBC,MAC5FC,QAAQ,CAAC,UAAU,SAAUC,OACzBA,MAAMjB,UAAUkB,UAAU,0BAlBtC,SAASC,OAAOC,MACZrB,QAAQsB,OACR,IAAIC,UAAYrB,eAChBqB,UAAUC,KAAK,CACXC,KAAM,OACNC,KAAM,CACFC,KAAMN,KAAKN,cAAc,gBAAgBC,MACzCY,SAAUP,KAAKN,cAAc,sBAAsBC,OAEvDa,IAAKN,UAAUO,OAAO,kBACvBC,KAAK3B,sBAWJgB,CAPON,MAUXD,EAAEmB,kBACK,EAGX,SAASC,aACLjC,QAAQsB,OACR,IAAIY,KAAOpB,KACPS,UAAYrB,eAChBqB,UAAUY,QAAQZ,UAAUO,OAAO,iBAAiBC,MAAK,SAAUK,MAC/DF,KAAKnB,cAAc,gBAAgBC,MAAQoB,KAAKT,MAAQ,GACxDO,KAAKnB,cAAc,sBAAsBC,MAAQoB,KAAKR,UAAY,GAClE5B,QAAQQ,UAIhB,OAAO,SAAU6B,KAAMC,QACnBD,KAAKtB,cAAc,mBAAmBwB,iBAAiB,SAAU3B,UACjEyB,KAAKE,iBAAiB,YAAY,WAC9BC,SAASzB,cAAc,eAAe0B,UAAUC,IAAI,yBAExDL,KAAKE,iBAAiB,YAAY,WAC9BC,SAASzB,cAAc,eAAe0B,UAAUE,OAAO,yBAE3DN,KAAKE,iBAAiB,WAAYN","file":"user.js","sourcesContent":["define(['loading', 'globalize', 'dashboardcss', 'emby-input', 'emby-button', 'emby-button'], function (loading, globalize) {\n    'use strict';\n\n    function getApiClient() {\n        return ApiClient;\n    }\n\n    function nextWizardPage() {\n        Dashboard.navigate('wizardlibrary.html');\n    }\n\n    function onUpdateUserComplete(result) {\n        console.debug('user update complete: ' + result);\n        loading.hide();\n        nextWizardPage();\n    }\n\n    function submit(form) {\n        loading.show();\n        var apiClient = getApiClient();\n        apiClient.ajax({\n            type: 'POST',\n            data: {\n                Name: form.querySelector('#txtUsername').value,\n                Password: form.querySelector('#txtManualPassword').value\n            },\n            url: apiClient.getUrl('Startup/User')\n        }).then(onUpdateUserComplete);\n    }\n\n    function onSubmit(e) {\n        var form = this;\n\n        if (form.querySelector('#txtManualPassword').value != form.querySelector('#txtPasswordConfirm').value) {\n            require(['toast'], function (toast) {\n                toast(globalize.translate('PasswordMatchError'));\n            });\n        } else {\n            submit(form);\n        }\n\n        e.preventDefault();\n        return false;\n    }\n\n    function onViewShow() {\n        loading.show();\n        var page = this;\n        var apiClient = getApiClient();\n        apiClient.getJSON(apiClient.getUrl('Startup/User')).then(function (user) {\n            page.querySelector('#txtUsername').value = user.Name || '';\n            page.querySelector('#txtManualPassword').value = user.Password || '';\n            loading.hide();\n        });\n    }\n\n    return function (view, params) {\n        view.querySelector('.wizardUserForm').addEventListener('submit', onSubmit);\n        view.addEventListener('viewshow', function () {\n            document.querySelector('.skinHeader').classList.add('noHomeButtonHeader');\n        });\n        view.addEventListener('viewhide', function () {\n            document.querySelector('.skinHeader').classList.remove('noHomeButtonHeader');\n        });\n        view.addEventListener('viewshow', onViewShow);\n    };\n});\n"]}