{"version":3,"sources":["controllers/dashboard/dlna/settings.js"],"names":["define","$","loading","libraryMenu","globalize","onSubmit","show","form","this","ApiClient","getNamedConfiguration","then","config","EnablePlayTo","querySelector","checked","EnableDebugLog","ClientDiscoveryIntervalSeconds","val","EnableServer","is","BlastAliveMessages","BlastAliveMessageIntervalSeconds","DefaultUserId","updateNamedConfiguration","Dashboard","processServerConfigurationUpdateResult","getTabs","href","name","translate","document","on","off","setTabs","page","promise1","promise2","getUsers","Promise","all","responses","loadPage","users","prop","usersHtml","map","u","Id","Name","join","html","hide"],"mappings":"AAAA,aAAAA,OAAO,CAAC,SAAU,UAAW,cAAe,cAAc,SAAUC,EAAGC,QAASC,YAAaC,WAiBzF,SAASC,WACLH,QAAQI,OACR,IAAIC,KAAOC,KAWX,OAVAC,UAAUC,sBAAsB,QAAQC,MAAK,SAAUC,QACnDA,OAAOC,aAAeN,KAAKO,cAAc,oBAAoBC,QAC7DH,OAAOI,eAAiBT,KAAKO,cAAc,8BAA8BC,QACzEH,OAAOK,+BAAiChB,EAAE,8BAA+BM,MAAMW,MAC/EN,OAAOO,aAAelB,EAAE,mBAAoBM,MAAMa,GAAG,YACrDR,OAAOS,mBAAqBpB,EAAE,yBAA0BM,MAAMa,GAAG,YACjER,OAAOU,iCAAmCrB,EAAE,oBAAqBM,MAAMW,MACvEN,OAAOW,cAAgBtB,EAAE,cAAeM,MAAMW,MAC9CT,UAAUe,yBAAyB,OAAQZ,QAAQD,KAAKc,UAAUC,4CAE/D,EAGX,SAASC,UACL,MAAO,CAAC,CACJC,KAAM,oBACNC,KAAMzB,UAAU0B,UAAU,gBAC3B,CACCF,KAAM,oBACNC,KAAMzB,UAAU0B,UAAU,iBAIlC7B,EAAE8B,UAAUC,GAAG,WAAY,qBAAqB,WAC5C/B,EAAE,qBAAqBgC,IAAI,SAAU5B,UAAU2B,GAAG,SAAU3B,aAC7D2B,GAAG,WAAY,qBAAqB,WACnC7B,YAAY+B,QAAQ,OAAQ,EAAGP,SAC/BzB,QAAQI,OACR,IAAI6B,KAAO3B,KACP4B,SAAW3B,UAAUC,sBAAsB,QAC3C2B,SAAW5B,UAAU6B,WACzBC,QAAQC,IAAI,CAACJ,SAAUC,WAAW1B,MAAK,SAAU8B,YAhDrD,SAASC,SAASP,KAAMvB,OAAQ+B,OAC5BR,KAAKrB,cAAc,oBAAoBC,QAAUH,OAAOC,aACxDsB,KAAKrB,cAAc,8BAA8BC,QAAUH,OAAOI,eAClEf,EAAE,8BAA+BkC,MAAMjB,IAAIN,OAAOK,gCAClDhB,EAAE,mBAAoBkC,MAAMS,KAAK,UAAWhC,OAAOO,cACnDlB,EAAE,yBAA0BkC,MAAMS,KAAK,UAAWhC,OAAOS,oBACzDpB,EAAE,oBAAqBkC,MAAMjB,IAAIN,OAAOU,kCACxC,IAAIuB,UAAYF,MAAMG,KAAI,SAAUC,GAChC,MAAO,kBAAoBA,EAAEC,GAAK,KAAOD,EAAEE,KAAO,eACnDC,KAAK,IACRjD,EAAE,cAAekC,MAAMgB,KAAKN,WAAW3B,IAAIN,OAAOW,eAAiB,IACnErB,QAAQkD,OAsCJV,CAASP,KAAMM,UAAU,GAAIA,UAAU","file":"settings.js","sourcesContent":["define(['jQuery', 'loading', 'libraryMenu', 'globalize'], function ($, loading, libraryMenu, globalize) {\n    'use strict';\n\n    function loadPage(page, config, users) {\n        page.querySelector('#chkEnablePlayTo').checked = config.EnablePlayTo;\n        page.querySelector('#chkEnableDlnaDebugLogging').checked = config.EnableDebugLog;\n        $('#txtClientDiscoveryInterval', page).val(config.ClientDiscoveryIntervalSeconds);\n        $('#chkEnableServer', page).prop('checked', config.EnableServer);\n        $('#chkBlastAliveMessages', page).prop('checked', config.BlastAliveMessages);\n        $('#txtBlastInterval', page).val(config.BlastAliveMessageIntervalSeconds);\n        var usersHtml = users.map(function (u) {\n            return '<option value=\"' + u.Id + '\">' + u.Name + '</option>';\n        }).join('');\n        $('#selectUser', page).html(usersHtml).val(config.DefaultUserId || '');\n        loading.hide();\n    }\n\n    function onSubmit() {\n        loading.show();\n        var form = this;\n        ApiClient.getNamedConfiguration('dlna').then(function (config) {\n            config.EnablePlayTo = form.querySelector('#chkEnablePlayTo').checked;\n            config.EnableDebugLog = form.querySelector('#chkEnableDlnaDebugLogging').checked;\n            config.ClientDiscoveryIntervalSeconds = $('#txtClientDiscoveryInterval', form).val();\n            config.EnableServer = $('#chkEnableServer', form).is(':checked');\n            config.BlastAliveMessages = $('#chkBlastAliveMessages', form).is(':checked');\n            config.BlastAliveMessageIntervalSeconds = $('#txtBlastInterval', form).val();\n            config.DefaultUserId = $('#selectUser', form).val();\n            ApiClient.updateNamedConfiguration('dlna', config).then(Dashboard.processServerConfigurationUpdateResult);\n        });\n        return false;\n    }\n\n    function getTabs() {\n        return [{\n            href: 'dlnasettings.html',\n            name: globalize.translate('TabSettings')\n        }, {\n            href: 'dlnaprofiles.html',\n            name: globalize.translate('TabProfiles')\n        }];\n    }\n\n    $(document).on('pageinit', '#dlnaSettingsPage', function () {\n        $('.dlnaSettingsForm').off('submit', onSubmit).on('submit', onSubmit);\n    }).on('pageshow', '#dlnaSettingsPage', function () {\n        libraryMenu.setTabs('dlna', 0, getTabs);\n        loading.show();\n        var page = this;\n        var promise1 = ApiClient.getNamedConfiguration('dlna');\n        var promise2 = ApiClient.getUsers();\n        Promise.all([promise1, promise2]).then(function (responses) {\n            loadPage(page, responses[0], responses[1]);\n        });\n    });\n});\n"]}