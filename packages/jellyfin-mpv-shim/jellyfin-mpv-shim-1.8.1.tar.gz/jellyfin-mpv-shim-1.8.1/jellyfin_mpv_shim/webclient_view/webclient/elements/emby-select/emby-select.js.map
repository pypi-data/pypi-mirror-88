{"version":3,"sources":["elements/emby-select/emby-select.js"],"names":["define","layoutManager","browser","actionsheet","EmbySelectPrototype","Object","create","HTMLSelectElement","prototype","enableNativeMenu","edgeUwp","xboxOne","tizen","orsay","web0s","tv","showActionSheet","select","labelElem","getLabel","title","textContent","innerText","show","items","options","positionTo","then","value","setValue","triggerChange","evt","document","createEvent","initEvent","dispatchEvent","elem","previousSibling","tagName","onFocus","e","label","this","classList","add","onBlur","remove","onMouseDown","button","preventDefault","onKeyDown","keyCode","inputId","createdCallback","id","addEventListener","attachedCallback","contains","ownerDocument","createElement","innerHTML","getAttribute","htmlFor","parentNode","insertBefore","insertAdjacentHTML","setLabel","text","querySelector","registerElement","extends"],"mappings":"AAAA,aAAAA,OAAO,CAAC,gBAAiB,UAAW,cAAe,oBAAqB,kBAAkB,SAAUC,cAAeC,QAASC,aAGxH,IAAIC,oBAAsBC,OAAOC,OAAOC,kBAAkBC,WAE1D,SAASC,mBAEL,SAAIP,QAAQQ,UAAWR,QAAQS,YAK3BT,QAAQU,OAASV,QAAQW,OAASX,QAAQY,WAK1CZ,QAAQa,KAIRd,cAAcc,IAkBtB,SAASC,gBAAgBC,QAErB,IAAIC,UAAYC,SAASF,QACrBG,MAAQF,UAAaA,UAAUG,aAAeH,UAAUI,UAAa,KAEzEnB,YAAYoB,KAAK,CACbC,MAAOP,OAAOQ,QACdC,WAAYT,OACZG,MAAOA,QAERO,MAAK,SAAUC,QAftB,SAASC,SAASZ,OAAQW,OAEtBX,OAAOW,MAAQA,MAcXC,CAASZ,OAAQW,OAtBzB,SAASE,cAAcb,QACnB,IAAIc,IAAMC,SAASC,YAAY,cAC/BF,IAAIG,UAAU,UAAU,GAAO,GAC/BjB,OAAOkB,cAAcJ,KAoBjBD,CAAcb,WAItB,SAASE,SAASF,QAEd,IADA,IAAImB,KAAOnB,OAAOoB,gBACXD,MAAyB,UAAjBA,KAAKE,SAChBF,KAAOA,KAAKC,gBAEhB,OAAOD,KAGX,SAASG,QAAQC,GACb,IAAIC,MAAQtB,SAASuB,MACjBD,OACAA,MAAME,UAAUC,IAAI,sBAI5B,SAASC,OAAOL,GACZ,IAAIC,MAAQtB,SAASuB,MACjBD,OACAA,MAAME,UAAUG,OAAO,sBAI/B,SAASC,YAAYP,GAGZA,EAAEQ,QAAWvC,qBACd+B,EAAES,iBACFjC,gBAAgB0B,OAIxB,SAASQ,UAAUV,GAEf,OAAQA,EAAEW,SAEN,KAAK,GAKD,YAJK1C,qBACD+B,EAAES,iBACFjC,gBAAgB0B,QAGxB,KAAK,GACL,KAAK,GACL,KAAK,GACL,KAAK,GAID,YAHIzC,cAAcc,IACdyB,EAAES,mBAQlB,IAAIG,QAAU,EAEdhD,oBAAoBiD,gBAAkB,WAE7BX,KAAKY,KACNZ,KAAKY,GAAK,aAAeF,QACzBA,WAGJV,KAAKC,UAAUC,IAAI,yBAEf3C,cAAcc,IACd2B,KAAKC,UAAUC,IAAI,0BAGvBF,KAAKa,iBAAiB,YAAaR,aACnCL,KAAKa,iBAAiB,UAAWL,WAEjCR,KAAKa,iBAAiB,QAAShB,SAC/BG,KAAKa,iBAAiB,OAAQV,SAGlCzC,oBAAoBoD,iBAAmB,WAEnC,IAAId,KAAKC,UAAUc,SAAS,eAA5B,CAIAf,KAAKC,UAAUC,IAAI,eAEnB,IAAIH,MAAQC,KAAKgB,cAAcC,cAAc,SAC7ClB,MAAMmB,UAAYlB,KAAKmB,aAAa,UAAY,GAChDpB,MAAME,UAAUC,IAAI,eACpBH,MAAMqB,QAAUpB,KAAKY,GACrBZ,KAAKqB,WAAWC,aAAavB,MAAOC,MAEhCA,KAAKC,UAAUc,SAAS,0BACxBf,KAAKqB,WAAWE,mBAAmB,YAAa,sKAIxD7D,oBAAoB8D,SAAW,SAAUC,MAEzBzB,KAAKqB,WAAWK,cAAc,SAEpCR,UAAYO,MAGtBnC,SAASqC,gBAAgB,cAAe,CACpC7D,UAAWJ,oBACXkE,QAAS","file":"emby-select.js","sourcesContent":["define(['layoutManager', 'browser', 'actionsheet', 'css!./emby-select', 'webcomponents'], function (layoutManager, browser, actionsheet) {\n    'use strict';\n\n    var EmbySelectPrototype = Object.create(HTMLSelectElement.prototype);\n\n    function enableNativeMenu() {\n\n        if (browser.edgeUwp || browser.xboxOne) {\n            return true;\n        }\n\n        // Doesn't seem to work at all\n        if (browser.tizen || browser.orsay || browser.web0s) {\n            return false;\n        }\n\n        // Take advantage of the native input methods\n        if (browser.tv) {\n            return true;\n        }\n\n        if (layoutManager.tv) {\n            return false;\n        }\n\n        return true;\n    }\n\n    function triggerChange(select) {\n        var evt = document.createEvent('HTMLEvents');\n        evt.initEvent('change', false, true);\n        select.dispatchEvent(evt);\n    }\n\n    function setValue(select, value) {\n\n        select.value = value;\n    }\n\n    function showActionSheet(select) {\n\n        var labelElem = getLabel(select);\n        var title = labelElem ? (labelElem.textContent || labelElem.innerText) : null;\n\n        actionsheet.show({\n            items: select.options,\n            positionTo: select,\n            title: title\n\n        }).then(function (value) {\n            setValue(select, value);\n            triggerChange(select);\n        });\n    }\n\n    function getLabel(select) {\n        var elem = select.previousSibling;\n        while (elem && elem.tagName !== 'LABEL') {\n            elem = elem.previousSibling;\n        }\n        return elem;\n    }\n\n    function onFocus(e) {\n        var label = getLabel(this);\n        if (label) {\n            label.classList.add('selectLabelFocused');\n        }\n    }\n\n    function onBlur(e) {\n        var label = getLabel(this);\n        if (label) {\n            label.classList.remove('selectLabelFocused');\n        }\n    }\n\n    function onMouseDown(e) {\n\n        // e.button=0 for primary (left) mouse button click\n        if (!e.button && !enableNativeMenu()) {\n            e.preventDefault();\n            showActionSheet(this);\n        }\n    }\n\n    function onKeyDown(e) {\n\n        switch (e.keyCode) {\n\n            case 13:\n                if (!enableNativeMenu()) {\n                    e.preventDefault();\n                    showActionSheet(this);\n                }\n                return;\n            case 37:\n            case 38:\n            case 39:\n            case 40:\n                if (layoutManager.tv) {\n                    e.preventDefault();\n                }\n                return;\n            default:\n                break;\n        }\n    }\n\n    var inputId = 0;\n\n    EmbySelectPrototype.createdCallback = function () {\n\n        if (!this.id) {\n            this.id = 'embyselect' + inputId;\n            inputId++;\n        }\n\n        this.classList.add('emby-select-withcolor');\n\n        if (layoutManager.tv) {\n            this.classList.add('emby-select-focusscale');\n        }\n\n        this.addEventListener('mousedown', onMouseDown);\n        this.addEventListener('keydown', onKeyDown);\n\n        this.addEventListener('focus', onFocus);\n        this.addEventListener('blur', onBlur);\n    };\n\n    EmbySelectPrototype.attachedCallback = function () {\n\n        if (this.classList.contains('emby-select')) {\n            return;\n        }\n\n        this.classList.add('emby-select');\n\n        var label = this.ownerDocument.createElement('label');\n        label.innerHTML = this.getAttribute('label') || '';\n        label.classList.add('selectLabel');\n        label.htmlFor = this.id;\n        this.parentNode.insertBefore(label, this);\n\n        if (this.classList.contains('emby-select-withcolor')) {\n            this.parentNode.insertAdjacentHTML('beforeend', '<div class=\"selectArrowContainer\"><div style=\"visibility:hidden;display:none;\">0</div><span class=\"selectArrow material-icons keyboard_arrow_down\"></span></div>');\n        }\n    };\n\n    EmbySelectPrototype.setLabel = function (text) {\n\n        var label = this.parentNode.querySelector('label');\n\n        label.innerHTML = text;\n    };\n\n    document.registerElement('emby-select', {\n        prototype: EmbySelectPrototype,\n        extends: 'select'\n    });\n});\n"]}