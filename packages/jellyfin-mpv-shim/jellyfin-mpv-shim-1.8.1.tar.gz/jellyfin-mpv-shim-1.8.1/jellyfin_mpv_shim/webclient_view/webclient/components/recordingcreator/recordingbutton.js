"use strict";define(["globalize","connectionManager","require","loading","apphost","dom","recordingHelper","events","paper-icon-button-light","emby-button","css!./recordingfields"],(function(globalize,connectionManager,require,loading,appHost,dom,recordingHelper,events){function onRecordingButtonClick(e){var item=this.item;if(item){var serverId=item.ServerId,programId=item.Id,timerId=item.TimerId,timerStatus=item.Status,seriesTimerId=item.SeriesTimerId,instance=this;recordingHelper.toggleRecording(serverId,programId,timerId,timerStatus,seriesTimerId).then((function(){instance.refresh(serverId,programId)}))}}function setButtonIcon(button,icon){var inner=button.querySelector(".material-icons");inner.classList.remove("fiber_smart_record"),inner.classList.remove("fiber_manual_record"),inner.classList.add(icon)}function RecordingButton(options){this.options=options;var button=options.button;setButtonIcon(button,"fiber_manual_record"),options.item?this.refreshItem(options.item):options.itemId&&options.serverId&&this.refresh(options.itemId,options.serverId);var clickFn=onRecordingButtonClick.bind(this);this.clickFn=clickFn,dom.addEventListener(button,"click",clickFn,{passive:!0})}return RecordingButton.prototype.refresh=function(serverId,itemId){var apiClient=connectionManager.getApiClient(serverId),self=this;apiClient.getItem(apiClient.getCurrentUserId(),itemId).then((function(item){self.refreshItem(item)}))},RecordingButton.prototype.refreshItem=function(item){var button=this.options.button;this.item=item,setButtonIcon(button,function getIndicatorIcon(item){var status;if("SeriesTimer"===item.Type)return"fiber_smart_record";if(item.TimerId||item.SeriesTimerId)status=item.Status||"Cancelled";else{if("Timer"!==item.Type)return"fiber_manual_record";status=item.Status}return item.SeriesTimerId&&"Cancelled"!==status?"fiber_smart_record":"fiber_manual_record"}(item)),item.TimerId&&"Cancelled"!==(item.Status||"Cancelled")?button.classList.add("recordingIcon-active"):button.classList.remove("recordingIcon-active")},RecordingButton.prototype.destroy=function(){var options=this.options;if(options){var button=options.button,clickFn=this.clickFn;clickFn&&dom.removeEventListener(button,"click",clickFn,{passive:!0})}this.options=null,this.item=null},RecordingButton}));
//# sourceMappingURL=recordingbutton.js.map
