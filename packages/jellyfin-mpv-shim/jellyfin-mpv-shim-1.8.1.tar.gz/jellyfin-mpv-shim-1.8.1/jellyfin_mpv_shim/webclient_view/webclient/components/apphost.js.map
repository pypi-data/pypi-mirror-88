{"version":3,"sources":["components/apphost.js"],"names":["define","appSettings","browser","events","htmlMediaHelper","webSettings","globalize","getBaseProfileOptions","item","disableHlsVideoAudioCodecs","enableHlsJsPlayer","RunTimeTicks","MediaType","edge","push","enableMkvProgressive","generateDeviceId","keys","navigator","userAgent","Date","getTime","self","btoa","result","replaceAll","originalString","strReplace","strWith","strReplace2","escapeRegExp","str","replace","reg","RegExp","join","Promise","resolve","onAppVisible","isHidden","console","debug","trigger","appHost","onAppHidden","features","exitPromise","deviceId","deviceName","supportedFeatures","share","edgeUwp","tv","xboxOne","ps4","operaTv","tizen","orsay","web0s","supportsVoiceInput","window","SpeechRecognition","webkitSpeechRecognition","mozSpeechRecognition","oSpeechRecognition","msSpeechRecognition","supportsHtmlMediaAutoplay","mobile","supportsFullscreen","element","document","documentElement","requestFullscreen","mozRequestFullScreen","webkitRequestFullscreen","msRequestFullscreen","createElement","webkitEnterFullscreen","chrome","slow","noAnimation","enableMultiServer","then","enabled","firefox","supportsCue","video","style","textContent","body","appendChild","cue","getComputedStyle","background","removeChild","length","err","error","edgeChromium","doExit","NativeShell","AppHost","exit","application","getCurrentApplication","webOS","platformBack","close","hidden","visibilityChange","getWindowState","windowState","setWindowState","state","alert","appMode","askForExit","require","actionsheet","show","title","translate","items","id","name","value","finally","supports","command","indexOf","toLowerCase","preferVisualCards","android","getSyncProfile","profileBuilder","profile","MaxStaticMusicBitrate","maxStaticMusicBitrate","getDefaultLayout","getDeviceProfile","options","Windows","getDeviceProfileForWindowsUwp","reject","uwpMediaCaps","profileOptions","supportsDts","supportsDTS","supportsTrueHd","supportsDolby","audioChannels","getAudioChannels","builderOpts","enableSsaRender","isRetry","get","init","getDeviceName","opera","safari","ipad","iphone","getDeviceId","key","set","appName","appVersion","getPushTokenInfo","setThemeColor","color","metaThemeColor","querySelector","setAttribute","setUserScalable","scalable","att","webkitHidden","addEventListener"],"mappings":"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","file":"apphost.js","sourcesContent":["define(['appSettings', 'browser', 'events', 'htmlMediaHelper', 'webSettings', 'globalize'], function (appSettings, browser, events, htmlMediaHelper, webSettings, globalize) {\n    'use strict';\n\n    function getBaseProfileOptions(item) {\n        var disableHlsVideoAudioCodecs = [];\n\n        if (item && htmlMediaHelper.enableHlsJsPlayer(item.RunTimeTicks, item.MediaType)) {\n            if (browser.edge) {\n                disableHlsVideoAudioCodecs.push('mp3');\n            }\n\n            disableHlsVideoAudioCodecs.push('ac3');\n            disableHlsVideoAudioCodecs.push('eac3');\n            disableHlsVideoAudioCodecs.push('opus');\n        }\n\n        return {\n            enableMkvProgressive: false,\n            disableHlsVideoAudioCodecs: disableHlsVideoAudioCodecs\n        };\n    }\n\n    function getDeviceProfileForWindowsUwp(item) {\n        return new Promise(function (resolve, reject) {\n            require(['browserdeviceprofile', 'environments/windows-uwp/mediacaps'], function (profileBuilder, uwpMediaCaps) {\n                var profileOptions = getBaseProfileOptions(item);\n                profileOptions.supportsDts = uwpMediaCaps.supportsDTS();\n                profileOptions.supportsTrueHd = uwpMediaCaps.supportsDolby();\n                profileOptions.audioChannels = uwpMediaCaps.getAudioChannels();\n                resolve(profileBuilder(profileOptions));\n            });\n        });\n    }\n\n    function getDeviceProfile(item, options) {\n        options = options || {};\n\n        if (self.Windows) {\n            return getDeviceProfileForWindowsUwp(item);\n        }\n\n        return new Promise(function (resolve) {\n            require(['browserdeviceprofile'], function (profileBuilder) {\n                var profile;\n\n                if (window.NativeShell) {\n                    profile = window.NativeShell.AppHost.getDeviceProfile(profileBuilder);\n                } else {\n                    var builderOpts = getBaseProfileOptions(item);\n                    builderOpts.enableSsaRender = (item && !options.isRetry && 'allcomplexformats' !== appSettings.get('subtitleburnin'));\n                    profile = profileBuilder(builderOpts);\n                }\n\n                resolve(profile);\n            });\n        });\n    }\n\n    function escapeRegExp(str) {\n        return str.replace(/([.*+?^=!:${}()|\\[\\]\\/\\\\])/g, '\\\\$1');\n    }\n\n    function replaceAll(originalString, strReplace, strWith) {\n        var strReplace2 = escapeRegExp(strReplace);\n        var reg = new RegExp(strReplace2, 'ig');\n        return originalString.replace(reg, strWith);\n    }\n\n    function generateDeviceId() {\n        var keys = [];\n\n        if (keys.push(navigator.userAgent), keys.push(new Date().getTime()), self.btoa) {\n            var result = replaceAll(btoa(keys.join('|')), '=', '1');\n            return Promise.resolve(result);\n        }\n\n        return Promise.resolve(new Date().getTime());\n    }\n\n    function getDeviceId() {\n        var key = '_deviceId2';\n        var deviceId = appSettings.get(key);\n\n        if (deviceId) {\n            return Promise.resolve(deviceId);\n        }\n\n        return generateDeviceId().then(function (deviceId) {\n            appSettings.set(key, deviceId);\n            return deviceId;\n        });\n    }\n\n    function getDeviceName() {\n        var deviceName;\n        if (browser.tizen) {\n            deviceName = 'Samsung Smart TV';\n        } else if (browser.web0s) {\n            deviceName = 'LG Smart TV';\n        } else if (browser.operaTv) {\n            deviceName = 'Opera TV';\n        } else if (browser.xboxOne) {\n            deviceName = 'Xbox One';\n        } else if (browser.ps4) {\n            deviceName = 'Sony PS4';\n        } else if (browser.chrome) {\n            deviceName = 'Chrome';\n        } else if (browser.edgeChromium) {\n            deviceName = 'Edge Chromium';\n        } else if (browser.edge) {\n            deviceName = 'Edge';\n        } else if (browser.firefox) {\n            deviceName = 'Firefox';\n        } else if (browser.opera) {\n            deviceName = 'Opera';\n        } else if (browser.safari) {\n            deviceName = 'Safari';\n        } else {\n            deviceName = 'Web Browser';\n        }\n\n        if (browser.ipad) {\n            deviceName += ' iPad';\n        } else if (browser.iphone) {\n            deviceName += ' iPhone';\n        } else if (browser.android) {\n            deviceName += ' Android';\n        }\n\n        return deviceName;\n    }\n\n    function supportsVoiceInput() {\n        if (!browser.tv) {\n            return window.SpeechRecognition || window.webkitSpeechRecognition || window.mozSpeechRecognition || window.oSpeechRecognition || window.msSpeechRecognition;\n        }\n\n        return false;\n    }\n\n    function supportsFullscreen() {\n        if (browser.tv) {\n            return false;\n        }\n\n        var element = document.documentElement;\n        return (element.requestFullscreen || element.mozRequestFullScreen || element.webkitRequestFullscreen || element.msRequestFullscreen) || document.createElement('video').webkitEnterFullscreen;\n    }\n\n    function getSyncProfile() {\n        return new Promise(function (resolve) {\n            require(['browserdeviceprofile', 'appSettings'], function (profileBuilder, appSettings) {\n                var profile;\n\n                if (window.NativeShell) {\n                    profile = window.NativeShell.AppHost.getSyncProfile(profileBuilder, appSettings);\n                } else {\n                    profile = profileBuilder();\n                    profile.MaxStaticMusicBitrate = appSettings.maxStaticMusicBitrate();\n                }\n\n                resolve(profile);\n            });\n        });\n    }\n\n    function getDefaultLayout() {\n        return 'desktop';\n    }\n\n    function supportsHtmlMediaAutoplay() {\n        if (browser.edgeUwp || browser.tizen || browser.web0s || browser.orsay || browser.operaTv || browser.ps4 || browser.xboxOne) {\n            return true;\n        }\n\n        if (browser.mobile) {\n            return false;\n        }\n\n        return true;\n    }\n\n    function supportsCue() {\n        try {\n            var video = document.createElement('video');\n            var style = document.createElement('style');\n\n            style.textContent = 'video::cue {background: inherit}';\n            document.body.appendChild(style);\n            document.body.appendChild(video);\n\n            var cue = window.getComputedStyle(video, '::cue').background;\n            document.body.removeChild(style);\n            document.body.removeChild(video);\n\n            return !!cue.length;\n        } catch (err) {\n            console.error('error detecting cue support: ' + err);\n            return false;\n        }\n    }\n\n    function onAppVisible() {\n        if (isHidden) {\n            isHidden = false;\n            console.debug('triggering app resume event');\n            events.trigger(appHost, 'resume');\n        }\n    }\n\n    function onAppHidden() {\n        if (!isHidden) {\n            isHidden = true;\n            console.debug('app is hidden');\n        }\n    }\n\n    var supportedFeatures = function () {\n        var features = [];\n\n        if (navigator.share) {\n            features.push('sharing');\n        }\n\n        if (!browser.edgeUwp && !browser.tv && !browser.xboxOne && !browser.ps4) {\n            features.push('filedownload');\n        }\n\n        if (browser.operaTv || browser.tizen || browser.orsay || browser.web0s) {\n            features.push('exit');\n        } else {\n            features.push('exitmenu');\n            features.push('plugins');\n        }\n\n        if (!browser.operaTv && !browser.tizen && !browser.orsay && !browser.web0s && !browser.ps4) {\n            features.push('externallinks');\n            features.push('externalpremium');\n        }\n\n        if (!browser.operaTv) {\n            features.push('externallinkdisplay');\n        }\n\n        if (supportsVoiceInput()) {\n            features.push('voiceinput');\n        }\n\n        if (supportsHtmlMediaAutoplay()) {\n            features.push('htmlaudioautoplay');\n            features.push('htmlvideoautoplay');\n        }\n\n        if (browser.edgeUwp) {\n            features.push('sync');\n        }\n\n        if (supportsFullscreen()) {\n            features.push('fullscreenchange');\n        }\n\n        if (browser.chrome || browser.edge && !browser.slow) {\n            if (!browser.noAnimation && !browser.edgeUwp && !browser.xboxOne) {\n                features.push('imageanalysis');\n            }\n        }\n\n        if (browser.tv || browser.xboxOne || browser.ps4 || browser.mobile) {\n            features.push('physicalvolumecontrol');\n        }\n\n        if (!browser.tv && !browser.xboxOne && !browser.ps4) {\n            features.push('remotecontrol');\n        }\n\n        if (!browser.operaTv && !browser.tizen && !browser.orsay && !browser.web0s && !browser.edgeUwp) {\n            features.push('remotevideo');\n        }\n\n        features.push('displaylanguage');\n        features.push('otherapppromotions');\n        features.push('displaymode');\n        features.push('targetblank');\n        features.push('screensaver');\n\n        webSettings.enableMultiServer().then(enabled => {\n            if (enabled) features.push('multiserver');\n        });\n\n        if (!browser.orsay && (browser.firefox || browser.ps4 || browser.edge || supportsCue())) {\n            features.push('subtitleappearancesettings');\n        }\n\n        if (!browser.orsay) {\n            features.push('subtitleburnsettings');\n        }\n\n        if (!browser.tv && !browser.ps4 && !browser.xboxOne) {\n            features.push('fileinput');\n        }\n\n        if (browser.chrome || browser.edgeChromium) {\n            features.push('chromecast');\n        }\n\n        return features;\n    }();\n\n    /**\n      * Do exit according to platform\n      */\n    function doExit() {\n        try {\n            if (window.NativeShell) {\n                window.NativeShell.AppHost.exit();\n            } else if (browser.tizen) {\n                tizen.application.getCurrentApplication().exit();\n            } else if (browser.web0s) {\n                webOS.platformBack();\n            } else {\n                window.close();\n            }\n        } catch (err) {\n            console.error('error closing application: ' + err);\n        }\n    }\n\n    var exitPromise;\n\n    /**\n      * Ask user for exit\n      */\n    function askForExit() {\n        if (exitPromise) {\n            return;\n        }\n\n        require(['actionsheet'], function (actionsheet) {\n            exitPromise = actionsheet.show({\n                title: globalize.translate('MessageConfirmAppExit'),\n                items: [\n                    {id: 'yes', name: globalize.translate('Yes')},\n                    {id: 'no', name: globalize.translate('No')}\n                ]\n            }).then(function (value) {\n                if (value === 'yes') {\n                    doExit();\n                }\n            }).finally(function () {\n                exitPromise = null;\n            });\n        });\n    }\n\n    var deviceId;\n    var deviceName;\n    var appName = 'Jellyfin Web';\n    var appVersion = '10.6.2';\n\n    var appHost = {\n        getWindowState: function () {\n            return document.windowState || 'Normal';\n        },\n        setWindowState: function (state) {\n            alert('setWindowState is not supported and should not be called');\n        },\n        exit: function () {\n            if (!!window.appMode && browser.tizen) {\n                askForExit();\n            } else {\n                doExit();\n            }\n        },\n        supports: function (command) {\n            if (window.NativeShell) {\n                return window.NativeShell.AppHost.supports(command);\n            }\n\n            return -1 !== supportedFeatures.indexOf(command.toLowerCase());\n        },\n        preferVisualCards: browser.android || browser.chrome,\n        getSyncProfile: getSyncProfile,\n        getDefaultLayout: function () {\n            if (window.NativeShell) {\n                return window.NativeShell.AppHost.getDefaultLayout();\n            }\n\n            return getDefaultLayout();\n        },\n        getDeviceProfile: getDeviceProfile,\n        init: function () {\n            if (window.NativeShell) {\n                return window.NativeShell.AppHost.init();\n            }\n\n            deviceName = getDeviceName();\n            getDeviceId().then(function (id) {\n                deviceId = id;\n            });\n        },\n        deviceName: function () {\n            return window.NativeShell ? window.NativeShell.AppHost.deviceName() : deviceName;\n        },\n        deviceId: function () {\n            return window.NativeShell ? window.NativeShell.AppHost.deviceId() : deviceId;\n        },\n        appName: function () {\n            return window.NativeShell ? window.NativeShell.AppHost.appName() : appName;\n        },\n        appVersion: function () {\n            return window.NativeShell ? window.NativeShell.AppHost.appVersion() : appVersion;\n        },\n        getPushTokenInfo: function () {\n            return {};\n        },\n        setThemeColor: function (color) {\n            var metaThemeColor = document.querySelector('meta[name=theme-color]');\n\n            if (metaThemeColor) {\n                metaThemeColor.setAttribute('content', color);\n            }\n        },\n        setUserScalable: function (scalable) {\n            if (!browser.tv) {\n                var att = scalable ? 'width=device-width, initial-scale=1, minimum-scale=1, user-scalable=yes' : 'width=device-width, initial-scale=1, minimum-scale=1, maximum-scale=1, user-scalable=no';\n                document.querySelector('meta[name=viewport]').setAttribute('content', att);\n            }\n        }\n    };\n\n    var isHidden = false;\n    var hidden;\n    var visibilityChange;\n\n    if (typeof document.hidden !== 'undefined') { /* eslint-disable-line compat/compat */\n        hidden = 'hidden';\n        visibilityChange = 'visibilitychange';\n    } else if (typeof document.webkitHidden !== 'undefined') {\n        hidden = 'webkitHidden';\n        visibilityChange = 'webkitvisibilitychange';\n    }\n\n    document.addEventListener(visibilityChange, function () {\n        /* eslint-disable-next-line compat/compat */\n        if (document[hidden]) {\n            onAppHidden();\n        } else {\n            onAppVisible();\n        }\n    }, false);\n\n    if (self.addEventListener) {\n        self.addEventListener('focus', onAppVisible);\n        self.addEventListener('blur', onAppHidden);\n    }\n\n    return appHost;\n});\n"]}