{"version":3,"sources":["scripts/itembynamedetailpage.js"],"names":["define","connectionManager","listView","cardBuilder","imageLoader","libraryBrowser","globalize","renderSection","page","item","element","type","loadItems","MediaTypes","IncludeItemTypes","PersonTypes","ArtistIds","AlbumArtistIds","Limit","SortBy","shape","showTitle","centerText","overlayMoreButton","preferThumb","overlayText","showAirTime","showAirDateTime","showChannelName","showYear","overlayPlayButton","SortOrder","playFromHere","coverImage","showParentTitle","action","smallIcon","artist","query","listOptions","getItemsFunction","options","getQuery","index","limit","fields","StartIndex","Fields","apiClient","getApiClient","ServerId","getAlbumArtists","getCurrentUserId","getItems","then","result","html","TotalRecordCount","link","querySelector","classList","remove","setAttribute","getMoreItemsHref","Type","Id","add","items","Items","itemsContainer","getListViewHtml","getCardsHtml","innerHTML","lazyChildren","Recursive","CollapseBoxSetItems","addCurrentItemToQuery","PersonIds","Genres","Name","StudioIds","Object","assign","window","ItemsByName","renderItems","sections","ArtistCount","push","name","translate","ProgramCount","MovieCount","SeriesCount","EpisodeCount","TrailerCount","AlbumCount","MusicVideoCount","elem","map","section","sectionClass","join","sectionElems","querySelectorAll","i","length","getAttribute"],"mappings":"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","file":"itembynamedetailpage.js","sourcesContent":["define(['connectionManager', 'listView', 'cardBuilder', 'imageLoader', 'libraryBrowser', 'globalize', 'emby-itemscontainer', 'emby-button'], function (connectionManager, listView, cardBuilder, imageLoader, libraryBrowser, globalize) {\n    'use strict';\n\n    function renderItems(page, item) {\n        var sections = [];\n\n        if (item.ArtistCount) {\n            sections.push({\n                name: globalize.translate('TabArtists'),\n                type: 'MusicArtist'\n            });\n        }\n\n        if (item.ProgramCount && 'Person' == item.Type) {\n            sections.push({\n                name: globalize.translate('HeaderUpcomingOnTV'),\n                type: 'Program'\n            });\n        }\n\n        if (item.MovieCount) {\n            sections.push({\n                name: globalize.translate('TabMovies'),\n                type: 'Movie'\n            });\n        }\n\n        if (item.SeriesCount) {\n            sections.push({\n                name: globalize.translate('TabShows'),\n                type: 'Series'\n            });\n        }\n\n        if (item.EpisodeCount) {\n            sections.push({\n                name: globalize.translate('TabEpisodes'),\n                type: 'Episode'\n            });\n        }\n\n        if (item.TrailerCount) {\n            sections.push({\n                name: globalize.translate('TabTrailers'),\n                type: 'Trailer'\n            });\n        }\n\n        if (item.AlbumCount) {\n            sections.push({\n                name: globalize.translate('TabAlbums'),\n                type: 'MusicAlbum'\n            });\n        }\n\n        if (item.MusicVideoCount) {\n            sections.push({\n                name: globalize.translate('TabMusicVideos'),\n                type: 'MusicVideo'\n            });\n        }\n\n        var elem = page.querySelector('#childrenContent');\n        elem.innerHTML = sections.map(function (section) {\n            var html = '';\n            var sectionClass = 'verticalSection';\n\n            if ('Audio' === section.type) {\n                sectionClass += ' verticalSection-extrabottompadding';\n            }\n\n            html += '<div class=\"' + sectionClass + '\" data-type=\"' + section.type + '\">';\n            html += '<div class=\"sectionTitleContainer sectionTitleContainer-cards\">';\n            html += '<h2 class=\"sectionTitle sectionTitle-cards\">';\n            html += section.name;\n            html += '</h2>';\n            html += '<a is=\"emby-linkbutton\" href=\"#\" class=\"clearLink hide\" style=\"margin-left:1em;vertical-align:middle;\"><button is=\"emby-button\" type=\"button\" class=\"raised more raised-mini noIcon\">' + globalize.translate('ButtonMore') + '</button></a>';\n            html += '</div>';\n            html += '<div is=\"emby-itemscontainer\" class=\"itemsContainer padded-right\">';\n            html += '</div>';\n            return html += '</div>';\n        }).join('');\n        var sectionElems = elem.querySelectorAll('.verticalSection');\n\n        for (var i = 0, length = sectionElems.length; i < length; i++) {\n            renderSection(page, item, sectionElems[i], sectionElems[i].getAttribute('data-type'));\n        }\n    }\n\n    function renderSection(page, item, element, type) {\n        switch (type) {\n            case 'Program':\n                loadItems(element, item, type, {\n                    MediaTypes: '',\n                    IncludeItemTypes: 'Program',\n                    PersonTypes: '',\n                    ArtistIds: '',\n                    AlbumArtistIds: '',\n                    Limit: 10,\n                    SortBy: 'StartDate'\n                }, {\n                    shape: 'overflowBackdrop',\n                    showTitle: true,\n                    centerText: true,\n                    overlayMoreButton: true,\n                    preferThumb: true,\n                    overlayText: false,\n                    showAirTime: true,\n                    showAirDateTime: true,\n                    showChannelName: true\n                });\n                break;\n\n            case 'Movie':\n                loadItems(element, item, type, {\n                    MediaTypes: '',\n                    IncludeItemTypes: 'Movie',\n                    PersonTypes: '',\n                    ArtistIds: '',\n                    AlbumArtistIds: '',\n                    Limit: 10,\n                    SortBy: 'SortName'\n                }, {\n                    shape: 'overflowPortrait',\n                    showTitle: true,\n                    centerText: true,\n                    overlayMoreButton: true,\n                    overlayText: false,\n                    showYear: true\n                });\n                break;\n\n            case 'MusicVideo':\n                loadItems(element, item, type, {\n                    MediaTypes: '',\n                    IncludeItemTypes: 'MusicVideo',\n                    PersonTypes: '',\n                    ArtistIds: '',\n                    AlbumArtistIds: '',\n                    Limit: 10,\n                    SortBy: 'SortName'\n                }, {\n                    shape: 'overflowPortrait',\n                    showTitle: true,\n                    centerText: true,\n                    overlayPlayButton: true\n                });\n                break;\n\n            case 'Trailer':\n                loadItems(element, item, type, {\n                    MediaTypes: '',\n                    IncludeItemTypes: 'Trailer',\n                    PersonTypes: '',\n                    ArtistIds: '',\n                    AlbumArtistIds: '',\n                    Limit: 10,\n                    SortBy: 'SortName'\n                }, {\n                    shape: 'overflowPortrait',\n                    showTitle: true,\n                    centerText: true,\n                    overlayPlayButton: true\n                });\n                break;\n\n            case 'Series':\n                loadItems(element, item, type, {\n                    MediaTypes: '',\n                    IncludeItemTypes: 'Series',\n                    PersonTypes: '',\n                    ArtistIds: '',\n                    AlbumArtistIds: '',\n                    Limit: 10,\n                    SortBy: 'SortName'\n                }, {\n                    shape: 'overflowPortrait',\n                    showTitle: true,\n                    centerText: true,\n                    overlayMoreButton: true\n                });\n                break;\n\n            case 'MusicAlbum':\n                loadItems(element, item, type, {\n                    MediaTypes: '',\n                    IncludeItemTypes: 'MusicAlbum',\n                    PersonTypes: '',\n                    ArtistIds: '',\n                    AlbumArtistIds: '',\n                    SortOrder: 'Descending',\n                    SortBy: 'ProductionYear,Sortname'\n                }, {\n                    shape: 'overflowSquare',\n                    playFromHere: true,\n                    showTitle: true,\n                    showYear: true,\n                    coverImage: true,\n                    centerText: true,\n                    overlayPlayButton: true\n                });\n                break;\n\n            case 'MusicArtist':\n                loadItems(element, item, type, {\n                    MediaTypes: '',\n                    IncludeItemTypes: 'MusicArtist',\n                    PersonTypes: '',\n                    ArtistIds: '',\n                    AlbumArtistIds: '',\n                    Limit: 8,\n                    SortBy: 'SortName'\n                }, {\n                    shape: 'overflowSquare',\n                    playFromHere: true,\n                    showTitle: true,\n                    showParentTitle: true,\n                    coverImage: true,\n                    centerText: true,\n                    overlayPlayButton: true\n                });\n                break;\n\n            case 'Episode':\n                loadItems(element, item, type, {\n                    MediaTypes: '',\n                    IncludeItemTypes: 'Episode',\n                    PersonTypes: '',\n                    ArtistIds: '',\n                    AlbumArtistIds: '',\n                    Limit: 6,\n                    SortBy: 'SortName'\n                }, {\n                    shape: 'overflowBackdrop',\n                    showTitle: true,\n                    showParentTitle: true,\n                    centerText: true,\n                    overlayPlayButton: true\n                });\n                break;\n\n            case 'Audio':\n                loadItems(element, item, type, {\n                    MediaTypes: '',\n                    IncludeItemTypes: 'Audio',\n                    PersonTypes: '',\n                    ArtistIds: '',\n                    AlbumArtistIds: '',\n                    SortBy: 'AlbumArtist,Album,SortName'\n                }, {\n                    playFromHere: true,\n                    action: 'playallfromhere',\n                    smallIcon: true,\n                    artist: true\n                });\n        }\n    }\n\n    function loadItems(element, item, type, query, listOptions) {\n        query = getQuery(query, item);\n        getItemsFunction(query, item)(query.StartIndex, query.Limit, query.Fields).then(function (result) {\n            var html = '';\n\n            if (query.Limit && result.TotalRecordCount > query.Limit) {\n                var link = element.querySelector('a');\n                link.classList.remove('hide');\n                link.setAttribute('href', getMoreItemsHref(item, type));\n            } else {\n                element.querySelector('a').classList.add('hide');\n            }\n\n            listOptions.items = result.Items;\n            var itemsContainer = element.querySelector('.itemsContainer');\n\n            if ('Audio' == type) {\n                html = listView.getListViewHtml(listOptions);\n                itemsContainer.classList.remove('vertical-wrap');\n                itemsContainer.classList.add('vertical-list');\n            } else {\n                html = cardBuilder.getCardsHtml(listOptions);\n                itemsContainer.classList.add('vertical-wrap');\n                itemsContainer.classList.remove('vertical-list');\n            }\n\n            itemsContainer.innerHTML = html;\n            imageLoader.lazyChildren(itemsContainer);\n        });\n    }\n\n    function getMoreItemsHref(item, type) {\n        if ('Genre' == item.Type) {\n            return 'list.html?type=' + type + '&genreId=' + item.Id + '&serverId=' + item.ServerId;\n        }\n\n        if ('MusicGenre' == item.Type) {\n            return 'list.html?type=' + type + '&musicGenreId=' + item.Id + '&serverId=' + item.ServerId;\n        }\n\n        if ('Studio' == item.Type) {\n            return 'list.html?type=' + type + '&studioId=' + item.Id + '&serverId=' + item.ServerId;\n        }\n\n        if ('MusicArtist' == item.Type) {\n            return 'list.html?type=' + type + '&artistId=' + item.Id + '&serverId=' + item.ServerId;\n        }\n\n        if ('Person' == item.Type) {\n            return 'list.html?type=' + type + '&personId=' + item.Id + '&serverId=' + item.ServerId;\n        }\n\n        return 'list.html?type=' + type + '&parentId=' + item.Id + '&serverId=' + item.ServerId;\n    }\n\n    function addCurrentItemToQuery(query, item) {\n        if (item.Type == 'Person') {\n            query.PersonIds = item.Id;\n        } else if (item.Type == 'Genre') {\n            query.Genres = item.Name;\n        } else if (item.Type == 'MusicGenre') {\n            query.Genres = item.Name;\n        } else if (item.Type == 'GameGenre') {\n            query.Genres = item.Name;\n        } else if (item.Type == 'Studio') {\n            query.StudioIds = item.Id;\n        } else if (item.Type == 'MusicArtist') {\n            query.AlbumArtistIds = item.Id;\n        }\n    }\n\n    function getQuery(options, item) {\n        var query = {\n            SortOrder: 'Ascending',\n            IncludeItemTypes: '',\n            Recursive: true,\n            Fields: 'AudioInfo,SeriesInfo,ParentId,PrimaryImageAspectRatio,BasicSyncInfo',\n            Limit: 100,\n            StartIndex: 0,\n            CollapseBoxSetItems: false\n        };\n        query = Object.assign(query, options || {});\n        addCurrentItemToQuery(query, item);\n        return query;\n    }\n\n    function getItemsFunction(options, item) {\n        var query = getQuery(options, item);\n        return function (index, limit, fields) {\n            query.StartIndex = index;\n            query.Limit = limit;\n\n            if (fields) {\n                query.Fields += ',' + fields;\n            }\n\n            var apiClient = connectionManager.getApiClient(item.ServerId);\n\n            if ('MusicArtist' === query.IncludeItemTypes) {\n                query.IncludeItemTypes = null;\n                return apiClient.getAlbumArtists(apiClient.getCurrentUserId(), query);\n            }\n\n            return apiClient.getItems(apiClient.getCurrentUserId(), query);\n        };\n    }\n\n    window.ItemsByName = {\n        renderItems: renderItems\n    };\n});\n"]}