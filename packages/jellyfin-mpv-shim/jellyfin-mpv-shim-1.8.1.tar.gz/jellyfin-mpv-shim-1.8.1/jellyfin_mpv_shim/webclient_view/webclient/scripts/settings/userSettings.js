define(["exports","appSettings","events"],(function(_exports,_appSettings,_events){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function onSaveTimeout(){this.saveTimeout=null,this.currentApiClient.updateDisplayPreferences("usersettings",this.displayPrefs,this.currentUserId,"emby")}Object.defineProperty(_exports,"__esModule",{value:!0}),_exports.getFilter=_exports.setFilter=_exports.setSubtitleAppearanceSettings=_exports.getSubtitleAppearanceSettings=_exports.saveQuerySettings=_exports.loadQuerySettings=_exports.soundEffects=_exports.libraryPageSize=_exports.screensaver=_exports.theme=_exports.skin=_exports.dashboardTheme=_exports.skipForwardLength=_exports.skipBackLength=_exports.chromecastVersion=_exports.dateTimeLocale=_exports.language=_exports.detailsBanner=_exports.enableBackdrops=_exports.enableBlurhash=_exports.enableFastFadein=_exports.enableThemeVideos=_exports.enableThemeSongs=_exports.enableNextVideoInfoOverlay=_exports.enableCinemaMode=_exports.serverConfig=_exports.get=_exports.set=_exports.importFrom=_exports.getData=_exports.setUserInfo=_exports.currentSettings=_exports.UserSettings=void 0,_appSettings=_interopRequireDefault(_appSettings),_events=_interopRequireDefault(_events);var UserSettings=function(){function UserSettings(){!function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,UserSettings)}return function _createClass(Constructor,protoProps,staticProps){return protoProps&&_defineProperties(Constructor.prototype,protoProps),staticProps&&_defineProperties(Constructor,staticProps),Constructor}(UserSettings,[{key:"setUserInfo",value:function setUserInfo(userId,apiClient){if(this.saveTimeout&&clearTimeout(this.saveTimeout),this.currentUserId=userId,this.currentApiClient=apiClient,!userId)return this.displayPrefs=null,Promise.resolve();var self=this;return apiClient.getDisplayPreferences("usersettings",userId,"emby").then((function(result){result.CustomPrefs=result.CustomPrefs||{},self.displayPrefs=result}))}},{key:"getData",value:function getData(){return this.displayPrefs}},{key:"importFrom",value:function importFrom(instance){this.displayPrefs=instance.getData()}},{key:"set",value:function set(name,value,enableOnServer){var userId=this.currentUserId,currentValue=this.get(name,enableOnServer),result=_appSettings.default.set(name,value,userId);return!1!==enableOnServer&&this.displayPrefs&&(this.displayPrefs.CustomPrefs[name]=null==value?value:value.toString(),function saveServerPreferences(instance){instance.saveTimeout&&clearTimeout(instance.saveTimeout),instance.saveTimeout=setTimeout(onSaveTimeout.bind(instance),50)}(this)),currentValue!==value&&_events.default.trigger(this,"change",[name]),result}},{key:"get",value:function get(name,enableOnServer){var userId=this.currentUserId;return!1!==enableOnServer&&this.displayPrefs?this.displayPrefs.CustomPrefs[name]:_appSettings.default.get(name,userId)}},{key:"serverConfig",value:function serverConfig(config){var apiClient=this.currentApiClient;return config?apiClient.updateUserConfiguration(this.currentUserId,config):apiClient.getUser(this.currentUserId).then((function(user){return user.Configuration}))}},{key:"enableCinemaMode",value:function enableCinemaMode(val){return void 0!==val?this.set("enableCinemaMode",val.toString(),!1):"false"!==(val=this.get("enableCinemaMode",!1))}},{key:"enableNextVideoInfoOverlay",value:function enableNextVideoInfoOverlay(val){return void 0!==val?this.set("enableNextVideoInfoOverlay",val.toString()):"false"!==(val=this.get("enableNextVideoInfoOverlay",!1))}},{key:"enableThemeSongs",value:function enableThemeSongs(val){return void 0!==val?this.set("enableThemeSongs",val.toString(),!1):"true"===(val=this.get("enableThemeSongs",!1))}},{key:"enableThemeVideos",value:function enableThemeVideos(val){return void 0!==val?this.set("enableThemeVideos",val.toString(),!1):"true"===(val=this.get("enableThemeVideos",!1))}},{key:"enableFastFadein",value:function enableFastFadein(val){return void 0!==val?this.set("fastFadein",val.toString(),!1):"false"!==(val=this.get("fastFadein",!1))}},{key:"enableBlurhash",value:function enableBlurhash(val){return void 0!==val?this.set("blurhash",val.toString(),!1):"false"!==(val=this.get("blurhash",!1))}},{key:"enableBackdrops",value:function enableBackdrops(val){return void 0!==val?this.set("enableBackdrops",val.toString(),!1):"false"!==(val=this.get("enableBackdrops",!1))}},{key:"detailsBanner",value:function detailsBanner(val){return void 0!==val?this.set("detailsBanner",val.toString(),!1):"false"!==(val=this.get("detailsBanner",!1))}},{key:"language",value:function language(val){return void 0!==val?this.set("language",val.toString(),!1):this.get("language",!1)}},{key:"dateTimeLocale",value:function dateTimeLocale(val){return void 0!==val?this.set("datetimelocale",val.toString(),!1):this.get("datetimelocale",!1)}},{key:"chromecastVersion",value:function chromecastVersion(val){return void 0!==val?this.set("chromecastVersion",val.toString()):this.get("chromecastVersion")||"stable"}},{key:"skipBackLength",value:function skipBackLength(val){return void 0!==val?this.set("skipBackLength",val.toString()):parseInt(this.get("skipBackLength")||"10000")}},{key:"skipForwardLength",value:function skipForwardLength(val){return void 0!==val?this.set("skipForwardLength",val.toString()):parseInt(this.get("skipForwardLength")||"30000")}},{key:"dashboardTheme",value:function dashboardTheme(val){return void 0!==val?this.set("dashboardTheme",val):this.get("dashboardTheme")}},{key:"skin",value:function skin(val){return void 0!==val?this.set("skin",val,!1):this.get("skin",!1)}},{key:"theme",value:function theme(val){return void 0!==val?this.set("appTheme",val,!1):this.get("appTheme",!1)}},{key:"screensaver",value:function screensaver(val){return void 0!==val?this.set("screensaver",val,!1):this.get("screensaver",!1)}},{key:"libraryPageSize",value:function libraryPageSize(val){if(void 0!==val)return this.set("libraryPageSize",parseInt(val,10),!1);var libraryPageSize=parseInt(this.get("libraryPageSize",!1),10);return 0===libraryPageSize?0:libraryPageSize||100}},{key:"soundEffects",value:function soundEffects(val){return void 0!==val?this.set("soundeffects",val,!1):this.get("soundeffects",!1)}},{key:"loadQuerySettings",value:function loadQuerySettings(key,query){var values=this.get(key);return values?(values=JSON.parse(values),Object.assign(query,values)):query}},{key:"saveQuerySettings",value:function saveQuerySettings(key,query){var values={};return query.SortBy&&(values.SortBy=query.SortBy),query.SortOrder&&(values.SortOrder=query.SortOrder),this.set(key,JSON.stringify(values))}},{key:"getSubtitleAppearanceSettings",value:function getSubtitleAppearanceSettings(key){return key=key||"localplayersubtitleappearance3",JSON.parse(this.get(key,!1)||"{}")}},{key:"setSubtitleAppearanceSettings",value:function setSubtitleAppearanceSettings(value,key){return key=key||"localplayersubtitleappearance3",this.set(key,JSON.stringify(value),!1)}},{key:"setFilter",value:function setFilter(key,value){return this.set(key,value,!0)}},{key:"getFilter",value:function getFilter(key){return this.get(key,!0)}}]),UserSettings}();_exports.UserSettings=UserSettings;var currentSettings=new UserSettings;_exports.currentSettings=currentSettings;var setUserInfo=currentSettings.setUserInfo.bind(currentSettings);_exports.setUserInfo=setUserInfo;var getData=currentSettings.getData.bind(currentSettings);_exports.getData=getData;var importFrom=currentSettings.importFrom.bind(currentSettings);_exports.importFrom=importFrom;var set=currentSettings.set.bind(currentSettings);_exports.set=set;var get=currentSettings.get.bind(currentSettings);_exports.get=get;var serverConfig=currentSettings.serverConfig.bind(currentSettings);_exports.serverConfig=serverConfig;var enableCinemaMode=currentSettings.enableCinemaMode.bind(currentSettings);_exports.enableCinemaMode=enableCinemaMode;var enableNextVideoInfoOverlay=currentSettings.enableNextVideoInfoOverlay.bind(currentSettings);_exports.enableNextVideoInfoOverlay=enableNextVideoInfoOverlay;var enableThemeSongs=currentSettings.enableThemeSongs.bind(currentSettings);_exports.enableThemeSongs=enableThemeSongs;var enableThemeVideos=currentSettings.enableThemeVideos.bind(currentSettings);_exports.enableThemeVideos=enableThemeVideos;var enableFastFadein=currentSettings.enableFastFadein.bind(currentSettings);_exports.enableFastFadein=enableFastFadein;var enableBlurhash=currentSettings.enableBlurhash.bind(currentSettings);_exports.enableBlurhash=enableBlurhash;var enableBackdrops=currentSettings.enableBackdrops.bind(currentSettings);_exports.enableBackdrops=enableBackdrops;var detailsBanner=currentSettings.detailsBanner.bind(currentSettings);_exports.detailsBanner=detailsBanner;var language=currentSettings.language.bind(currentSettings);_exports.language=language;var dateTimeLocale=currentSettings.dateTimeLocale.bind(currentSettings);_exports.dateTimeLocale=dateTimeLocale;var chromecastVersion=currentSettings.chromecastVersion.bind(currentSettings);_exports.chromecastVersion=chromecastVersion;var skipBackLength=currentSettings.skipBackLength.bind(currentSettings);_exports.skipBackLength=skipBackLength;var skipForwardLength=currentSettings.skipForwardLength.bind(currentSettings);_exports.skipForwardLength=skipForwardLength;var dashboardTheme=currentSettings.dashboardTheme.bind(currentSettings);_exports.dashboardTheme=dashboardTheme;var skin=currentSettings.skin.bind(currentSettings);_exports.skin=skin;var theme=currentSettings.theme.bind(currentSettings);_exports.theme=theme;var screensaver=currentSettings.screensaver.bind(currentSettings);_exports.screensaver=screensaver;var libraryPageSize=currentSettings.libraryPageSize.bind(currentSettings);_exports.libraryPageSize=libraryPageSize;var soundEffects=currentSettings.soundEffects.bind(currentSettings);_exports.soundEffects=soundEffects;var loadQuerySettings=currentSettings.loadQuerySettings.bind(currentSettings);_exports.loadQuerySettings=loadQuerySettings;var saveQuerySettings=currentSettings.saveQuerySettings.bind(currentSettings);_exports.saveQuerySettings=saveQuerySettings;var getSubtitleAppearanceSettings=currentSettings.getSubtitleAppearanceSettings.bind(currentSettings);_exports.getSubtitleAppearanceSettings=getSubtitleAppearanceSettings;var setSubtitleAppearanceSettings=currentSettings.setSubtitleAppearanceSettings.bind(currentSettings);_exports.setSubtitleAppearanceSettings=setSubtitleAppearanceSettings;var setFilter=currentSettings.setFilter.bind(currentSettings);_exports.setFilter=setFilter;var getFilter=currentSettings.getFilter.bind(currentSettings);_exports.getFilter=getFilter}));
//# sourceMappingURL=userSettings.js.map
