define(["exports","dialogHelper"],(function(_exports,_dialogHelper){"use strict";function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}Object.defineProperty(_exports,"__esModule",{value:!0}),_exports.default=void 0,_dialogHelper=function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}(_dialogHelper);var TableOfContents=function(){function TableOfContents(bookPlayer){!function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,TableOfContents),this._bookPlayer=bookPlayer,this._rendition=bookPlayer._rendition,this.onDialogClosed=this.onDialogClosed.bind(this),this.createMediaElement()}return function _createClass(Constructor,protoProps,staticProps){return protoProps&&_defineProperties(Constructor.prototype,protoProps),staticProps&&_defineProperties(Constructor,staticProps),Constructor}(TableOfContents,[{key:"destroy",value:function destroy(){var elem=this._elem;elem&&(this.unbindEvents(),_dialogHelper.default.close(elem)),this._bookPlayer._tocElement=null}},{key:"bindEvents",value:function bindEvents(){var elem=this._elem;elem.addEventListener("close",this.onDialogClosed,{once:!0}),elem.querySelector(".btnBookplayerTocClose").addEventListener("click",this.onDialogClosed,{once:!0})}},{key:"unbindEvents",value:function unbindEvents(){var elem=this._elem;elem.removeEventListener("close",this.onDialogClosed),elem.querySelector(".btnBookplayerTocClose").removeEventListener("click",this.onDialogClosed)}},{key:"onDialogClosed",value:function onDialogClosed(){this.destroy()}},{key:"replaceLinks",value:function replaceLinks(contents,f){contents.querySelectorAll("a[href]").forEach((function(link){var href=link.getAttribute("href");link.onclick=function(){return f(href),!1}}))}},{key:"createMediaElement",value:function createMediaElement(){var _this=this,rendition=this._rendition,elem=_dialogHelper.default.createDialog({size:"small",autoFocus:!1,removeOnClose:!0});elem.id="dialogToc";var tocHtml='<div class="topRightActionButtons">';tocHtml+='<button is="paper-icon-button-light" class="autoSize bookplayerButton btnBookplayerTocClose hide-mouse-idle-tv" tabindex="-1"><span class="material-icons bookplayerButtonIcon close"></span></button>',tocHtml+="</div>",tocHtml+='<ul class="toc">',rendition.book.navigation.forEach((function(chapter){tocHtml+="<li>";var link=chapter.href.startsWith("../")?chapter.href.substr(3):chapter.href;tocHtml+='<a href="'.concat(rendition.book.path.directory+link,'">').concat(chapter.label,"</a>"),tocHtml+="</li>"})),tocHtml+="</ul>",elem.innerHTML=tocHtml,this.replaceLinks(elem,(function(href){var relative=rendition.book.path.relative(href);rendition.display(relative),_this.destroy()})),this._elem=elem,this.bindEvents(),_dialogHelper.default.open(elem)}}]),TableOfContents}();_exports.default=TableOfContents}));
//# sourceMappingURL=tableOfContents.js.map
