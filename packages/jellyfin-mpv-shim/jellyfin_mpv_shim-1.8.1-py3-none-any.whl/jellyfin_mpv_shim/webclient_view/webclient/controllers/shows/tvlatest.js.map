{"version":3,"sources":["controllers/shows/tvlatest.js"],"names":["define","loading","groupedcards","cardBuilder","appHost","imageLoader","view","params","tabContent","latestPromise","this","preRender","getLatestPromise","context","show","userId","ApiClient","getCurrentUserId","options","IncludeItemTypes","Limit","Fields","ParentId","topParentId","ImageTypeLimit","EnableImageTypes","getJSON","getUrl","renderTab","loadLatest","promise","then","items","html","supports","getCardsHtml","shape","preferThumb","showTitle","showSeriesYear","showParentTitle","overlayText","cardLayout","showUnplayedIndicator","showChildCountIndicator","centerText","lazy","overlayPlayButton","lines","elem","querySelector","innerHTML","lazyChildren","hide","require","autoFocuser","autoFocus","addEventListener","onItemsContainerClick"],"mappings":"AAAA,aAAAA,OAAO,CAAC,UAAW,0BAA2B,cAAe,UAAW,gBAAgB,SAAUC,QAASC,aAAcC,YAAaC,QAASC,aAiD3I,OAAO,SAAUC,KAAMC,OAAQC,YAC3B,IACIC,cADOC,KAGNC,UAAY,WACbF,cAnDR,SAASG,iBAAiBC,QAASN,QAC/BN,QAAQa,OACR,IAAIC,OAASC,UAAUC,mBAEnBC,QAAU,CACVC,iBAAkB,UAClBC,MAAO,GACPC,OAAQ,wCACRC,SALWf,OAAOgB,YAMlBC,eAAgB,EAChBC,iBAAkB,0BAEtB,OAAOT,UAAUU,QAAQV,UAAUW,OAAO,SAAWZ,OAAS,gBAAiBG,UAuC3DN,CAAiBN,EAAMC,SAJhCG,KAONkB,UAAY,YAvCrB,SAASC,WAAWhB,QAASN,OAAQuB,SACjCA,QAAQC,MAAK,SAAUC,OACnB,IAAIC,KAAO,GACX7B,QAAQ8B,SAAS,iBACjBD,MAAQ9B,YAAYgC,aAAa,CAC7BH,MAAOA,MACPI,MAAO,WACPC,aAAa,EACbC,WAAW,EACXC,gBAAgB,EAChBC,iBAAiB,EACjBC,aAAa,EACbC,YAAY,EACZC,uBAAuB,EACvBC,yBAAyB,EACzBC,YAAY,EACZC,MAAM,EACNC,mBAAmB,EACnBC,MAAO,IAEX,IAAIC,KAAOpC,QAAQqC,cAAc,mBACjCD,KAAKE,UAAYlB,KACjB5B,YAAY+C,aAAaH,MACzBhD,QAAQoD,OAERC,QAAQ,CAAC,gBAAgB,SAAUC,aAC/BA,YAAYC,UAAU3C,eAc1BgB,CAAWrB,WAAYD,EAAQE,gBAGnCD,WAAW0C,cAAc,mBAAmBO,iBAAiB,QAASvD,aAAawD","file":"tvlatest.js","sourcesContent":["define(['loading', 'components/groupedcards', 'cardBuilder', 'apphost', 'imageLoader'], function (loading, groupedcards, cardBuilder, appHost, imageLoader) {\n    'use strict';\n\n    function getLatestPromise(context, params) {\n        loading.show();\n        var userId = ApiClient.getCurrentUserId();\n        var parentId = params.topParentId;\n        var options = {\n            IncludeItemTypes: 'Episode',\n            Limit: 30,\n            Fields: 'PrimaryImageAspectRatio,BasicSyncInfo',\n            ParentId: parentId,\n            ImageTypeLimit: 1,\n            EnableImageTypes: 'Primary,Backdrop,Thumb'\n        };\n        return ApiClient.getJSON(ApiClient.getUrl('Users/' + userId + '/Items/Latest', options));\n    }\n\n    function loadLatest(context, params, promise) {\n        promise.then(function (items) {\n            var html = '';\n            appHost.supports('imageanalysis');\n            html += cardBuilder.getCardsHtml({\n                items: items,\n                shape: 'backdrop',\n                preferThumb: true,\n                showTitle: true,\n                showSeriesYear: true,\n                showParentTitle: true,\n                overlayText: false,\n                cardLayout: false,\n                showUnplayedIndicator: false,\n                showChildCountIndicator: true,\n                centerText: true,\n                lazy: true,\n                overlayPlayButton: true,\n                lines: 2\n            });\n            var elem = context.querySelector('#latestEpisodes');\n            elem.innerHTML = html;\n            imageLoader.lazyChildren(elem);\n            loading.hide();\n\n            require(['autoFocuser'], function (autoFocuser) {\n                autoFocuser.autoFocus(context);\n            });\n        });\n    }\n\n    return function (view, params, tabContent) {\n        var self = this;\n        var latestPromise;\n\n        self.preRender = function () {\n            latestPromise = getLatestPromise(view, params);\n        };\n\n        self.renderTab = function () {\n            loadLatest(tabContent, params, latestPromise);\n        };\n\n        tabContent.querySelector('#latestEpisodes').addEventListener('click', groupedcards.onItemsContainerClick);\n    };\n});\n"]}