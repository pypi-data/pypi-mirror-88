define(["exports","datetime","imageLoader","connectionManager","layoutManager","browser"],(function(_exports,_datetime,_imageLoader,_connectionManager,_layoutManager,_browser){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}Object.defineProperty(_exports,"__esModule",{value:!0}),_exports.buildChapterCards=buildChapterCards,_exports.default=void 0,_datetime=_interopRequireDefault(_datetime),_imageLoader=_interopRequireDefault(_imageLoader),_connectionManager=_interopRequireDefault(_connectionManager),_layoutManager=_interopRequireDefault(_layoutManager);var enableFocusTransform=!(_browser=_interopRequireDefault(_browser)).default.slow&&!_browser.default.edge;function buildChapterCard(item,apiClient,chapter,index,_ref4,className,shape){var width=_ref4.width,coverImage=_ref4.coverImage,imgUrl=function getImgUrl(_ref2,_ref3,index,maxWidth,apiClient){var Id=_ref2.Id,ImageTag=_ref3.ImageTag;return ImageTag?apiClient.getScaledImageUrl(Id,{maxWidth:2*maxWidth,tag:ImageTag,type:"Chapter",index:index}):null}(item,chapter,index,width||400,apiClient),cardImageContainerClass="cardContent cardContent-shadow cardImageContainer chapterCardImageContainer";coverImage&&(cardImageContainerClass+=" coveredImage");var dataAttributes=' data-action="play" data-isfolder="'.concat(item.IsFolder,'" data-id="').concat(item.Id,'" data-serverid="').concat(item.ServerId,'" data-type="').concat(item.Type,'" data-mediatype="').concat(item.MediaType,'" data-positionticks="').concat(chapter.StartPositionTicks,'"'),cardImageContainer=imgUrl?'<div class="'.concat(cardImageContainerClass,' lazy" data-src="').concat(imgUrl,'">'):'<div class="'.concat(cardImageContainerClass,'">');imgUrl||(cardImageContainer+='<span class="material-icons cardImageIcon local_movies"></span>');var nameHtml="";nameHtml+='<div class="cardText">'.concat(chapter.Name,"</div>"),nameHtml+='<div class="cardText">'.concat(_datetime.default.getDisplayRunningTime(chapter.StartPositionTicks),"</div>");return'<button type="button" class="'.concat(className,'"').concat(dataAttributes,'><div class="').concat("cardBox",'"><div class="').concat("cardScalable",'"><div class="cardPadder-').concat(shape,'"></div>').concat(cardImageContainer,'</div><div class="innerCardFooter">').concat(nameHtml,"</div></div></div></button>")}function buildChapterCards(item,chapters,options){if(options.parentContainer){if(!document.body.contains(options.parentContainer))return;if(!chapters.length)return void options.parentContainer.classList.add("hide");options.parentContainer.classList.remove("hide")}var html=function buildChapterCardsHtml(item,chapters,options){var className="card itemAction chapterCard";_layoutManager.default.tv&&(className+=" show-focus",enableFocusTransform&&(className+=" show-animation"));var videoStream=(((item.MediaSources||[])[0]||{}).MediaStreams||[]).filter((function(_ref){return"Video"===_ref.Type}))[0]||{},shape=options.backdropShape||"backdrop";videoStream.Width&&videoStream.Height&&videoStream.Width/videoStream.Height<=1.2&&(shape=options.squareShape||"square"),className+=" ".concat(shape,"Card"),(options.block||options.rows)&&(className+=" block");for(var html="",itemsInRow=0,apiClient=_connectionManager.default.getApiClient(item.ServerId),i=0,length=chapters.length;i<length;i++){options.rows&&0===itemsInRow&&(html+='<div class="cardColumn">'),html+=buildChapterCard(item,apiClient,chapters[i],i,options,className,shape),itemsInRow++,options.rows&&itemsInRow>=options.rows&&(itemsInRow=0,html+="</div>")}return html}(item,chapters,options);options.itemsContainer.innerHTML=html,_imageLoader.default.lazyChildren(options.itemsContainer)}var _default={buildChapterCards:buildChapterCards};_exports.default=_default}));
//# sourceMappingURL=chaptercardbuilder.js.map
