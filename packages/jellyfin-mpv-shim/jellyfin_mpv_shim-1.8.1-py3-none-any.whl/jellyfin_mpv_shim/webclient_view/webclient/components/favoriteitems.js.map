{"version":3,"sources":["components/favoriteitems.js"],"names":["define","loading","libraryBrowser","cardBuilder","dom","appHost","imageLoader","globalize","layoutManager","enableScrollX","desktop","getThumbShape","getPosterShape","getSquareShape","loadSection","elem","userId","topParentId","section","isSingleSection","promise","screenWidth","getWindowSize","innerWidth","options","SortBy","SortOrder","Filters","Recursive","Fields","CollapseBoxSetItems","ExcludeLocationTypes","EnableTotalRecordCount","ParentId","Limit","types","ApiClient","getArtists","IncludeItemTypes","getItems","then","result","html","Items","length","tv","serverId","translate","name","scrollXClass","supportsImageAnalysis","supports","preferVisualCards","autoCardLayout","showTitle","getCardsHtml","preferThumb","shape","centerText","overlayText","showParentTitle","scalable","coverImage","overlayPlayButton","overlayMoreButton","action","allowBottomPadding","cardLayout","innerHTML","lazyChildren","render","loadSections","page","show","i","sections","getSections","id","sectionid","getParameterByName","filter","s","indexOf","querySelector","promises","push","Promise","all","hide"],"mappings":"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","file":"favoriteitems.js","sourcesContent":["define(['loading', 'libraryBrowser', 'cardBuilder', 'dom', 'apphost', 'imageLoader', 'globalize', 'layoutManager', 'scrollStyles', 'emby-itemscontainer'], function (loading, libraryBrowser, cardBuilder, dom, appHost, imageLoader, globalize, layoutManager) {\n    'use strict';\n\n    function enableScrollX() {\n        return !layoutManager.desktop;\n    }\n\n    function getThumbShape() {\n        return enableScrollX() ? 'overflowBackdrop' : 'backdrop';\n    }\n\n    function getPosterShape() {\n        return enableScrollX() ? 'overflowPortrait' : 'portrait';\n    }\n\n    function getSquareShape() {\n        return enableScrollX() ? 'overflowSquare' : 'square';\n    }\n\n    function getSections() {\n        return [{\n            name: 'HeaderFavoriteMovies',\n            types: 'Movie',\n            id: 'favoriteMovies',\n            shape: getPosterShape(),\n            showTitle: false,\n            overlayPlayButton: true\n        }, {\n            name: 'HeaderFavoriteShows',\n            types: 'Series',\n            id: 'favoriteShows',\n            shape: getPosterShape(),\n            showTitle: false,\n            overlayPlayButton: true\n        }, {\n            name: 'HeaderFavoriteEpisodes',\n            types: 'Episode',\n            id: 'favoriteEpisode',\n            shape: getThumbShape(),\n            preferThumb: false,\n            showTitle: true,\n            showParentTitle: true,\n            overlayPlayButton: true,\n            overlayText: false,\n            centerText: true\n        }, {\n            name: 'HeaderFavoriteVideos',\n            types: 'Video,MusicVideo',\n            id: 'favoriteVideos',\n            shape: getThumbShape(),\n            preferThumb: true,\n            showTitle: true,\n            overlayPlayButton: true,\n            overlayText: false,\n            centerText: true\n        }, {\n            name: 'HeaderFavoriteArtists',\n            types: 'MusicArtist',\n            id: 'favoriteArtists',\n            shape: getSquareShape(),\n            preferThumb: false,\n            showTitle: true,\n            overlayText: false,\n            showParentTitle: false,\n            centerText: true,\n            overlayPlayButton: true,\n            coverImage: true\n        }, {\n            name: 'HeaderFavoriteAlbums',\n            types: 'MusicAlbum',\n            id: 'favoriteAlbums',\n            shape: getSquareShape(),\n            preferThumb: false,\n            showTitle: true,\n            overlayText: false,\n            showParentTitle: true,\n            centerText: true,\n            overlayPlayButton: true,\n            coverImage: true\n        }, {\n            name: 'HeaderFavoriteSongs',\n            types: 'Audio',\n            id: 'favoriteSongs',\n            shape: getSquareShape(),\n            preferThumb: false,\n            showTitle: true,\n            overlayText: false,\n            showParentTitle: true,\n            centerText: true,\n            overlayMoreButton: true,\n            action: 'instantmix',\n            coverImage: true\n        }];\n    }\n\n    function loadSection(elem, userId, topParentId, section, isSingleSection) {\n        var screenWidth = dom.getWindowSize().innerWidth;\n        var options = {\n            SortBy: 'SortName',\n            SortOrder: 'Ascending',\n            Filters: 'IsFavorite',\n            Recursive: true,\n            Fields: 'PrimaryImageAspectRatio,BasicSyncInfo',\n            CollapseBoxSetItems: false,\n            ExcludeLocationTypes: 'Virtual',\n            EnableTotalRecordCount: false\n        };\n\n        if (topParentId) {\n            options.ParentId = topParentId;\n        }\n\n        if (!isSingleSection) {\n            options.Limit = screenWidth >= 1920 ? 10 : screenWidth >= 1440 ? 8 : 6;\n\n            if (enableScrollX()) {\n                options.Limit = 20;\n            }\n        }\n\n        var promise;\n\n        if ('MusicArtist' === section.types) {\n            promise = ApiClient.getArtists(userId, options);\n        } else {\n            options.IncludeItemTypes = section.types;\n            promise = ApiClient.getItems(userId, options);\n        }\n\n        return promise.then(function (result) {\n            var html = '';\n\n            if (result.Items.length) {\n                if (html += '<div class=\"sectionTitleContainer sectionTitleContainer-cards padded-left\">', !layoutManager.tv && options.Limit && result.Items.length >= options.Limit) {\n                    html += '<a is=\"emby-linkbutton\" href=\"' + ('list.html?serverId=' + ApiClient.serverId() + '&type=' + section.types + '&IsFavorite=true') + '\" class=\"more button-flat button-flat-mini sectionTitleTextButton\">';\n                    html += '<h2 class=\"sectionTitle sectionTitle-cards\">';\n                    html += globalize.translate(section.name);\n                    html += '</h2>';\n                    html += '<span class=\"material-icons chevron_right\"></span>';\n                    html += '</a>';\n                } else {\n                    html += '<h2 class=\"sectionTitle sectionTitle-cards\">' + globalize.translate(section.name) + '</h2>';\n                }\n\n                html += '</div>';\n                if (enableScrollX()) {\n                    var scrollXClass = 'scrollX hiddenScrollX';\n                    if (layoutManager.tv) {\n                        scrollXClass += ' smoothScrollX';\n                    }\n\n                    html += '<div is=\"emby-itemscontainer\" class=\"itemsContainer ' + scrollXClass + ' padded-left padded-right\">';\n                } else {\n                    html += '<div is=\"emby-itemscontainer\" class=\"itemsContainer vertical-wrap padded-left padded-right\">';\n                }\n\n                var supportsImageAnalysis = appHost.supports('imageanalysis');\n                var cardLayout = (appHost.preferVisualCards || supportsImageAnalysis) && section.autoCardLayout && section.showTitle;\n                cardLayout = false;\n                html += cardBuilder.getCardsHtml(result.Items, {\n                    preferThumb: section.preferThumb,\n                    shape: section.shape,\n                    centerText: section.centerText && !cardLayout,\n                    overlayText: false !== section.overlayText,\n                    showTitle: section.showTitle,\n                    showParentTitle: section.showParentTitle,\n                    scalable: true,\n                    coverImage: section.coverImage,\n                    overlayPlayButton: section.overlayPlayButton,\n                    overlayMoreButton: section.overlayMoreButton && !cardLayout,\n                    action: section.action,\n                    allowBottomPadding: !enableScrollX(),\n                    cardLayout: cardLayout\n                });\n                html += '</div>';\n            }\n\n            elem.innerHTML = html;\n            imageLoader.lazyChildren(elem);\n        });\n    }\n\n    function loadSections(page, userId, topParentId, types) {\n        loading.show();\n        var sections = getSections();\n        var sectionid = getParameterByName('sectionid');\n\n        if (sectionid) {\n            sections = sections.filter(function (s) {\n                return s.id === sectionid;\n            });\n        }\n\n        if (types) {\n            sections = sections.filter(function (s) {\n                return -1 !== types.indexOf(s.id);\n            });\n        }\n\n        var i;\n        var length;\n        var elem = page.querySelector('.favoriteSections');\n\n        if (!elem.innerHTML) {\n            var html = '';\n\n            for (i = 0, length = sections.length; i < length; i++) {\n                html += '<div class=\"verticalSection section' + sections[i].id + '\"></div>';\n            }\n\n            elem.innerHTML = html;\n        }\n\n        var promises = [];\n\n        for (i = 0, length = sections.length; i < length; i++) {\n            var section = sections[i];\n            elem = page.querySelector('.section' + section.id);\n            promises.push(loadSection(elem, userId, topParentId, section, 1 === sections.length));\n        }\n\n        Promise.all(promises).then(function () {\n            loading.hide();\n        });\n    }\n\n    return {\n        render: loadSections\n    };\n});\n"]}