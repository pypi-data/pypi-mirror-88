{"version":3,"sources":["components/itemHelper.js"],"names":["define","appHost","globalize","canEdit","user","item","itemType","Type","Status","isLocalItem","Policy","IsAdministrator","Id","indexOf","getDisplayName","options","arguments","length","undefined","Error","ProgramInfo","name","IsSeries","EpisodeTitle","Name","ChannelNumber","ParentIndexNumber","translate","IndexNumber","includeIndexNumber","displayIndexNumber","number","nameSeparator","includeParentInfo","IndexNumberEnd","supportsAddingToCollection","CollectionType","MediaType","supportsAddingToPlaylist","IsFolder","canIdentify","canEditImages","canSync","EnableContentDownloading","SupportsSync","canShare","EnablePublicSharing","supports","enableDateAddedDisplay","canMarkPlayed","canRate","UserData","canConvert","EnableMediaConversion","mediaType","type","LocationType","IsPlaceHolder","canRefreshMetadata","supportsMediaSourceSelection","MediaSources","EnableMediaSourceDisplay","SourceType"],"mappings":"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","file":"itemHelper.js","sourcesContent":["define(['apphost', 'globalize'], function (appHost, globalize) {\n    'use strict';\n\n    function getDisplayName(item, options = {}) {\n\n        if (!item) {\n            throw new Error('null item passed into getDisplayName');\n        }\n\n        if (item.Type === 'Timer') {\n            item = item.ProgramInfo || item;\n        }\n\n        var name = ((item.Type === 'Program' || item.Type === 'Recording') && (item.IsSeries || item.EpisodeTitle) ? item.EpisodeTitle : item.Name) || '';\n\n        if (item.Type === 'TvChannel') {\n            if (item.ChannelNumber) {\n                return item.ChannelNumber + ' ' + name;\n            }\n            return name;\n        }\n        if (item.Type === 'Episode' && item.ParentIndexNumber === 0) {\n            name = globalize.translate('ValueSpecialEpisodeName', name);\n        } else if ((item.Type === 'Episode' || item.Type === 'Program') && item.IndexNumber != null && item.ParentIndexNumber != null && options.includeIndexNumber !== false) {\n\n            var displayIndexNumber = item.IndexNumber;\n\n            var number = displayIndexNumber;\n            var nameSeparator = ' - ';\n\n            if (options.includeParentInfo !== false) {\n                number = 'S' + item.ParentIndexNumber + ':E' + number;\n            } else {\n                nameSeparator = '. ';\n            }\n\n            if (item.IndexNumberEnd) {\n\n                displayIndexNumber = item.IndexNumberEnd;\n                number += '-' + displayIndexNumber;\n            }\n\n            if (number) {\n                name = name ? (number + nameSeparator + name) : number;\n            }\n        }\n\n        return name;\n    }\n\n    function supportsAddingToCollection(item) {\n\n        var invalidTypes = ['Genre', 'MusicGenre', 'Studio', 'UserView', 'CollectionFolder', 'Audio', 'Program', 'Timer', 'SeriesTimer'];\n\n        if (item.Type === 'Recording') {\n            if (item.Status !== 'Completed') {\n                return false;\n            }\n        }\n\n        return !item.CollectionType && invalidTypes.indexOf(item.Type) === -1 && item.MediaType !== 'Photo' && !isLocalItem(item);\n    }\n\n    function supportsAddingToPlaylist(item) {\n\n        if (item.Type === 'Program') {\n            return false;\n        }\n        if (item.Type === 'TvChannel') {\n            return false;\n        }\n        if (item.Type === 'Timer') {\n            return false;\n        }\n        if (item.Type === 'SeriesTimer') {\n            return false;\n        }\n        if (item.MediaType === 'Photo') {\n            return false;\n        }\n\n        if (item.Type === 'Recording') {\n            if (item.Status !== 'Completed') {\n                return false;\n            }\n        }\n\n        if (isLocalItem(item)) {\n            return false;\n        }\n        if (item.CollectionType === 'livetv') {\n            return false;\n        }\n\n        return item.MediaType || item.IsFolder || item.Type === 'Genre' || item.Type === 'MusicGenre' || item.Type === 'MusicArtist';\n    }\n\n    function canEdit(user, item) {\n\n        var itemType = item.Type;\n\n        if (itemType === 'UserRootFolder' || itemType === 'UserView') {\n            return false;\n        }\n\n        if (itemType === 'Program') {\n            return false;\n        }\n\n        if (itemType === 'Timer') {\n            return false;\n        }\n\n        if (itemType === 'SeriesTimer') {\n            return false;\n        }\n\n        if (item.Type === 'Recording') {\n            if (item.Status !== 'Completed') {\n                return false;\n            }\n        }\n\n        if (isLocalItem(item)) {\n            return false;\n        }\n\n        return user.Policy.IsAdministrator;\n    }\n\n    function isLocalItem(item) {\n\n        if (item && item.Id && item.Id.indexOf('local') === 0) {\n            return true;\n        }\n\n        return false;\n    }\n\n    return {\n        getDisplayName: getDisplayName,\n        supportsAddingToCollection: supportsAddingToCollection,\n        supportsAddingToPlaylist: supportsAddingToPlaylist,\n        isLocalItem: isLocalItem,\n\n        canIdentify: function (user, item) {\n\n            var itemType = item.Type;\n\n            if (itemType === 'Movie' ||\n                itemType === 'Trailer' ||\n                itemType === 'Series' ||\n                itemType === 'BoxSet' ||\n                itemType === 'Person' ||\n                itemType === 'Book' ||\n                itemType === 'MusicAlbum' ||\n                itemType === 'MusicArtist' ||\n                itemType === 'MusicVideo') {\n\n                if (user.Policy.IsAdministrator) {\n\n                    if (!isLocalItem(item)) {\n                        return true;\n                    }\n                }\n            }\n\n            return false;\n        },\n\n        canEdit: canEdit,\n\n        canEditImages: function (user, item) {\n\n            var itemType = item.Type;\n\n            if (item.MediaType === 'Photo') {\n                return false;\n            }\n\n            if (itemType === 'UserView') {\n                if (user.Policy.IsAdministrator) {\n\n                    return true;\n                }\n\n                return false;\n            }\n\n            if (item.Type === 'Recording') {\n                if (item.Status !== 'Completed') {\n                    return false;\n                }\n            }\n\n            return itemType !== 'Timer' && itemType !== 'SeriesTimer' && canEdit(user, item) && !isLocalItem(item);\n        },\n\n        canSync: function (user, item) {\n\n            if (user && !user.Policy.EnableContentDownloading) {\n                return false;\n            }\n\n            if (isLocalItem(item)) {\n                return false;\n            }\n\n            return item.SupportsSync;\n        },\n\n        canShare: function (item, user) {\n\n            if (item.Type === 'Program') {\n                return false;\n            }\n            if (item.Type === 'TvChannel') {\n                return false;\n            }\n            if (item.Type === 'Timer') {\n                return false;\n            }\n            if (item.Type === 'SeriesTimer') {\n                return false;\n            }\n            if (item.Type === 'Recording') {\n                if (item.Status !== 'Completed') {\n                    return false;\n                }\n            }\n            if (isLocalItem(item)) {\n                return false;\n            }\n            return user.Policy.EnablePublicSharing && appHost.supports('sharing');\n        },\n\n        enableDateAddedDisplay: function (item) {\n            return !item.IsFolder && item.MediaType && item.Type !== 'Program' && item.Type !== 'TvChannel' && item.Type !== 'Trailer';\n        },\n\n        canMarkPlayed: function (item) {\n\n            if (item.Type === 'Program') {\n                return false;\n            }\n\n            if (item.MediaType === 'Video') {\n                if (item.Type !== 'TvChannel') {\n                    return true;\n                }\n            } else if (item.MediaType === 'Audio') {\n                if (item.Type === 'AudioPodcast') {\n                    return true;\n                }\n                if (item.Type === 'AudioBook') {\n                    return true;\n                }\n            }\n\n            if (item.Type === 'Series' ||\n                item.Type === 'Season' ||\n                item.Type === 'BoxSet' ||\n                item.MediaType === 'Book' ||\n                item.MediaType === 'Recording') {\n                return true;\n            }\n\n            return false;\n        },\n\n        canRate: function (item) {\n\n            if (item.Type === 'Program'\n                || item.Type === 'Timer'\n                || item.Type === 'SeriesTimer'\n                || item.Type === 'CollectionFolder'\n                || item.Type === 'UserView'\n                || item.Type === 'Channel'\n                || !item.UserData) {\n                return false;\n            }\n\n            return true;\n        },\n\n        canConvert: function (item, user) {\n\n            if (!user.Policy.EnableMediaConversion) {\n                return false;\n            }\n\n            if (isLocalItem(item)) {\n                return false;\n            }\n\n            var mediaType = item.MediaType;\n            if (mediaType === 'Book' || mediaType === 'Photo' || mediaType === 'Audio') {\n                return false;\n            }\n\n            var collectionType = item.CollectionType;\n            if (collectionType === 'livetv') {\n                return false;\n            }\n\n            var type = item.Type;\n            if (type === 'Channel' || type === 'Person' || type === 'Year' || type === 'Program' || type === 'Timer' || type === 'SeriesTimer') {\n                return false;\n            }\n\n            if (item.LocationType === 'Virtual' && !item.IsFolder) {\n                return false;\n            }\n\n            if (item.IsPlaceHolder) {\n                return false;\n            }\n\n            return true;\n        },\n\n        canRefreshMetadata: function (item, user) {\n\n            if (user.Policy.IsAdministrator) {\n\n                var collectionType = item.CollectionType;\n                if (collectionType === 'livetv') {\n                    return false;\n                }\n\n                if (item.Type !== 'Timer' && item.Type !== 'SeriesTimer' && item.Type !== 'Program' && item.Type !== 'TvChannel' && !(item.Type === 'Recording' && item.Status !== 'Completed')) {\n\n                    if (!isLocalItem(item)) {\n                        return true;\n                    }\n                }\n            }\n\n            return false;\n        },\n\n        supportsMediaSourceSelection: function (item) {\n\n            if (item.MediaType !== 'Video') {\n                return false;\n            }\n            if (item.Type === 'TvChannel') {\n                return false;\n            }\n            if (!item.MediaSources || (item.MediaSources.length === 1 && item.MediaSources[0].Type === 'Placeholder')) {\n                return false;\n            }\n            if (item.EnableMediaSourceDisplay === false) {\n                return false;\n            }\n            if (item.EnableMediaSourceDisplay == null && item.SourceType && item.SourceType !== 'Library') {\n                return false;\n            }\n\n            return true;\n        }\n    };\n});\n"]}