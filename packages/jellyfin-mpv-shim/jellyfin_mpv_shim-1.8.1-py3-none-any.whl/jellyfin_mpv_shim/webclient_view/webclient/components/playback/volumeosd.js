define(["events","playbackManager","dom","browser","css!./iconosd","material-icons"],(function(_events,_playbackManager,_dom,_browser,_iconosd,_materialIcons){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var currentPlayer,osdElement,iconElement,progressElement,enableAnimation,hideTimeout;function onHideComplete(){this.classList.add("hide")}function clearHideTimeout(){hideTimeout&&(clearTimeout(hideTimeout),hideTimeout=null)}function hideOsd(){clearHideTimeout();var elem=osdElement;elem&&(enableAnimation?(elem.offsetWidth,requestAnimationFrame((function(){elem.classList.add("iconOsd-hidden"),_dom.default.addEventListener(elem,_dom.default.whichTransitionEvent(),onHideComplete,{once:!0})}))):onHideComplete.call(elem))}function onVolumeChanged(e){!function ensureOsdElement(){var elem=osdElement;elem||(enableAnimation=_browser.default.supportsCssAnimation(),(elem=document.createElement("div")).classList.add("hide"),elem.classList.add("iconOsd"),elem.classList.add("iconOsd-hidden"),elem.classList.add("volumeOsd"),elem.innerHTML=function getOsdElementHtml(){return'<span class="material-icons iconOsdIcon volume_up"></span>','<div class="iconOsdProgressOuter"><div class="iconOsdProgressInner"></div></div>','<span class="material-icons iconOsdIcon volume_up"></span><div class="iconOsdProgressOuter"><div class="iconOsdProgressInner"></div></div>'}(),iconElement=elem.querySelector(".material-icons"),progressElement=elem.querySelector(".iconOsdProgressInner"),document.body.appendChild(elem),osdElement=elem)}(),function updatePlayerVolumeState(isMuted,volume){iconElement&&(iconElement.classList.remove("volume_off","volume_up"),iconElement.classList.add(isMuted?"volume_off":"volume_up")),progressElement&&(progressElement.style.width=(volume||0)+"%")}(this.isMuted(),this.getVolume()),function showOsd(){clearHideTimeout();var elem=osdElement;_dom.default.removeEventListener(elem,_dom.default.whichTransitionEvent(),onHideComplete,{once:!0}),elem.classList.remove("hide"),elem.offsetWidth,requestAnimationFrame((function(){elem.classList.remove("iconOsd-hidden"),hideTimeout=setTimeout(hideOsd,3e3)}))}()}function bindToPlayer(player){player!==currentPlayer&&(!function releaseCurrentPlayer(){var player=currentPlayer;player&&(_events.default.off(player,"volumechange",onVolumeChanged),_events.default.off(player,"playbackstop",hideOsd),currentPlayer=null)}(),currentPlayer=player,player&&(hideOsd(),_events.default.on(player,"volumechange",onVolumeChanged),_events.default.on(player,"playbackstop",hideOsd)))}_events=_interopRequireDefault(_events),_playbackManager=_interopRequireDefault(_playbackManager),_dom=_interopRequireDefault(_dom),_browser=_interopRequireDefault(_browser),_events.default.on(_playbackManager.default,"playerchange",(function(){bindToPlayer(_playbackManager.default.getCurrentPlayer())})),bindToPlayer(_playbackManager.default.getCurrentPlayer())}));
//# sourceMappingURL=volumeosd.js.map
