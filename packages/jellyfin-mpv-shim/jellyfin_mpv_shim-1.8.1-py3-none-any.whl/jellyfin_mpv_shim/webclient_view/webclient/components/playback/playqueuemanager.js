"use strict";function _createForOfIteratorHelper(o,allowArrayLike){var it;if("undefined"==typeof Symbol||null==o[Symbol.iterator]){if(Array.isArray(o)||(it=_unsupportedIterableToArray(o))||allowArrayLike&&o&&"number"==typeof o.length){it&&(o=it);var i=0,F=function F(){};return{s:F,n:function n(){return i>=o.length?{done:!0}:{done:!1,value:o[i++]}},e:function e(_e){throw _e},f:F}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var err,normalCompletion=!0,didErr=!1;return{s:function s(){it=o[Symbol.iterator]()},n:function n(){var step=it.next();return normalCompletion=step.done,step},e:function e(_e2){didErr=!0,err=_e2},f:function f(){try{normalCompletion||null==it.return||it.return()}finally{if(didErr)throw err}}}}function _unsupportedIterableToArray(o,minLen){if(o){if("string"==typeof o)return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);return"Object"===n&&o.constructor&&(n=o.constructor.name),"Map"===n||"Set"===n?Array.from(o):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?_arrayLikeToArray(o,minLen):void 0}}function _arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}define([],(function(){var currentId=0;function addUniquePlaylistItemId(item){item.PlaylistItemId||(item.PlaylistItemId="playlistItem"+currentId,currentId++)}function findPlaylistIndex(playlistItemId,list){for(var i=0,length=list.length;i<length;i++)if(list[i].PlaylistItemId===playlistItemId)return i;return-1}function PlayQueueManager(){this._sortedPlaylist=[],this._playlist=[],this._repeatMode="RepeatNone",this._shuffleMode="Sorted"}return PlayQueueManager.prototype.getPlaylist=function(){return this._playlist.slice(0)},PlayQueueManager.prototype.setPlaylist=function(items){for(var i=0,length=(items=items.slice(0)).length;i<length;i++)addUniquePlaylistItemId(items[i]);this._currentPlaylistItemId=null,this._playlist=items,this._repeatMode="RepeatNone"},PlayQueueManager.prototype.queue=function(items){for(var i=0,length=items.length;i<length;i++)addUniquePlaylistItemId(items[i]),this._playlist.push(items[i])},PlayQueueManager.prototype.shufflePlaylist=function(){this._sortedPlaylist=[];var _step,_iterator=_createForOfIteratorHelper(this._playlist);try{for(_iterator.s();!(_step=_iterator.n()).done;){var item=_step.value;this._sortedPlaylist.push(item)}}catch(err){_iterator.e(err)}finally{_iterator.f()}for(var currentPlaylistItem=this._playlist.splice(this.getCurrentPlaylistIndex(),1)[0],i=this._playlist.length-1;i>0;i--){var j=Math.floor(Math.random()*i),temp=this._playlist[i];this._playlist[i]=this._playlist[j],this._playlist[j]=temp}this._playlist.unshift(currentPlaylistItem),this._shuffleMode="Shuffle"},PlayQueueManager.prototype.sortShuffledPlaylist=function(){this._playlist=[];var _step2,_iterator2=_createForOfIteratorHelper(this._sortedPlaylist);try{for(_iterator2.s();!(_step2=_iterator2.n()).done;){var item=_step2.value;this._playlist.push(item)}}catch(err){_iterator2.e(err)}finally{_iterator2.f()}this._sortedPlaylist=[],this._shuffleMode="Sorted"},PlayQueueManager.prototype.clearPlaylist=function(){var clearCurrentItem=arguments.length>0&&void 0!==arguments[0]&&arguments[0],currentPlaylistItem=this._playlist.splice(this.getCurrentPlaylistIndex(),1)[0];this._playlist=[],clearCurrentItem||this._playlist.push(currentPlaylistItem)},PlayQueueManager.prototype.queueNext=function(items){var i,length;for(i=0,length=items.length;i<length;i++)addUniquePlaylistItemId(items[i]);var currentIndex=this.getCurrentPlaylistIndex();-1===currentIndex?currentIndex=this._playlist.length:currentIndex++,function arrayInsertAt(destArray,pos,arrayToInsert){var args=[];args.push(pos),args.push(0),args=args.concat(arrayToInsert),destArray.splice.apply(destArray,args)}(this._playlist,currentIndex,items)},PlayQueueManager.prototype.getCurrentPlaylistIndex=function(){return findPlaylistIndex(this.getCurrentPlaylistItemId(),this._playlist)},PlayQueueManager.prototype.getCurrentItem=function(){var index=findPlaylistIndex(this.getCurrentPlaylistItemId(),this._playlist);return-1===index?null:this._playlist[index]},PlayQueueManager.prototype.getCurrentPlaylistItemId=function(){return this._currentPlaylistItemId},PlayQueueManager.prototype.setPlaylistState=function(playlistItemId,playlistIndex){this._currentPlaylistItemId=playlistItemId},PlayQueueManager.prototype.setPlaylistIndex=function(playlistIndex){playlistIndex<0?this.setPlaylistState(null):this.setPlaylistState(this._playlist[playlistIndex].PlaylistItemId)},PlayQueueManager.prototype.removeFromPlaylist=function(playlistItemIds){if(this._playlist.length<=playlistItemIds.length)return{result:"empty"};var currentPlaylistItemId=this.getCurrentPlaylistItemId(),isCurrentIndex=-1!==playlistItemIds.indexOf(currentPlaylistItemId);return this._sortedPlaylist=this._sortedPlaylist.filter((function(item){return!playlistItemIds.includes(item.PlaylistItemId)})),this._playlist=this._playlist.filter((function(item){return!playlistItemIds.includes(item.PlaylistItemId)})),{result:"removed",isCurrentIndex:isCurrentIndex}},PlayQueueManager.prototype.movePlaylistItem=function(playlistItemId,newIndex){for(var oldIndex,playlist=this.getPlaylist(),i=0,length=playlist.length;i<length;i++)if(playlist[i].PlaylistItemId===playlistItemId){oldIndex=i;break}if(-1===oldIndex||oldIndex===newIndex)return{result:"noop"};if(newIndex>=playlist.length)throw new Error("newIndex out of bounds");return function moveInArray(array,from,to){array.splice(to,0,array.splice(from,1)[0])}(playlist,oldIndex,newIndex),this._playlist=playlist,{result:"moved",playlistItemId:playlistItemId,newIndex:newIndex}},PlayQueueManager.prototype.reset=function(){this._sortedPlaylist=[],this._playlist=[],this._currentPlaylistItemId=null,this._repeatMode="RepeatNone",this._shuffleMode="Sorted"},PlayQueueManager.prototype.setRepeatMode=function(value){if(!["RepeatOne","RepeatAll","RepeatNone"].includes(value))throw new TypeError("invalid value provided for setRepeatMode");this._repeatMode=value},PlayQueueManager.prototype.getRepeatMode=function(){return this._repeatMode},PlayQueueManager.prototype.setShuffleMode=function(value){switch(value){case"Shuffle":this.shufflePlaylist();break;case"Sorted":this.sortShuffledPlaylist();break;default:throw new TypeError("invalid value provided to setShuffleMode")}},PlayQueueManager.prototype.toggleShuffleMode=function(){switch(this._shuffleMode){case"Shuffle":this.setShuffleMode("Sorted");break;case"Sorted":this.setShuffleMode("Shuffle");break;default:throw new TypeError("current value for shufflequeue is invalid")}},PlayQueueManager.prototype.getShuffleMode=function(){return this._shuffleMode},PlayQueueManager.prototype.getNextItemInfo=function(){var newIndex,playlist=this.getPlaylist(),playlistLength=playlist.length;switch(this.getRepeatMode()){case"RepeatOne":newIndex=this.getCurrentPlaylistIndex();break;case"RepeatAll":(newIndex=this.getCurrentPlaylistIndex()+1)>=playlistLength&&(newIndex=0);break;default:newIndex=this.getCurrentPlaylistIndex()+1}if(newIndex<0||newIndex>=playlistLength)return null;var item=playlist[newIndex];return item?{item:item,index:newIndex}:null},PlayQueueManager}));
//# sourceMappingURL=playqueuemanager.js.map
