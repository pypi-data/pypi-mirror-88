"use strict";define(["playbackManager","userSettings","connectionManager"],(function(playbackManager,userSettings,connectionManager){var currentOwnerId;function playThemeMedia(items,ownerId){var currentThemeItems=items.filter((function(i){return function enabled(mediaType){if("Video"===mediaType)return userSettings.enableThemeVideos();return userSettings.enableThemeSongs()}(i.MediaType)}));if(currentThemeItems.length){if(!currentOwnerId&&playbackManager.isPlaying())return;currentThemeItems.map((function(i){return i.Id})),playbackManager.play({items:currentThemeItems,fullscreen:!1,enableRemotePlayers:!1}).then((function(){currentOwnerId=ownerId}))}else stopIfPlaying()}function stopIfPlaying(){currentOwnerId&&playbackManager.stop(),currentOwnerId=null}var excludeTypes=["CollectionFolder","UserView","Program","SeriesTimer","Person","TvChannel","Channel"];document.addEventListener("viewshow",(function(e){var item=(e.detail.state||{}).item;item&&item.ServerId?function loadThemeMedia(item){if(item.CollectionType)stopIfPlaying();else if(-1===excludeTypes.indexOf(item.Type)){var apiClient=connectionManager.getApiClient(item.ServerId);apiClient.getThemeMedia(apiClient.getCurrentUserId(),item.Id,!0).then((function(themeMediaResult){var ownerId=themeMediaResult.ThemeVideosResult.Items.length?themeMediaResult.ThemeVideosResult.OwnerId:themeMediaResult.ThemeSongsResult.OwnerId;ownerId!==currentOwnerId&&playThemeMedia(themeMediaResult.ThemeVideosResult.Items.length?themeMediaResult.ThemeVideosResult.Items:themeMediaResult.ThemeSongsResult.Items,ownerId)}))}else stopIfPlaying()}(item):(e.detail.options||{}).supportsThemeMedia||playThemeMedia([],null)}),!0)}));
//# sourceMappingURL=themeMediaPlayer.js.map
