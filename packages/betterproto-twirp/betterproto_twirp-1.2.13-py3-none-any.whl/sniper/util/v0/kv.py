# Generated by the protocol buffer compiler.  DO NOT EDIT!
# sources: util/v0/kv.proto
# plugin: python-betterproto
import logging


import allure
from dataclasses import dataclass

import betterproto


@dataclass
class KvGetReq(betterproto.Message):
    # 泰山 DSN 配置名
    name: str = betterproto.string_field(1)
    # 数据对应的 key
    key: str = betterproto.string_field(2)


@dataclass
class KvGetResp(betterproto.Message):
    value: str = betterproto.string_field(1)


@dataclass
class KvSetReq(betterproto.Message):
    # 泰山 DSN 配置名
    name: str = betterproto.string_field(1)
    # 数据对应的 key
    key: str = betterproto.string_field(2)
    # 数据内容
    value: str = betterproto.string_field(3)


@dataclass
class KvEmptyResp(betterproto.Message):
    pass


class KvStub(betterproto.ServiceStub):
    """泰山内部接口 调试专用"""

    @allure.step("""查询数据""")
    def get(self, request: KvGetReq) -> KvGetResp:
        """查询数据"""
        logging.getLogger(__name__).info(
            "start call " + "[get]" + " api" + "=>" + """查询数据"""
        )
        response = KvGetResp()
        self._do_twirp_rpc("/util.v0.Kv/Get", request, response)
        logging.getLogger(__name__).info("call " + "[get]" + " api success!")
        return response

    @allure.step("""设置数据""")
    def set(self, request: KvSetReq) -> KvEmptyResp:
        """设置数据"""
        logging.getLogger(__name__).info(
            "start call " + "[set]" + " api" + "=>" + """设置数据"""
        )
        response = KvEmptyResp()
        self._do_twirp_rpc("/util.v0.Kv/Set", request, response)
        logging.getLogger(__name__).info("call " + "[set]" + " api success!")
        return response

    @allure.step("""删除数据""")
    def del_(self, request: KvGetReq) -> KvEmptyResp:
        """删除数据"""
        logging.getLogger(__name__).info(
            "start call " + "[del_]" + " api" + "=>" + """删除数据"""
        )
        response = KvEmptyResp()
        self._do_twirp_rpc("/util.v0.Kv/Del", request, response)
        logging.getLogger(__name__).info("call " + "[del_]" + " api success!")
        return response
