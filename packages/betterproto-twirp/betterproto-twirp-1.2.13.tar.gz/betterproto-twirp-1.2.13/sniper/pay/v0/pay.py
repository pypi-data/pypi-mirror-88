# Generated by the protocol buffer compiler.  DO NOT EDIT!
# sources: pay/v0/pay.proto
# plugin: python-betterproto
import logging


import allure
from dataclasses import dataclass

import betterproto


@dataclass
class OnCallbackReq(betterproto.Message):
    # 回调消息，json
    msg_content: str = betterproto.string_field(1)


@dataclass
class OnCallbackResp(betterproto.Message):
    """这是自定义类型，返回纯文本"""

    # text/plain
    content_type: str = betterproto.string_field(1)
    # 文本内容
    data: bytes = betterproto.bytes_field(2)


class PayStub(betterproto.ServiceStub):
    """内部支付服务"""

    @allure.step("""支付通知接口""")
    def on_callback(self, request: OnCallbackReq) -> OnCallbackResp:
        """支付通知接口"""
        logging.getLogger(__name__).info(
            "start call " + "[on_callback]" + " api" + "=>" + """支付通知接口"""
        )
        response = OnCallbackResp()
        self._do_twirp_rpc("/pay.v0.Pay/OnCallback", request, response)
        logging.getLogger(__name__).info("call " + "[on_callback]" + " api success!")
        return response

    @allure.step("""漫读卡签约""")
    def on_sign_callback(self, request: OnCallbackReq) -> OnCallbackResp:
        """漫读卡签约"""
        logging.getLogger(__name__).info(
            "start call " + "[on_sign_callback]" + " api" + "=>" + """漫读卡签约"""
        )
        response = OnCallbackResp()
        self._do_twirp_rpc("/pay.v0.Pay/OnSignCallback", request, response)
        logging.getLogger(__name__).info(
            "call " + "[on_sign_callback]" + " api success!"
        )
        return response

    @allure.step("""用户退款通知""")
    def on_refund_callback(self, request: OnCallbackReq) -> OnCallbackResp:
        """用户退款通知"""
        logging.getLogger(__name__).info(
            "start call " + "[on_refund_callback]" + " api" + "=>" + """用户退款通知"""
        )
        response = OnCallbackResp()
        self._do_twirp_rpc("/pay.v0.Pay/OnRefundCallback", request, response)
        logging.getLogger(__name__).info(
            "call " + "[on_refund_callback]" + " api success!"
        )
        return response

    @allure.step("""iOS 用户退款通知""")
    def on_i_a_p_refund_callback(self, request: OnCallbackReq) -> OnCallbackResp:
        """iOS 用户退款通知"""
        logging.getLogger(__name__).info(
            "start call "
            + "[on_i_a_p_refund_callback]"
            + " api"
            + "=>"
            + """iOS 用户退款通知"""
        )
        response = OnCallbackResp()
        self._do_twirp_rpc("/pay.v0.Pay/OnIAPRefundCallback", request, response)
        logging.getLogger(__name__).info(
            "call " + "[on_i_a_p_refund_callback]" + " api success!"
        )
        return response
