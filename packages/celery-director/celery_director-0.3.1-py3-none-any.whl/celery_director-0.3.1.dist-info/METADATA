Metadata-Version: 2.1
Name: celery-director
Version: 0.3.1
Summary: Celery Director
Home-page: https://github.com/ovh/celery-director
Author: OVHcloud
Author-email: opensource@ovhcloud.com
License: BSD
Platform: UNKNOWN
Classifier: Development Status :: 4 - Beta
Classifier: Environment :: Console
Classifier: Environment :: Web Environment
Classifier: Intended Audience :: Developers
Classifier: License :: OSI Approved :: BSD License
Classifier: Programming Language :: Python :: 3
Classifier: Programming Language :: Python :: 3.6
Classifier: Programming Language :: Python :: 3.7
Classifier: Topic :: System :: Monitoring
Requires-Python: ~=3.6
Description-Content-Type: text/markdown
Requires-Dist: celery (==4.4.7)
Requires-Dist: flower (==0.9.3)
Requires-Dist: kombu (==4.6.11)
Requires-Dist: psycopg2-binary (==2.8.4)
Requires-Dist: SQLAlchemy (==1.3.11)
Requires-Dist: sqlalchemy-utils (==0.35.0)
Requires-Dist: mysql-connector-python (==8.0.21)
Requires-Dist: redis (==3.3.11)
Requires-Dist: alembic (==1.3.2)
Requires-Dist: Flask (==1.1.1)
Requires-Dist: Flask-SQLAlchemy (==2.4.1)
Requires-Dist: Flask-json-schema (==0.0.5)
Requires-Dist: Flask-Migrate (==2.5.2)
Requires-Dist: Flask-HTTPAuth (==4.1.0)
Requires-Dist: gunicorn (==20.0.4)
Requires-Dist: environs (==6.1.0)
Requires-Dist: pyyaml (==5.1.2)
Requires-Dist: click (==7.0)
Requires-Dist: terminaltables (==3.1.0)
Requires-Dist: pluginbase (==1.0.0)
Requires-Dist: sentry-sdk (==0.16.3)
Provides-Extra: ci
Requires-Dist: pytest ; extra == 'ci'
Requires-Dist: pytest-cov ; extra == 'ci'
Provides-Extra: dev
Requires-Dist: tox (==3.5.3) ; extra == 'dev'
Requires-Dist: black (==20.8b1) ; extra == 'dev'
Provides-Extra: doc
Requires-Dist: mkdocs (==1.0.4) ; extra == 'doc'
Requires-Dist: mkdocs-material (==4.6.3) ; extra == 'doc'

<p align="center">
  <img alt="Celery Director logo" src="https://raw.githubusercontent.com/ovh/celery-director/master/logo.png">
</p>
<p align="center">
  <a href="https://travis-ci.org/ovh/celery-director"><img alt="Build status" src="https://travis-ci.org/ovh/celery-director.svg?branch=master"></a>
  <a href="https://www.python.org/"><img alt="Python versions" src="https://img.shields.io/badge/python-3.6%2B-blue.svg"></a>
  <a href="https://github.com/ovh/depc/blob/master/LICENSE"><img alt="License" src="https://img.shields.io/badge/license-BSD%203--Clause-blue.svg"></a>
  <a href="https://github.com/python/black"><img alt="Code style: black" src="https://img.shields.io/badge/code%20style-black-000000.svg"></a>
</p>
<p align="center">
  <a href="https://raw.githubusercontent.com/ovh/celery-director/master/director.gif"><img alt="Celery Director" src="https://raw.githubusercontent.com/ovh/celery-director/master/director.gif"></a>
</p>

----------------

Director is a simple and rapid framework used to manage tasks and build workflows using Celery.

The objective is to make Celery easier to use by providing :

- a WebUI to track the tasks states,
- an API and a CLI to manage and execute the workflows,
- a YAML syntax used to combine tasks into workflows,
- the ability to periodically launch a whole workflow,
- and many others.

See how to use Director with the quickstart and guides in the [documentation](https://ovh.github.io/celery-director/).

## Installation

Install the latest version of Director with pip (requires `Python 3.6` at least):

```bash
pip install celery-director
```

## Usage

### Write your code in Python

```python
# tasks/orders.py
from director import task
from .utils import Order, Mail

@task(name="ORDER_PRODUCT")
def order_product(*args, **kwargs):
    order = Order(
      user=kwargs["payload"]["user"],
      product=kwargs["payload"]["product"]
    ).save()
    return {"id": order.id}

@task(name="SEND_MAIL")
def send_mail(*args, **kwargs):
    order_id = args[0]["id"]
    mail = Mail(
      title=f"Your order #{order_id} has been received",
      user=kwargs["payload"]["user"]
    )
    mail.send()
```

### Build your workflows in YAML

```yaml
# workflows.yml
product.ORDER:
  tasks:
    - ORDER_PRODUCT
    - SEND_MAIL
```

### Run it

You can simply test your workflow in local :

```bash
$ director workflow run product.ORDER '{"user": 1234, "product": 1000}'
```

And run it in production using the director API :

```bash
$ curl --header "Content-Type: application/json" \
  --request POST \
  --data '{"project": "product", "name": "ORDER", "payload": {"user": 1234, "product": 1000}}' \
  http://localhost:8000/api/workflows
```

Read the [documentation](https://ovh.github.io/celery-director/) to try the quickstart and see advanced usages of Celery Director.

## Project layout

    .env                # The configuration file.
    workflows.yml       # The workflows definition.
    tasks/
        example.py      # A file containing some tasks.
        ...             # Other files containing other tasks.

## Commands

* `director init [path]` - Create a new project.
* `director celery [worker|beat|flower]` - Start Celery daemons.
* `director webserver` - Start the webserver.
* `director workflow [list|show|run]` - Manage your project workflows.

## License

See https://github.com/ovh/celery-director/blob/master/LICENSE


