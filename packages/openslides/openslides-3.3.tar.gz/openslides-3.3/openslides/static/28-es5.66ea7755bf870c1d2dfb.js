!function(){function t(e,n){return(t=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(e,n)}function e(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var o,r=i(t);if(e){var a=i(this).constructor;o=Reflect.construct(r,arguments,a)}else o=r.apply(this,arguments);return n(this,o)}}function n(t,e){return!e||"object"!=typeof e&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function i(t){return(i=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function o(t){return function(t){if(Array.isArray(t))return c(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||a(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function r(t,e){var n;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(n=a(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var i=0,o=function(){};return{s:o,n:function(){return i>=t.length?{done:!0}:{done:!1,value:t[i++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,c=!0,s=!1;return{s:function(){n=t[Symbol.iterator]()},n:function(){var t=n.next();return c=t.done,t},e:function(t){s=!0,r=t},f:function(){try{c||null==n.return||n.return()}finally{if(s)throw r}}}}function a(t,e){if(t){if("string"==typeof t)return c(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?c(t,e):void 0}}function c(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}function s(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function l(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function u(t,e,n){return e&&l(t.prototype,e),n&&l(t,n),t}(window.webpackJsonp=window.webpackJsonp||[]).push([[28],{"1NkQ":function(t,e,n){"use strict";n.d(e,"a",(function(){return d}));var i,o=n("+KbT"),r=n("Iab2"),a=n("8Y7J"),c=((i=function(){function t(){s(this,t)}return u(t,[{key:"saveFile",value:function(t,e,n){var i={};n&&(i.type=n);var o=new Blob([t],i);Object(r.saveAs)(o,e,{autoBOM:!0})}},{key:"validateFileName",value:function(t){return new RegExp(/^[^\\\/\?%\*:\|\"\<\>]*[^\.]+$/i).test(t)}},{key:"convertTo8859_15",value:function(t){for(var e=new Uint8Array(new ArrayBuffer(t.length)),n=0;n<t.length;n++)e[n]=t.charCodeAt(n);return e}}]),t}()).\u0275fac=function(t){return new(t||i)},i.\u0275prov=a.Nb({token:i,factory:i.\u0275fac,providedIn:"root"}),i),l=n("TSSN");function b(t){return void 0!==t.property}function f(t){return void 0!==t.map&&void 0!==t.label}var p,d=((p=function(){function t(e,n,i){s(this,t),this.exporter=e,this.translate=n,this.config=i}return u(t,[{key:"export",value:function(t,e,n){var i=this,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},r=o.lineSeparator,a=void 0===r?"\r\n":r,c=o.columnSeparator,s=void 0===c?this.config.instant("general_csv_separator"):c,l=o.encoding,u=void 0===l?this.config.instant("general_csv_encoding"):l,p=[];if(a===s)throw new Error("lineseparator and columnseparator must differ from each other");var d=e.map((function(t){var e;return b(t)?e=t.label?t.label:t.property:f(t)&&(e=t.label),e=i.capitalizeTranslate(e)}));p.push(d);var g=(p=p.concat(t.map((function(t){return e.map((function(e){var n;if(b(e)){var o=t[e.property];n="number"==typeof o?o.toString(10):o?!0===o?"1":!1===o?"0":o.toString():""}else f(e)&&(n=e.map(t));return i.checkCsvTextSafety(n)}))})))).map((function(t){return t.join(s)})).join(a),m="text/csv;charset="+u;this.exporter.saveFile("iso-8859-15"===u?this.exporter.convertTo8859_15(g):g,n,m)}},{key:"checkCsvTextSafety",value:function(t){return t?'"'+t.replace(/"/g,'""').replace(/(\r\n\t|\n|\r\t)/gm,"")+'"':""}},{key:"capitalizeTranslate",value:function(t){var e=t.charAt(0).toUpperCase()+t.slice(1);return this.translate.instant(e)}},{key:"dummyCSVExport",value:function(t,e,n){var i=this,o=this.config.instant("general_csv_separator"),r=[t.map((function(t){return i.translate.instant(t)})).join(o)],a=e.map((function(t){return t.map((function(t){var e="";return t||(e=""),e="number"==typeof t?t.toString(10):"boolean"==typeof t?t?"1":"0":t,i.checkCsvTextSafety(e)})).join(o)})),c=r.concat(a).join("\r\n"),s=this.config.instant("general_csv_encoding");this.exporter.saveFile("iso-8859-15"===s?this.exporter.convertTo8859_15(c):c,n,"text/csv")}}]),t}()).\u0275fac=function(t){return new(t||p)(a.bc(c),a.bc(l.k),a.bc(o.a))},p.\u0275prov=a.Nb({token:p,factory:p.\u0275fac,providedIn:"root"}),p)},ePZ9:function(t,e,n){"use strict";n.d(e,"a",(function(){return h}));var i=n("pSLD"),a=n("+B0n"),c=n("dOok"),l=n("+KbT"),b=n("1NkQ"),f=n("a9XT"),p=n("rHPv"),d=n("jDC6"),g=n("3Y4h"),m=n("8Y7J"),v=n("TSSN"),h=function(){var t=function(){function t(e,n,i,o,r,a,c){s(this,t),this.csvExport=e,this.translate=n,this.configService=i,this.linenumberingService=o,this.changeRecoRepo=r,this.motionRepo=a,this.commentRepo=c}return u(t,[{key:"createText",value:function(t,e){var n=this.configService.instant("motions_line_length"),i=Object.assign([],this.changeRecoRepo.getChangeRecoOfMotion(t.id)),o=this.motionRepo.getAmendmentsInstantly(t.id);if(o){var a,c=r(o);try{for(c.s();!(a=c.n()).done;){var s,l=a.value,u=this.changeRecoRepo.getChangeRecoOfMotion(l.id).filter((function(t){return t.showInFinalView()})),b=r(this.motionRepo.getAmendmentAmendedParagraphs(l,n,u));try{for(b.s();!(s=b.n()).done;){var f=s.value;i.push(f)}}catch(d){b.e(d)}finally{b.f()}}}catch(d){c.e(d)}finally{c.f()}}i.sort((function(t,e){return t.getLineFrom()-e.getLineFrom()}));var p=this.motionRepo.formatMotion(t.id,e,i,n);return this.linenumberingService.stripLineNumbers(p)}},{key:"exportMotionList",value:function(t,e,n,i){var r=this;i||(i=this.configService.instant("motions_recommendation_text_mode"));var a=Object(g.j)(["identifier","title"].concat(e)).map((function(t){return"recommendation"===t?{label:"recommendation",map:function(t){return r.motionRepo.getExtendedRecommendationLabel(t)}}:"state"===t?{label:"state",map:function(t){return r.motionRepo.getExtendedStateLabel(t)}}:"text"===t?{label:"Text",map:function(t){return r.createText(t,i)}}:"motion_block"===t?{label:"Motion block",map:function(t){return t.motion_block?t.motion_block.getTitle():""}}:{property:t}}));a.push.apply(a,o(n.map((function(t){return{label:r.commentRepo.getViewModel(t).getTitle(),map:function(e){var n=r.commentRepo.getViewModel(t),i=e.getCommentForSection(n);return i&&i.comment?Object(p.a)(Object(d.a)(i.comment)):""}}})))),this.csvExport.export(t,a,this.translate.instant("Motions")+".csv")}},{key:"exportCallList",value:function(t){var e=this;this.csvExport.export(t,[{label:"Called",map:function(t){return t.sort_parent_id?"":t.identifierOrTitle}},{label:"Called with",map:function(t){return t.sort_parent_id?t.identifierOrTitle:""}},{label:"submitters",map:function(t){return t.submittersAsUsers.map((function(t){return t.short_name})).join(",")}},{property:"title"},{label:"recommendation",map:function(t){return t.recommendation?e.motionRepo.getExtendedRecommendationLabel(t):""}},{property:"motion_block",label:"Motion block"}],this.translate.instant("Call list")+".csv")}},{key:"exportDummyMotion",value:function(){this.csvExport.dummyCSVExport(["Identifier","Submitters","Title","Text","Reason","Category","Tags","Motion block","Origin"],[["A1","Submitter A","Title 1","Text 1","Reason 1","Category A","Tag 1, Tag 2","Block A","Last Year Conference A"],["B1","Submitter B","Title 2","Text 2","Reason 2","Category B",null,"Block A","Origin B"],["C2",null,"Title 3","Text 3",null,null,null,null,null]],this.translate.instant("motions-example")+".csv")}}]),t}();return t.\u0275fac=function(e){return new(e||t)(m.bc(b.a),m.bc(v.k),m.bc(l.a),m.bc(f.a),m.bc(i.a),m.bc(c.a),m.bc(a.a))},t.\u0275prov=m.Nb({token:t,factory:t.\u0275fac,providedIn:"root"}),t}()},mksl:function(t,e,n){"use strict";n.d(e,"a",(function(){return X}));var i=n("8Y7J"),o=n("VR2Q"),r=n("7dBR"),a=n("gsQk"),c=n("KL36"),l=n("iInd"),b=n("l0rg"),f=n("SVse"),p=n("Dxy4"),d=n("Tj54"),g=n("ZFy/"),m=n("TSSN");function v(t,e){if(1&t){var n=i.Yb();i.Xb(0,"button",12),i.fc("click",(function(){return i.Gc(n),i.jc().clickHamburgerMenu()})),i.Xb(1,"mat-icon"),i.Sc(2,"menu"),i.Wb(),i.Wb()}}function h(t,e){if(1&t){var n=i.Yb();i.Xb(0,"button",12),i.fc("click",(function(){return i.Gc(n),i.jc().onBackButton()})),i.Xb(1,"mat-icon"),i.Sc(2,"arrow_back"),i.Wb(),i.Wb()}}function y(t,e){if(1&t){var n=i.Yb();i.Xb(0,"button",12),i.fc("click",(function(){i.Gc(n);var t=i.jc();return t.isCancelEditUsed?t.sendCancelEditEvent():t.sendMainEvent()})),i.Xb(1,"mat-icon"),i.Sc(2,"close"),i.Wb(),i.Wb()}}function k(t,e){1&t&&(i.Xb(0,"div",13),i.pc(1,1),i.Wb())}function S(t,e){1&t&&i.Sb(0,"div",6)}function x(t,e){1&t&&(i.Xb(0,"div",14),i.pc(1,2),i.Wb())}function F(t,e){if(1&t){var n=i.Yb();i.Xb(0,"button",12),i.fc("click",(function(){return i.Gc(n),i.jc().openSearch()})),i.Xb(1,"mat-icon"),i.Sc(2,"search"),i.Wb(),i.Wb()}}function C(t,e){if(1&t){var n=i.Yb();i.Xb(0,"button",15),i.fc("click",(function(){return i.Gc(n),i.jc().sendMainEvent()})),i.kc(1,"translate"),i.Xb(2,"mat-icon"),i.Sc(3),i.Wb(),i.Wb()}if(2&t){var o=i.jc();i.sc("matTooltip",i.lc(1,3,o.mainActionTooltip)),i.rc("disabled",!o.isMainButtonEnabled),i.Fb(3),i.Tc(o.mainButtonIcon)}}function M(t,e){if(1&t){var n=i.Yb();i.Xb(0,"button",16),i.fc("click",(function(){return i.Gc(n),i.jc().save()})),i.Xb(1,"strong",17),i.Sc(2),i.kc(3,"translate"),i.Wb(),i.Wb()}if(2&t){var o=i.jc();i.rc("disabled",!o.isSaveButtonEnabled),i.Fb(2),i.Tc(i.lc(3,2,o.saveText))}}function O(t,e){1&t&&i.pc(0,3,["*ngIf","!editMode"])}function T(t,e){1&t&&(i.Xb(0,"mat-icon"),i.Sc(1," add "),i.Wb())}function w(t,e){if(1&t&&(i.Xb(0,"mat-icon"),i.Sc(1),i.Wb()),2&t){var n=i.jc(2);i.Fb(1),i.Uc(" ",n.mainButtonIcon," ")}}function E(t,e){if(1&t){var n=i.Yb();i.Xb(0,"button",18),i.fc("click",(function(){return i.Gc(n),i.jc().sendMainEvent()})),i.kc(1,"translate"),i.Qc(2,T,2,0,"mat-icon",10),i.Qc(3,w,2,1,"mat-icon",10),i.Wb()}if(2&t){var o=i.jc();i.sc("matTooltip",i.lc(1,4,o.mainActionTooltip)),i.rc("disabled",!o.isMainButtonEnabled),i.Fb(2),i.rc("ngIf","add_circle"===o.mainButtonIcon),i.Fb(1),i.rc("ngIf","add_circle"!==o.mainButtonIcon)}}var _=[[["",8,"extra-controls-slot"]],[["",8,"title-slot"]],[["",8,"central-info-slot"]],[["",8,"menu-slot"]]],W=[".extra-controls-slot",".title-slot",".central-info-slot",".menu-slot"],X=function(){var t=function(){function t(e,n,o,r,a,c){s(this,t),this.vp=e,this.menu=n,this.router=o,this.route=r,this.routingState=a,this.overlayService=c,this.nav=!0,this.mainButtonIcon="add_circle",this.saveText="Save",this.editMode=!1,this.isSearchEnabled=!0,this.isSaveButtonEnabled=!0,this.multiSelectMode=!1,this.hasMainButton=!1,this.isMainButtonEnabled=!0,this.goBack=!1,this.prevUrl="../",this.mainEvent=new i.p,this.cancelEditEvent=new i.p,this.isCancelEditUsed=!1,this.saveEvent=new i.p}return u(t,[{key:"ngOnInit",value:function(){this.isCancelEditUsed=this.cancelEditEvent.observers.length>0}},{key:"sendMainEvent",value:function(){this.mainEvent.next()}},{key:"sendCancelEditEvent",value:function(){this.cancelEditEvent.next()}},{key:"clickHamburgerMenu",value:function(){this.menu.toggleMenu()}},{key:"save",value:function(){this.saveEvent.next(!0)}},{key:"openSearch",value:function(){this.overlayService.showSearch()}},{key:"onBackButton",value:function(){this.goBack?this.routingState.goBack():this.router.navigate(this.routingState.customOrigin&&this.routingState.customOrigin!==this.router.url?[this.routingState.customOrigin]:[this.prevUrl],{relativeTo:this.route})}},{key:"showBackButton",get:function(){return!this.nav&&!this.multiSelectMode&&(this.routingState.isSafePrevUrl||!this.goBack)}}]),t}();return t.\u0275fac=function(e){return new(e||t)(i.Rb(c.a),i.Rb(o.a),i.Rb(l.f),i.Rb(l.a),i.Rb(a.a),i.Rb(r.a))},t.\u0275cmp=i.Lb({type:t,selectors:[["os-head-bar"]],inputs:{nav:"nav",mainButtonIcon:"mainButtonIcon",saveText:"saveText",editMode:"editMode",isSearchEnabled:"isSearchEnabled",isSaveButtonEnabled:"isSaveButtonEnabled",multiSelectMode:"multiSelectMode",hasMainButton:"hasMainButton",isMainButtonEnabled:"isMainButtonEnabled",goBack:"goBack",prevUrl:"prevUrl",mainActionTooltip:"mainActionTooltip"},outputs:{mainEvent:"mainEvent",cancelEditEvent:"cancelEditEvent",saveEvent:"saveEvent"},ngContentSelectors:W,decls:16,vars:12,consts:[["color","primary",1,"sticky-toolbar",3,"ngClass"],[1,"toolbar-left"],["mat-icon-button","",3,"click",4,"ngIf"],["class","toolbar-left-text",4,"ngIf"],["class","spacer",4,"ngIf"],["class","toolbar-centered",4,"ngIf"],[1,"spacer"],[1,"toolbar-right"],["mat-icon-button","",3,"disabled","matTooltip","click",4,"ngIf"],["mat-button","",3,"disabled","click",4,"ngIf"],[4,"ngIf"],["mat-fab","","class","head-button",3,"disabled","matTooltip","click",4,"ngIf"],["mat-icon-button","",3,"click"],[1,"toolbar-left-text"],[1,"toolbar-centered"],["mat-icon-button","",3,"disabled","matTooltip","click"],["mat-button","",3,"disabled","click"],[1,"upper"],["mat-fab","",1,"head-button",3,"disabled","matTooltip","click"]],template:function(t,e){1&t&&(i.qc(_),i.Xb(0,"mat-toolbar",0),i.Xb(1,"div",1),i.Qc(2,v,3,0,"button",2),i.Qc(3,h,3,0,"button",2),i.Qc(4,y,3,0,"button",2),i.Qc(5,k,2,0,"div",3),i.Wb(),i.Qc(6,S,1,0,"div",4),i.Qc(7,x,2,0,"div",5),i.Sb(8,"div",6),i.Qc(9,F,3,0,"button",2),i.Xb(10,"div",7),i.pc(11),i.Qc(12,C,4,5,"button",8),i.Qc(13,M,4,4,"button",9),i.Qc(14,O,1,0,"ng-content",10),i.Wb(),i.Wb(),i.Qc(15,E,4,6,"button",11)),2&t&&(i.rc("ngClass",e.multiSelectMode?"multi-select":""),i.Fb(2),i.rc("ngIf",e.vp.isMobile&&!e.showBackButton&&!e.editMode),i.Fb(1),i.rc("ngIf",e.showBackButton&&!e.editMode),i.Fb(1),i.rc("ngIf",e.editMode),i.Fb(1),i.rc("ngIf",!e.multiSelectMode),i.Fb(1),i.rc("ngIf",!e.multiSelectMode),i.Fb(1),i.rc("ngIf",e.multiSelectMode),i.Fb(2),i.rc("ngIf",!e.editMode&&e.isSearchEnabled),i.Fb(3),i.rc("ngIf",e.hasMainButton&&!e.editMode&&!e.vp.isMobile&&!e.multiSelectMode),i.Fb(1),i.rc("ngIf",e.editMode),i.Fb(1),i.rc("ngIf",!e.editMode),i.Fb(1),i.rc("ngIf",e.hasMainButton&&!e.editMode&&e.vp.isMobile&&!e.multiSelectMode))},directives:[b.a,f.q,f.t,p.b,d.a,g.c],pipes:[m.j],styles:[".head-button{position:fixed;z-index:10;right:20px;bottom:55px}.sticky-toolbar{top:0;z-index:5;position:-webkit-sticky;position:sticky;height:64px!important}.sticky-toolbar .toolbar-left{display:-ms-flexbox;display:flex;max-width:calc(100% - 100px)}.sticky-toolbar .toolbar-left button{margin:12px 0}.sticky-toolbar .toolbar-left .toolbar-left-text{margin-left:10px;width:100%;overflow:hidden}.sticky-toolbar .toolbar-left .toolbar-left-text .title-slot{margin:16px 0;display:block}.sticky-toolbar .toolbar-left .toolbar-left-text .title-slot h2{overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.sticky-toolbar .toolbar-centered{margin:auto;vertical-align:baseline}.sticky-toolbar .toolbar-right,.sticky-toolbar .toolbar-right .extra-controls-slot{display:-ms-flexbox;display:flex}mat-toolbar.multi-select{background-color:#757575!important}"],encapsulation:2}),t}()},rHPv:function(t,e,n){"use strict";function i(t){return t.replace(/&auml;|&#228;/g,"\xe4").replace(/&Auml;|&#196;/g,"\xc4").replace(/&ouml;|&#246;/g,"\xf6").replace(/&Ouml;|&#214;/g,"\xd6").replace(/&uuml;/g,"\xfc").replace(/&Uuml;/g,"\xdc").replace(/&aring;|&#229;/g,"\xe5").replace(/&Aring;|&#197;/g,"\xc5").replace(/&szlig;|&#223;/g,"\xdf")}n.d(e,"a",(function(){return i}))},ssNq:function(n,i,o){"use strict";o.r(i),o.d(i,"CallListModule",(function(){return G}));var r=o("SVse"),a=o("PCNd"),c=o("iInd"),l=o("+QJK"),b=o("mrSG"),f=o("2Vo4"),p=o("iTQr"),d=o("dOok"),g=o("lv9T"),m=o("F48D"),v=o("Qy/R"),h=o("ePZ9"),y=o("y50V"),k=o("8Y7J"),S=o("cUpR"),x=o("TSSN"),F=o("zHaW"),C=o("mksl"),M=o("Dxy4"),O=o("rJgo"),T=o("Tj54"),w=o("PDjf"),E=o("/tkw"),_=o("BSbQ"),W=o("8Qe2");function X(t,e){if(1&t){var n=k.Yb();k.Xb(0,"div",17),k.Xb(1,"div"),k.Xb(2,"span"),k.Sc(3),k.kc(4,"translate"),k.Wb(),k.Sc(5,":\xa0 "),k.Wb(),k.Xb(6,"div"),k.Xb(7,"button",18),k.fc("click",(function(){return k.Gc(n),k.jc().resetFilters()})),k.Xb(8,"mat-icon",19),k.Sc(9,"cancel"),k.Wb(),k.Xb(10,"span"),k.Sc(11),k.kc(12,"translate"),k.Wb(),k.Wb(),k.Wb(),k.Wb()}2&t&&(k.Fb(3),k.Tc(k.lc(4,2,"Active filters")),k.Fb(8),k.Tc(k.lc(12,4,"Clear all")))}function R(t,e){if(1&t&&(k.Xb(0,"div"),k.Xb(1,"button",20),k.Xb(2,"span",21),k.Sc(3),k.kc(4,"translate"),k.Wb(),k.Wb(),k.Wb()),2&t){var n=k.jc(),i=k.Cc(23);k.Fb(1),k.rc("matMenuTriggerFor",i),k.Fb(1),k.rc("matBadge",n.activeCatFilterCount>0?n.activeCatFilterCount:null)("matBadgeOverlap",!1),k.Fb(1),k.Uc(" ",k.lc(4,4,"Categories")," ")}}function B(t,e){if(1&t&&(k.Xb(0,"div"),k.Xb(1,"button",20),k.Xb(2,"span",21),k.Sc(3),k.kc(4,"translate"),k.Wb(),k.Wb(),k.Wb()),2&t){var n=k.jc(),i=k.Cc(26);k.Fb(1),k.rc("matMenuTriggerFor",i),k.Fb(1),k.rc("matBadge",n.activeTagFilterCount>0?n.activeTagFilterCount:null)("matBadgeOverlap",!1),k.Fb(1),k.Uc(" ",k.lc(4,4,"Tags")," ")}}function j(t,e){1&t&&(k.Xb(0,"mat-icon"),k.Sc(1,"checked"),k.Wb())}function I(t,e){if(1&t){var n=k.Yb();k.Xb(0,"div"),k.Xb(1,"button",16),k.fc("click",(function(){k.Gc(n);var t=e.$implicit;return k.jc().onFilterChange("category",t.id)})),k.Qc(2,j,2,0,"mat-icon",8),k.Xb(3,"span"),k.Sc(4),k.Wb(),k.Wb(),k.Wb()}if(2&t){var i=e.$implicit;k.Fb(2),k.rc("ngIf",i.state),k.Fb(2),k.Tc(i.label)}}function P(t,e){1&t&&(k.Xb(0,"mat-icon"),k.Sc(1,"checked"),k.Wb())}function A(t,e){if(1&t){var n=k.Yb();k.Xb(0,"div"),k.Xb(1,"button",16),k.fc("click",(function(){k.Gc(n);var t=e.$implicit;return k.jc().onFilterChange("tag",t.id)})),k.Qc(2,P,2,0,"mat-icon",8),k.Xb(3,"span"),k.Sc(4),k.Wb(),k.Wb(),k.Wb()}if(2&t){var i=e.$implicit;k.Fb(2),k.rc("ngIf",i.state),k.Fb(2),k.Tc(i.label)}}function Q(t,e){if(1&t&&(k.Xb(0,"span"),k.Xb(1,"mat-icon",19),k.Sc(2,"local_offer"),k.Wb(),k.Sc(3),k.Wb()),2&t){var n=e.$implicit;k.Fb(3),k.Uc(" ",n.getTitle()," ")}}function L(t,e){if(1&t&&(k.Xb(0,"div",22),k.Xb(1,"div",23),k.Sc(2),k.Wb(),k.Xb(3,"div",24),k.Qc(4,Q,4,1,"span",10),k.Wb(),k.Wb()),2&t){var n=e.item,i=k.jc();k.Fb(2),k.Uc(" ",n.getTitle()," "),k.Fb(2),k.rc("ngForOf",i.getTags(n))}}var U,N,D,Y=[{path:"",component:(U=function(n){!function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(n&&n.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),n&&t(e,n)}(o,n);var i=e(o);function o(t,e,n,r,a,c,l,u,b){var p;return s(this,o),(p=i.call(this,t,e,n,b)).translate=e,p.motionRepo=r,p.motionCsvExport=a,p.motionPdfExport=c,p.tagRepo=l,p.categoryRepo=u,p.motions=[],p.hasChanged=!1,p.tagFilterOptions=[],p.activeTagFilterCount=0,p.categoryFilterOptions=[],p.activeCatFilterCount=0,p.activeTagFilters=new f.a([]),p.activeCatFilters=new f.a([]),p.motionsObservable=p.motionRepo.getViewModelListObservable(),p.motionsObservable.subscribe((function(t){p.motions=t.map((function(t){return t})).sort((function(t,e){return t.weight-e.weight}))})),p}return u(o,[{key:"ngOnInit",value:function(){var t=this;this.subscriptions.push(this.activeTagFilters.subscribe((function(e){return t.onSubscribedFilterChange("tag",e)}))),this.subscriptions.push(this.activeCatFilters.subscribe((function(e){return t.onSubscribedFilterChange("category",e)}))),this.subscriptions.push(this.tagRepo.getViewModelListBehaviorSubject().subscribe((function(e){e&&e.length?(t.tagFilterOptions=e.map((function(e){return{label:e.name,id:e.id,state:t.tagFilterOptions&&t.tagFilterOptions.some((function(t){return t.id===e.id&&!0===t.state}))}})),t.tagFilterOptions.push({label:t.translate.instant("No tags"),id:0,state:t.tagFilterOptions&&t.tagFilterOptions.some((function(t){return 0===t.id&&!0===t.state}))})):t.tagFilterOptions=[]}))),this.subscriptions.push(this.categoryRepo.getViewModelListBehaviorSubject().subscribe((function(e){e&&e.length?(t.categoryFilterOptions=e.map((function(e){return{label:e.prefixedName,id:e.id,state:t.categoryFilterOptions&&t.categoryFilterOptions.some((function(t){return t.id===e.id&&!0===t.state}))}})),t.categoryFilterOptions.push({label:t.translate.instant("No category"),id:0,state:t.categoryFilterOptions&&t.categoryFilterOptions.some((function(t){return 0===t.id&&!0===t.state}))})):t.categoryFilterOptions=[]})))}},{key:"onSave",value:function(){return Object(b.a)(this,void 0,void 0,regeneratorRuntime.mark((function t(){var e=this;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.motionRepo.sortMotions(this.osSortTree.getTreeData()).then((function(){return e.osSortTree.setSubscription()}),this.raiseError);case 2:case"end":return t.stop()}}),t,this)})))}},{key:"onCancel",value:function(){return Object(b.a)(this,void 0,void 0,regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.canDeactivate();case 2:if(t.t0=t.sent,!t.t0){t.next=5;break}this.osSortTree.setSubscription();case 5:case"end":return t.stop()}}),t,this)})))}},{key:"receiveChanges",value:function(t){this.hasChanged=t}},{key:"csvExportCallList",value:function(){this.motionCsvExport.exportCallList(this.motions)}},{key:"pdfExportCallList",value:function(){this.motionPdfExport.exportPdfCallList(this.motions)}},{key:"getTags",value:function(t){var e=this.motionRepo.getViewModel(t.id);return e?e.tags:[]}},{key:"onFilterChange",value:function(t,e){var n="tag"===t?this.activeTagFilters.value:this.activeCatFilters.value;n.includes(e)?n.splice(n.indexOf(e),1):n.push(e),"tag"===t?this.activeTagFilters.next(n):this.activeCatFilters.next(n)}},{key:"resetFilters",value:function(){this.activeTagFilters.next([]),this.activeCatFilters.next([])}},{key:"sortMotionsByIdentifier",value:function(){return Object(b.a)(this,void 0,void 0,regeneratorRuntime.mark((function t(){var e,n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=this.translate.instant("Do you really want to go ahead?"),n=this.translate.instant("This will reset all made changes and sort the call list."),t.next=3,this.promptService.open(e,n);case 3:if(t.t0=t.sent,!t.t0){t.next=6;break}this.forceSort.emit("identifier");case 6:case"end":return t.stop()}}),t,this)})))}},{key:"onSubscribedFilterChange",value:function(t,e){"tag"===t?(this.activeTagFilterCount=e.length,this.tagFilterOptions.forEach((function(t){t.state=e&&e.some((function(e){return e===t.id}))}))):(this.activeCatFilterCount=e.length,this.categoryFilterOptions.forEach((function(t){t.state=e&&e.some((function(e){return e===t.id}))}))),this.hasActiveFilter=this.activeCatFilterCount>0||this.activeTagFilterCount>0;var n=this.tagFilterOptions.filter((function(t){return!0===t.state})),i=this.categoryFilterOptions.filter((function(t){return!0===t.state}));this.changeFilter.emit((function(t){if(n.length)if(t.tags&&t.tags.length){if(!t.tags.some((function(t){return n.some((function(e){return e.id===t.id}))})))return!0}else if(!n.some((function(t){return 0===t.id})))return!0;if(i.length){var e=t.category_id||0;return!i.some((function(t){return t.id===e}))}return!1}))}}]),o}(v.a),U.\u0275fac=function(t){return new(t||U)(k.Rb(S.c),k.Rb(x.k),k.Rb(F.a),k.Rb(d.a),k.Rb(h.a),k.Rb(y.a),k.Rb(g.a),k.Rb(p.a),k.Rb(m.a))},U.\u0275cmp=k.Lb({type:U,selectors:[["os-call-list"]],features:[k.Cb],decls:54,vars:28,consts:[["prevUrl","../..",3,"nav","editMode","mainEvent","saveEvent"],[1,"title-slot"],[1,"menu-slot"],["type","button","mat-icon-button","",3,"matMenuTriggerFor"],[1,"custom-table-header","flex-spaced"],[1,"filter-count"],["class","current-filters",4,"ngIf"],[1,"flex-spaced","margin-right-5"],[4,"ngIf"],["catFilterMenu","matMenu"],[4,"ngFor","ngForOf"],["tagFilterMenu","matMenu"],["parentKey","sort_parent_id","weightKey","weight",3,"model","filterChange","sortingDefinition","visibleNodes","hasChanged"],["osSortedTree",""],["innerNode",""],["mainMenu","matMenu"],["mat-menu-item","",3,"click"],[1,"current-filters"],["mat-button","",3,"click"],["inline",""],["mat-button","",3,"matMenuTriggerFor"],["matBadgeColor","accent",1,"upper",3,"matBadge","matBadgeOverlap"],[1,"line"],[1,"left"],[1,"right"]],template:function(t,e){if(1&t&&(k.Xb(0,"os-head-bar",0),k.fc("mainEvent",(function(){return e.onCancel()}))("saveEvent",(function(){return e.onSave()})),k.Xb(1,"div",1),k.Xb(2,"h2"),k.Sc(3),k.kc(4,"translate"),k.Wb(),k.Wb(),k.Xb(5,"div",2),k.Xb(6,"button",3),k.Xb(7,"mat-icon"),k.Sc(8,"more_vert"),k.Wb(),k.Wb(),k.Wb(),k.Wb(),k.Xb(9,"div",4),k.Xb(10,"div",5),k.Xb(11,"span"),k.Sc(12),k.Wb(),k.Xb(13,"span"),k.Sc(14),k.kc(15,"translate"),k.Wb(),k.Xb(16,"span"),k.Sc(17),k.Wb(),k.Wb(),k.Qc(18,X,13,6,"div",6),k.Xb(19,"div",7),k.Qc(20,R,5,6,"div",8),k.Qc(21,B,5,6,"div",8),k.Wb(),k.Wb(),k.Xb(22,"mat-menu",null,9),k.Qc(24,I,5,2,"div",10),k.Wb(),k.Xb(25,"mat-menu",null,11),k.Qc(27,A,5,2,"div",10),k.Wb(),k.Xb(28,"mat-card"),k.Xb(29,"os-sorting-tree",12,13),k.fc("visibleNodes",(function(t){return e.onChangeAmountOfItems(t)}))("hasChanged",(function(t){return e.receiveChanges(t)})),k.Qc(31,L,5,2,"ng-template",null,14,k.Rc),k.Wb(),k.Wb(),k.Xb(33,"mat-menu",null,15),k.Xb(35,"button",16),k.fc("click",(function(){return e.sortMotionsByIdentifier()})),k.Xb(36,"mat-icon"),k.Sc(37,"sort"),k.Wb(),k.Xb(38,"span"),k.Sc(39),k.kc(40,"translate"),k.Wb(),k.Wb(),k.Sb(41,"mat-divider"),k.Xb(42,"button",16),k.fc("click",(function(){return e.pdfExportCallList()})),k.Xb(43,"mat-icon"),k.Sc(44,"picture_as_pdf"),k.Wb(),k.Xb(45,"span"),k.Sc(46),k.kc(47,"translate"),k.Wb(),k.Wb(),k.Xb(48,"button",16),k.fc("click",(function(){return e.csvExportCallList()})),k.Xb(49,"mat-icon"),k.Sc(50,"archive"),k.Wb(),k.Xb(51,"span"),k.Sc(52),k.kc(53,"translate"),k.Wb(),k.Wb(),k.Wb()),2&t){var n=k.Cc(34);k.rc("nav",!1)("editMode",e.hasChanged),k.Fb(3),k.Tc(k.lc(4,18,"Call list")),k.Fb(3),k.rc("matMenuTriggerFor",n),k.Fb(6),k.Uc(" ",e.seenNodes[0],"\xa0"),k.Fb(2),k.Tc(k.lc(15,20,"of")),k.Fb(3),k.Uc("\xa0",e.seenNodes[1],""),k.Fb(1),k.rc("ngIf",e.hasActiveFilter),k.Fb(2),k.rc("ngIf",e.categoryFilterOptions.length),k.Fb(1),k.rc("ngIf",e.tagFilterOptions.length),k.Fb(3),k.rc("ngForOf",e.categoryFilterOptions),k.Fb(3),k.rc("ngForOf",e.tagFilterOptions),k.Fb(2),k.rc("model",e.motionsObservable)("filterChange",e.changeFilter)("sortingDefinition",e.forceSort),k.Fb(10),k.Tc(k.lc(40,22,"Sort by identifier")),k.Fb(7),k.Tc(k.lc(47,24,"Export as PDF")),k.Fb(6),k.Tc(k.lc(53,26,"Export as CSV"))}},directives:[C.a,M.b,O.e,T.a,r.t,O.f,r.s,w.a,E.a,O.c,_.a,W.a],pipes:[x.j],styles:[".line[_ngcontent-%COMP%]{display:table;width:100%;font-size:14px;min-height:50px;margin-bottom:5px}.line[_ngcontent-%COMP%]   .left[_ngcontent-%COMP%]{max-width:100%}.line[_ngcontent-%COMP%]   .left[_ngcontent-%COMP%], .line[_ngcontent-%COMP%]   .right[_ngcontent-%COMP%]{display:table-cell;vertical-align:middle}.line[_ngcontent-%COMP%]   .right[_ngcontent-%COMP%]{padding-right:10px;width:auto;white-space:nowrap}.margin-right-5[_ngcontent-%COMP%]{margin-right:5px!important}",".filter-menu-head[_ngcontent-%COMP%]{padding-left:5px}.filter-menu-head[_ngcontent-%COMP%]   .mat-button[_ngcontent-%COMP%]{margin:0 auto}.filter-menu-head[_ngcontent-%COMP%]:hover{cursor:pointer}.action-buttons[_ngcontent-%COMP%]{display:-ms-flexbox;display:flex}.action-buttons[_ngcontent-%COMP%]   os-rounded-input[_ngcontent-%COMP%]{margin:0 10px}@media (max-width:500px){.action-buttons[_ngcontent-%COMP%]   os-rounded-input[_ngcontent-%COMP%]{display:none}}.active-filter[_ngcontent-%COMP%]{white-space:pre}span.right-with-margin[_ngcontent-%COMP%]{margin-right:25px}.filter-count[_ngcontent-%COMP%]{min-width:-webkit-fit-content;min-width:-moz-fit-content;min-width:fit-content;font-style:italic;margin-left:24px;margin-right:1em}.current-filters[_ngcontent-%COMP%], .filter-count[_ngcontent-%COMP%]{display:-ms-flexbox;display:flex}.current-filters[_ngcontent-%COMP%]{width:100%}.current-filters[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{display:inherit}.current-filters[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{padding:5px;margin:auto 5px;font-size:75%}.current-filters[_ngcontent-%COMP%]   .mat-icon[_ngcontent-%COMP%]{font-size:12px;height:12px;width:12px}"]}),U),pathMatch:"full",canDeactivate:[l.a]}],V=((D=function t(){s(this,t)}).\u0275mod=k.Pb({type:D}),D.\u0275inj=k.Ob({factory:function(t){return new(t||D)},imports:[[c.j.forChild(Y)],c.j]}),D),G=((N=function t(){s(this,t)}).\u0275mod=k.Pb({type:N}),N.\u0275inj=k.Ob({factory:function(t){return new(t||N)},imports:[[r.c,V,a.a]]}),N)}}])}();