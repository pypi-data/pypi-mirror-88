(window.webpackJsonp=window.webpackJsonp||[]).push([[9,44],{"76GY":function(t,e,o){"use strict";o.d(e,"a",(function(){return P}));var n=o("w7eE"),c=o("OwvW"),i=o("qnZ9"),l=o("ykax"),s=o("8Y7J"),a=o("cUpR"),r=o("TSSN"),b=o("SVse"),u=o("iCsr"),p=o("vYAO"),d=o("j7f2"),h=o("6ako"),f=o("QUb3");function g(t,e){if(1&t&&(s.Xb(0,"os-icon-container",10),s.Sc(1),s.kc(2,"translate"),s.kc(3,"pollKeyVerbose"),s.Wb()),2&t){const t=s.jc().$implicit,e=s.jc(3);s.rc("icon",t.value[0].icon)("size",e.iconSize),s.Fb(1),s.Uc(" ",s.lc(2,3,s.lc(3,5,t.votingOption))," ")}}function m(t,e){if(1&t&&(s.Xb(0,"span"),s.Sc(1),s.kc(2,"translate"),s.kc(3,"pollKeyVerbose"),s.Wb()),2&t){const t=s.jc().$implicit;s.Fb(1),s.Uc(" ",s.lc(2,1,s.lc(3,3,t.votingOption))," ")}}function v(t,e){if(1&t&&(s.Xb(0,"span"),s.Sc(1),s.kc(2,"pollPercentBase"),s.Wb()),2&t){const t=s.jc().$implicit,e=s.jc(3);s.Fb(1),s.Uc(" ",s.nc(2,1,t.value[0].amount,e.poll,"motion")," ")}}function S(t,e){if(1&t&&(s.Xb(0,"tr"),s.Xb(1,"td"),s.Qc(2,g,4,7,"os-icon-container",8),s.Qc(3,m,4,5,"span",2),s.Wb(),s.Xb(4,"td",9),s.Qc(5,v,3,5,"span",2),s.Wb(),s.Xb(6,"td",9),s.Sc(7),s.kc(8,"parsePollNumber"),s.Wb(),s.Wb()),2&t){const t=e.$implicit;s.Hb(t.votingOption),s.Fb(2),s.rc("ngIf",t.value[0].icon),s.Fb(1),s.rc("ngIf",!t.value[0].icon),s.Fb(2),s.rc("ngIf",t.value[0].showPercent),s.Fb(2),s.Uc(" ",s.lc(8,6,t.value[0].amount)," ")}}function F(t,e){if(1&t&&(s.Vb(0),s.Xb(1,"table",3),s.Xb(2,"tbody"),s.Xb(3,"tr"),s.Sb(4,"th"),s.Xb(5,"th",4),s.Sc(6),s.kc(7,"translate"),s.Wb(),s.Wb(),s.Qc(8,S,9,8,"tr",5),s.Wb(),s.Wb(),s.Xb(9,"div",6),s.Sb(10,"os-charts",7),s.Wb(),s.Ub()),2&t){const t=s.jc(2);s.Fb(6),s.Tc(s.lc(7,4,"Votes")),s.Fb(2),s.rc("ngForOf",t.tableData)("ngForTrackBy",t.trackByIndex),s.Fb(2),s.rc("data",t.chartData)}}function k(t,e){1&t&&(s.Xb(0,"div"),s.Xb(1,"i"),s.Sc(2),s.kc(3,"translate"),s.Wb(),s.Wb()),2&t&&(s.Fb(2),s.Uc(" ",s.lc(3,1,"No results yet.")," "))}function y(t,e){1&t&&(s.Xb(0,"div"),s.Xb(1,"i"),s.Sc(2),s.kc(3,"translate"),s.Wb(),s.Wb()),2&t&&(s.Fb(2),s.Uc(" ",s.lc(3,1,"Counting of votes is in progress ...")," "))}function W(t,e){if(1&t&&(s.Xb(0,"div",1),s.Qc(1,F,11,6,"ng-container",2),s.Qc(2,k,4,3,"div",2),s.Qc(3,y,4,3,"div",2),s.Wb()),2&t){const t=s.jc();s.Fb(1),s.rc("ngIf",t.hasResults&&t.canSeeResults),s.Fb(1),s.rc("ngIf",!t.hasResults),s.Fb(1),s.rc("ngIf",t.hasResults&&!t.canSeeResults)}}let P=(()=>{class t extends n.a{constructor(t,e,o,n,c){super(t,e),this.pollService=o,this.cd=n,this.operator=c,this.iconSize="large"}set poll(t){this._poll=t,this.setTableData(),this.setChartData(),this.cd.markForCheck()}get poll(){return this._poll}get state(){return this.poll.state}get hasResults(){return this.isFinished||this.isPublished}get isFinished(){return this.state===i.e.Finished}get isPublished(){return this.state===i.e.Published}get canSeeResults(){return this.operator.hasPerms(this.permission.motionsCanManagePolls)||this.isPublished}setTableData(){this.tableData=this.pollService.generateTableData(this.poll)}setChartData(){this.chartData=this.pollService.generateChartData(this.poll)}}return t.\u0275fac=function(e){return new(e||t)(s.Rb(a.c),s.Rb(r.k),s.Rb(l.a),s.Rb(s.h),s.Rb(c.a))},t.\u0275cmp=s.Lb({type:t,selectors:[["os-motion-poll-detail-content"]],inputs:{poll:"poll",iconSize:"iconSize"},features:[s.Cb],decls:1,vars:1,consts:[["class","result-wrapper",4,"ngIf"],[1,"result-wrapper"],[4,"ngIf"],[1,"result-table"],["colspan","2"],[3,"class",4,"ngFor","ngForOf","ngForTrackBy"],[1,"doughnut-chart"],["type","doughnut",3,"data"],[3,"icon","size",4,"ngIf"],[1,"result-cell-definition"],[3,"icon","size"]],template:function(t,e){1&t&&s.Qc(0,W,4,3,"div",0),2&t&&s.rc("ngIf",e.poll)},directives:[b.t,b.s,u.a,p.a],pipes:[r.j,d.a,h.a,f.a],styles:[".yes[_ngcontent-%COMP%]{color:#4caf50}.no[_ngcontent-%COMP%]{color:#cc6c5b}.abstain[_ngcontent-%COMP%]{color:#a6a6a6}.voted-yes[_ngcontent-%COMP%]{background-color:#4caf50;color:#fff}.voted-no[_ngcontent-%COMP%]{background-color:#cc6c5b;color:#fff}.voted-abstain[_ngcontent-%COMP%]{background-color:#a6a6a6;color:#fff}.start-poll-button[_ngcontent-%COMP%]{color:#4caf50}.stop-poll-button[_ngcontent-%COMP%]{color:#ff5252}.publish-poll-button[_ngcontent-%COMP%]{color:#e6b100}.result-wrapper[_ngcontent-%COMP%]{display:grid;grid-gap:2em;margin:2em;grid-template-columns:repeat(auto-fit,minmax(150px,1fr))}.result-wrapper[_ngcontent-%COMP%]   .result-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{text-align:right;font-weight:400}.result-wrapper[_ngcontent-%COMP%]   .result-table[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]{height:48px;border-bottom:none!important}.result-wrapper[_ngcontent-%COMP%]   .result-table[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   .result-cell-definition[_ngcontent-%COMP%]{text-align:right}.result-wrapper[_ngcontent-%COMP%]   .doughnut-chart[_ngcontent-%COMP%]{display:block}"],changeDetection:0}),t})()},DNKu:function(t,e,o){"use strict";o.d(e,"a",(function(){return r}));var n=o("mrSG"),c=o("TG9O"),i=o("qnZ9"),l=o("Izkr"),s=o("8Y7J"),a=o("iELJ");let r=(()=>{class t{constructor(t,e){this.dialog=t,this.mapper=e}openDialog(t){return Object(n.a)(this,void 0,void 0,(function*(){const e=this.dialog.open(this.dialogComponent,Object.assign({data:t},l.c)),o=yield e.afterClosed().toPromise();if(o){const e=this.mapper.getRepository(t.collectionString);if(t.poll){let n=o;t.state!==i.e.Created&&(n={title:o.title,onehundred_percent_base:o.onehundred_percent_base,majority_method:o.majority_method,description:o.description},t.type===i.f.Analog&&(n=Object.assign(Object.assign({},n),{votes:o.votes,publish_immediately:o.publish_immediately}))),yield e.patch(n,t)}else yield e.create(o)}}))}}return t.\u0275fac=function(e){return new(e||t)(s.bc(a.b),s.bc(c.a))},t.\u0275prov=s.Nb({token:t,factory:t.\u0275fac,providedIn:"root"}),t})()},SHqy:function(t,e,o){"use strict";o.d(e,"a",(function(){return a}));var n=o("TG9O"),c=o("DNKu"),i=o("cMzF"),l=o("8Y7J"),s=o("iELJ");let a=(()=>{class t extends c.a{constructor(t,e){super(t,e),this.dialogComponent=i.a}}return t.\u0275fac=function(e){return new(e||t)(l.bc(s.b),l.bc(n.a))},t.\u0275prov=l.Nb({token:t,factory:t.\u0275fac,providedIn:"root"}),t})()},bVYn:function(t,e,o){"use strict";o.r(e),o.d(e,"PollsModule",(function(){return M}));var n=o("SVse"),c=o("iInd"),i=o("AqIO"),l=o("M0z7"),s=o("wL0i"),a=o("D/ll"),r=o("+8Rz"),b=o("qnZ9"),u=o("8Y7J"),p=o("TSSN");let d=(()=>{class t extends r.a{constructor(t,e,o){super(t,e),this.translate=o,this.storageKey="PollList"}preFilter(t){return t.filter(t=>!t.isAnalog)}getFilterDefinitions(){return[{property:"state",label:this.translate.instant("State"),options:[{condition:b.e.Created,label:this.translate.instant("created")},{condition:b.e.Started,label:this.translate.instant("started")},{condition:b.e.Finished,label:this.translate.instant("finished (unpublished)")},{condition:b.e.Published,label:this.translate.instant("published")}]},{property:"hasVote",label:this.translate.instant("Votings"),options:[{condition:!1,label:this.translate.instant("Voting is currently in progress.")},{condition:!0,label:this.translate.instant("You have already voted.")}]}]}}return t.\u0275fac=function(e){return new(e||t)(u.bc(i.a),u.bc(a.a),u.bc(p.k))},t.\u0275prov=u.Nb({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();var h=o("PoOO"),f=o("cUpR"),g=o("zHaW"),m=o("mksl"),v=o("0Obk"),S=o("4LpT"),F=o("Tj54"),k=o("ZFy/");function y(t,e){if(1&t&&u.Sb(0,"a",5),2&t){const t=u.jc().row;u.rc("routerLink",t.parentLink)}}function W(t,e){if(1&t&&(u.Xb(0,"div",3),u.Qc(1,y,1,1,"a",4),u.Xb(2,"span"),u.Sc(3),u.Wb(),u.Wb()),2&t){const t=e.row,o=u.jc();u.Fb(1),u.rc("ngIf",!o.isMultiSelect),u.Fb(2),u.Tc(t.title)}}function P(t,e){if(1&t&&u.Sb(0,"a",5),2&t){const t=u.jc().row;u.rc("routerLink",t.parentLink)}}function w(t,e){if(1&t&&(u.Xb(0,"div",3),u.Qc(1,P,1,1,"a",4),u.Xb(2,"span"),u.Sc(3),u.Wb(),u.Wb()),2&t){const t=e.row,o=u.jc();u.Fb(1),u.rc("ngIf",!o.isMultiSelect),u.Fb(2),u.Tc(t.getContentObject().getListTitle())}}function X(t,e){if(1&t&&u.Sb(0,"a",5),2&t){const t=u.jc().row;u.rc("routerLink",t.parentLink)}}function j(t,e){if(1&t&&(u.Xb(0,"div",3),u.Qc(1,X,1,1,"a",4),u.Xb(2,"span"),u.Sc(3),u.kc(4,"translate"),u.Wb(),u.Wb()),2&t){const t=e.row,o=u.jc();u.Fb(1),u.rc("ngIf",!o.isMultiSelect),u.Fb(2),u.Tc(u.lc(4,2,t.stateVerbose))}}function O(t,e){1&t&&(u.Xb(0,"mat-icon",8),u.kc(1,"translate"),u.Sc(2," check_circle "),u.Wb()),2&t&&u.sc("matTooltip",u.lc(1,1,"You have already voted."))}function C(t,e){1&t&&(u.Xb(0,"mat-icon",9),u.kc(1,"translate"),u.Sc(2," warning "),u.Wb()),2&t&&u.sc("matTooltip",u.lc(1,1,"Voting is currently in progress."))}function D(t,e){if(1&t&&(u.Xb(0,"div",3),u.Qc(1,O,3,3,"mat-icon",6),u.Qc(2,C,3,3,"mat-icon",7),u.Wb()),2&t){const t=e.row;u.Fb(1),u.rc("ngIf",t.hasVote),u.Fb(1),u.rc("ngIf",!t.hasVote&&null!==t.hasVote)}}const V=[{path:"",component:(()=>{class t extends s.a{constructor(t,e,o,n,c,i,l){super(c,i,l,n),this.polls=t,this.filterService=e,this.votingService=o,this.storage=n,this.tableColumnDefinition=[{prop:"title",width:"auto"},{prop:"classType",width:"auto"},{prop:"state",width:"auto"},{prop:"votability",width:"25px"}],this.filterProps=["title","state"],super.setTitle("List of electronic votes")}}return t.\u0275fac=function(e){return new(e||t)(u.Rb(h.a),u.Rb(d),u.Rb(l.b),u.Rb(i.a),u.Rb(f.c),u.Rb(p.k),u.Rb(g.a))},t.\u0275cmp=u.Lb({type:t,selectors:[["os-poll-list"]],features:[u.Cb],decls:9,vars:12,consts:[[1,"title-slot"],["listStorageKey","polls",3,"listObservableProvider","vScrollFixed","columns","filterProps","filterService"],["class","cell-slot fill",4,"pblNgridCellDef"],[1,"cell-slot","fill"],["class","detail-link",3,"routerLink",4,"ngIf"],[1,"detail-link",3,"routerLink"],["color","accent",3,"matTooltip",4,"ngIf"],["color","warn",3,"matTooltip",4,"ngIf"],["color","accent",3,"matTooltip"],["color","warn",3,"matTooltip"]],template:function(t,e){1&t&&(u.Xb(0,"os-head-bar"),u.Xb(1,"div",0),u.Sc(2),u.kc(3,"translate"),u.Wb(),u.Wb(),u.Xb(4,"os-list-view-table",1),u.Qc(5,W,4,2,"div",2),u.Qc(6,w,4,2,"div",2),u.Qc(7,j,5,4,"div",2),u.Qc(8,D,3,2,"div",2),u.Wb()),2&t&&(u.Fb(2),u.Tc(u.lc(3,10,"List of electronic votes")),u.Fb(2),u.rc("listObservableProvider",e.polls)("vScrollFixed",64)("columns",e.tableColumnDefinition)("filterProps",e.filterProps)("filterService",e.filterService),u.Fb(1),u.rc("pblNgridCellDef","title"),u.Fb(1),u.rc("pblNgridCellDef","classType"),u.Fb(1),u.rc("pblNgridCellDef","state"),u.Fb(1),u.rc("pblNgridCellDef","votability"))},directives:[m.a,v.a,S.b,n.t,c.i,F.a,k.c],pipes:[p.j],styles:[""]}),t})(),pathMatch:"full"}];let T=(()=>{class t{}return t.\u0275mod=u.Pb({type:t}),t.\u0275inj=u.Ob({factory:function(e){return new(e||t)},imports:[[c.j.forChild(V)],c.j]}),t})();var R=o("PCNd");let M=(()=>{class t{}return t.\u0275mod=u.Pb({type:t}),t.\u0275inj=u.Ob({factory:function(e){return new(e||t)},imports:[[n.c,T,R.a]]}),t})()},cMzF:function(t,e,o){"use strict";o.d(e,"a",(function(){return W}));var n=o("s7LF"),c=o("iELJ"),i=o("qnZ9"),l=o("ykax"),s=o("b1ae"),a=o("5NaA"),r=o("8fOK"),b=o("8Y7J"),u=o("cUpR"),p=o("TSSN"),d=o("zHaW"),h=o("SVse"),f=o("Dxy4"),g=o("acT5"),m=o("pMoy"),v=o("Q2Ze");const S=["pollForm"];function F(t,e){1&t&&(b.Xb(0,"mat-error"),b.Sc(1),b.kc(2,"translate"),b.Wb()),2&t&&(b.Fb(1),b.Uc(" ",b.lc(2,1,"Error in form field."),""))}function k(t,e){if(1&t){const t=b.Yb();b.Xb(0,"div"),b.Xb(1,"mat-checkbox",14),b.fc("ngModelChange",(function(e){return b.Gc(t),b.jc(2).publishImmediately=e}))("change",(function(e){return b.Gc(t),b.jc(2).publishStateChanged(e.checked)})),b.Xb(2,"span"),b.Sc(3),b.kc(4,"translate"),b.Wb(),b.Wb(),b.Qc(5,F,3,3,"mat-error",2),b.Wb()}if(2&t){const t=b.jc(2);b.Fb(1),b.rc("ngModel",t.publishImmediately),b.Fb(2),b.Tc(b.lc(4,3,"Publish immediately")),b.Fb(2),b.rc("ngIf",!t.dialogVoteForm.valid)}}function y(t,e){if(1&t&&(b.Vb(0),b.Xb(1,"div",6),b.Xb(2,"form",7),b.Sb(3,"os-check-input",8),b.kc(4,"translate"),b.kc(5,"translate"),b.Sb(6,"os-check-input",9),b.kc(7,"translate"),b.kc(8,"translate"),b.Sb(9,"os-check-input",10),b.kc(10,"translate"),b.kc(11,"translate"),b.Sb(12,"os-check-input",11),b.kc(13,"translate"),b.Sb(14,"os-check-input",12),b.kc(15,"translate"),b.Sb(16,"os-check-input",13),b.kc(17,"translate"),b.Wb(),b.Wb(),b.Qc(18,k,6,5,"div",2),b.Ub()),2&t){const t=b.jc();b.Fb(2),b.rc("formGroup",t.dialogVoteForm),b.Fb(1),b.rc("placeholder",b.lc(4,14,"Yes"))("checkboxValue",-1)("checkboxLabel",b.lc(5,16,"majority")),b.Fb(3),b.rc("placeholder",b.lc(7,18,"No"))("checkboxValue",-1)("checkboxLabel",b.lc(8,20,"majority")),b.Fb(3),b.rc("placeholder",b.lc(10,22,"Abstain"))("checkboxValue",-1)("checkboxLabel",b.lc(11,24,"majority")),b.Fb(3),b.rc("placeholder",b.lc(13,26,"Valid votes")),b.Fb(2),b.rc("placeholder",b.lc(15,28,"Invalid votes")),b.Fb(2),b.rc("placeholder",b.lc(17,30,"Total votes cast")),b.Fb(2),b.rc("ngIf",!t.pollData.isPublished)}}let W=(()=>{class t extends s.a{constructor(t,e,o,n,c,i,l){super(t,e,o,c),this.motionPollService=n,this.dialogRef=c,this.formBuilder=i,this.pollData=l,this.PercentBaseVerbose=r.b}ngOnInit(){this.createDialog()}updateDialogVoteForm(t){if(this.dialogVoteForm){const e=this.undoReplaceEmptyValues({Y:t.options[0].yes,N:t.options[0].no,A:t.options[0].abstain,votesvalid:t.votesvalid,votesinvalid:t.votesinvalid,votescast:t.votescast});this.dialogVoteForm.setValue(e)}}createDialog(){this.dialogVoteForm=this.formBuilder.group({Y:["",[n.H.min(i.b)]],N:["",[n.H.min(i.b)]],A:["",[n.H.min(i.b)]],votesvalid:["",[n.H.min(i.b)]],votesinvalid:["",[n.H.min(i.b)]],votescast:["",[n.H.min(i.b)]]}),this.pollData&&this.pollData.poll&&this.updateDialogVoteForm(this.pollData)}}return t.\u0275fac=function(e){return new(e||t)(b.Rb(u.c),b.Rb(p.k),b.Rb(d.a),b.Rb(l.a),b.Rb(c.h),b.Rb(n.g),b.Rb(c.a))},t.\u0275cmp=b.Lb({type:t,selectors:[["os-motion-poll-dialog"]],viewQuery:function(t,e){var o;1&t&&b.Yc(S,!0),2&t&&b.Bc(o=b.gc())&&(e.pollForm=o.first)},features:[b.Cb],decls:12,vars:12,consts:[[3,"data","pollService","percentBases"],["pollForm",""],[4,"ngIf"],["mat-dialog-actions",""],["mat-button","",3,"disabled","click"],["mat-button","",3,"mat-dialog-close"],["mat-dialog-content","",1,"os-form-card-mobile"],[3,"formGroup"],["inputType","number","formControlName","Y",3,"placeholder","checkboxValue","checkboxLabel"],["inputType","number","formControlName","N",3,"placeholder","checkboxValue","checkboxLabel"],["inputType","number","formControlName","A",3,"placeholder","checkboxValue","checkboxLabel"],["inputType","number","formControlName","votesvalid",3,"placeholder"],["inputType","number","formControlName","votesinvalid",3,"placeholder"],["inputType","number","formControlName","votescast",3,"placeholder"],[3,"ngModel","ngModelChange","change"]],template:function(t,e){if(1&t&&(b.Sb(0,"os-poll-form",0,1),b.Qc(2,y,19,32,"ng-container",2),b.Xb(3,"div",3),b.Xb(4,"button",4),b.fc("click",(function(){return e.submitPoll()})),b.Xb(5,"span"),b.Sc(6),b.kc(7,"translate"),b.Wb(),b.Wb(),b.Xb(8,"button",5),b.Xb(9,"span"),b.Sc(10),b.kc(11,"translate"),b.Wb(),b.Wb(),b.Wb()),2&t){const t=b.Cc(1);b.rc("data",e.pollData)("pollService",e.motionPollService)("percentBases",e.PercentBaseVerbose),b.Fb(2),b.rc("ngIf","analog"===t.contentForm.get("type").value),b.Fb(2),b.rc("disabled",t.contentForm.invalid||e.dialogVoteForm.invalid),b.Fb(2),b.Tc(b.lc(7,8,"Save")),b.Fb(2),b.rc("mat-dialog-close",!1),b.Fb(2),b.Tc(b.lc(11,10,"Cancel"))}},directives:[a.a,h.t,c.c,f.b,c.d,c.f,n.J,n.u,n.l,g.a,n.t,n.j,m.a,n.w,v.b],pipes:[p.j],styles:[""]}),t})()},g4jF:function(t,e,o){"use strict";o.d(e,"a",(function(){return b}));var n=o("mrSG"),c=o("Cfvw"),i=o("pLZG"),l=o("lJxs"),s=(o("OwvW"),o("g96W")),a=(o("iN2a"),o("R+Vs"),o("DNKu"),o("F48D"),o("mV3u")),r=(o("0NHH"),o("8Y7J"));let b=(()=>{class t extends a.a{constructor(t,e,o,n,c,i,l,a,r,b,u,p){super(t,e,o),this.translate=e,this.repo=n,this.route=c,this.groupRepo=i,this.promptService=l,this.pollDialog=a,this.pollService=r,this.votesRepo=b,this.operator=u,this.cd=p,this.userGroups=[],this.groupObservable=null,this.voteOptionStyle={Y:{css:"yes",icon:"thumb_up"},N:{css:"no",icon:"thumb_down"},A:{css:"abstain",icon:"trip_origin"}},this.poll=null,this.labels=[],this.optionsLoaded=new s.a,this.setup()}setup(){return Object(n.a)(this,void 0,void 0,(function*(){yield this.optionsLoaded,this.votesRepo.getViewModelListObservable().pipe(Object(i.a)(()=>this.poll&&this.canSeeVotes),Object(l.a)(t=>t.filter(t=>t.option.poll_id===this.poll.id)),Object(i.a)(t=>!!t.length)).subscribe(()=>{this.createVotesData()})}))}ngOnInit(){this.findComponentById(),this.groupObservable=this.groupRepo.getViewModelListObservable(),this.subscriptions.push(this.groupRepo.getViewModelListObservable().subscribe(t=>this.userGroups=t))}deletePoll(){return Object(n.a)(this,void 0,void 0,(function*(){const t=this.translate.instant("Are you sure you want to delete this vote?");(yield this.promptService.open(t))&&this.repo.delete(this.poll).then(()=>this.onDeleted(),this.raiseError)}))}pseudoanonymizePoll(){return Object(n.a)(this,void 0,void 0,(function*(){const t=this.translate.instant("Are you sure you want to anonymize all votes? This cannot be undone.");(yield this.promptService.open(t))&&this.repo.pseudoanonymize(this.poll).catch(this.raiseError)}))}openDialog(t){this.pollDialog.openDialog(t)}onStateChanged(){}get canSeeVotes(){return this.hasPerms&&this.poll.isFinished||this.poll.isPublished}setVotesData(t){this.votesDataObservable=t.every(t=>!t.user)?null:Object(c.a)([t])}findComponentById(){const t=this.route.snapshot.params;t&&t.id&&this.subscriptions.push(this.repo.getViewModelObservable(t.id).subscribe(t=>{t&&(this.poll=t,this.createVotesData(),this.optionsLoaded.resolve(),this.cd.markForCheck())}))}userHasVoteDelegation(t){return!!t.isVoteRightDelegated||!!this.operator.viewUser.canVoteFor(t)}getUsersVoteDelegation(t){return t.voteDelegatedTo?t.voteDelegatedTo:this.operator.viewUser.canVoteFor(t)?this.operator.viewUser:void 0}}return t.\u0275fac=function(t){r.ec()},t.\u0275dir=r.Mb({type:t,features:[r.Cb]}),t})()},tSYa:function(t,e,o){"use strict";o.r(e),o.d(e,"MotionPollModule",(function(){return nt}));var n=o("SVse"),c=o("PCNd"),i=o("bVYn"),l=o("iInd"),s=o("OwvW"),a=o("acQf"),r=o("chQs"),b=o("R+Vs"),u=o("+KbT"),p=o("F48D"),d=o("SHqy"),h=o("ykax"),f=o("g4jF"),g=o("8Y7J"),m=o("cUpR"),v=o("TSSN"),S=o("zHaW"),F=o("mksl"),k=o("3Xi6"),y=o("PDjf"),W=o("rJgo"),P=o("BSbQ"),w=o("Dxy4"),X=o("Tj54"),j=o("76GY"),O=o("0Obk"),C=o("4LpT"),D=o("Tp2j");function V(t,e){if(1&t&&(g.Xb(0,"h2"),g.Sc(1),g.kc(2,"translate"),g.Wb()),2&t){const t=g.jc();g.Fb(1),g.Vc("",g.lc(2,2,"Motion")," ",t.poll.motion.identifierOrTitle,"")}}function T(t,e){if(1&t&&(g.Xb(0,"div",11),g.Xb(1,"button",12),g.Xb(2,"mat-icon"),g.Sc(3,"more_vert"),g.Wb(),g.Wb(),g.Wb()),2&t){g.jc();const t=g.Cc(9);g.Fb(1),g.rc("matMenuTriggerFor",t)}}function R(t,e){if(1&t&&(g.Xb(0,"span"),g.Sc(1),g.kc(2,"translate"),g.Wb()),2&t){const t=g.jc(3);g.Fb(1),g.Uc(" ",g.lc(2,1,t.poll.typeVerbose)," \xb7 ")}}function M(t,e){if(1&t&&(g.Xb(0,"div"),g.Sc(1),g.kc(2,"translate"),g.Wb()),2&t){const t=e.col;g.Fb(1),g.Uc(" ",g.lc(2,1,t.label)," ")}}function _(t,e){if(1&t&&(g.Xb(0,"div"),g.Sc(1),g.Wb()),2&t){const t=g.jc(2).row;g.Fb(1),g.Uc(" ",t.user.getLevelAndNumber()," ")}}function I(t,e){if(1&t&&(g.Xb(0,"div"),g.Sc(1),g.kc(2,"translate"),g.Wb()),2&t){const t=g.jc(2).row;g.Fb(1),g.Vc(" ",g.lc(2,2,"Vote weight"),": ",t.user.vote_weight," ")}}function x(t,e){if(1&t&&(g.Xb(0,"div"),g.Xb(1,"span"),g.Sc(2),g.kc(3,"translate"),g.Wb(),g.Wb()),2&t){const t=g.jc(2).row,e=g.jc(5);g.Fb(2),g.Vc(" (",g.lc(3,2,"represented by")," ",e.getUsersVoteDelegation(t.user).getShortName().trim(),") ")}}function Q(t,e){if(1&t&&(g.Xb(0,"div"),g.Sc(1),g.Xb(2,"div",22),g.Qc(3,_,2,1,"div",2),g.Qc(4,I,3,4,"div",2),g.Qc(5,x,4,4,"div",2),g.Wb(),g.Wb()),2&t){const t=g.jc().row,e=g.jc(5);g.Fb(1),g.Uc(" ",t.user.getShortName()," "),g.Fb(2),g.rc("ngIf",t.user.getLevelAndNumber()),g.Fb(1),g.rc("ngIf",e.isVoteWeightActive),g.Fb(1),g.rc("ngIf",e.userHasVoteDelegation(t.user))}}function N(t,e){1&t&&(g.Xb(0,"div"),g.Sc(1),g.kc(2,"translate"),g.Wb()),2&t&&(g.Fb(1),g.Tc(g.lc(2,1,"Anonymous")))}function L(t,e){if(1&t&&(g.Xb(0,"div"),g.Qc(1,Q,6,4,"div",2),g.Qc(2,N,3,3,"div",2),g.Wb()),2&t){const t=e.row;g.Fb(1),g.rc("ngIf",t.user),g.Fb(1),g.rc("ngIf",!t.user)}}function U(t,e){if(1&t&&(g.Xb(0,"div",23),g.Xb(1,"div",24),g.Xb(2,"mat-icon"),g.Sc(3),g.Wb(),g.Wb(),g.Xb(4,"div"),g.Sc(5),g.kc(6,"translate"),g.Wb(),g.Wb()),2&t){const t=e.row,o=g.jc(5);g.Fb(1),g.rc("ngClass",o.voteOptionStyle[t.value].css),g.Fb(2),g.Tc(o.voteOptionStyle[t.value].icon),g.Fb(2),g.Tc(g.lc(6,3,t.valueVerbose))}}function Y(t,e){if(1&t&&(g.Xb(0,"os-list-view-table",18),g.Qc(1,M,3,3,"div",19),g.Qc(2,L,3,2,"div",20),g.Qc(3,U,7,5,"div",21),g.Wb()),2&t){const t=g.jc(4);g.rc("listObservable",t.votesDataObservable)("columns",t.columnDefinition)("filterProps",t.filterProps)("allowProjector",!1)("fullScreen",!0)("vScrollFixed",-1),g.Fb(1),g.rc("pblNgridHeaderCellDef","*"),g.Fb(1),g.rc("pblNgridCellDef","user"),g.Fb(1),g.rc("pblNgridCellDef","vote")}}function A(t,e){1&t&&(g.Xb(0,"div"),g.Sc(1),g.kc(2,"translate"),g.Wb()),2&t&&(g.Fb(1),g.Uc(" ",g.lc(2,1,"The individual votes were anonymized.")," "))}function z(t,e){if(1&t&&(g.Xb(0,"div",16),g.Xb(1,"h2"),g.Sc(2),g.kc(3,"translate"),g.Wb(),g.Qc(4,Y,4,9,"os-list-view-table",17),g.Qc(5,A,3,3,"div",2),g.Wb()),2&t){const t=g.jc(3);g.Fb(2),g.Tc(g.lc(3,3,"Single votes")),g.Fb(2),g.rc("ngIf",t.votesDataObservable),g.Fb(1),g.rc("ngIf",!t.votesDataObservable)}}function B(t,e){1&t&&(g.Xb(0,"span"),g.Sc(1,", "),g.Wb())}function H(t,e){if(1&t&&(g.Xb(0,"span"),g.Sc(1),g.kc(2,"translate"),g.Qc(3,B,2,0,"span",2),g.Wb()),2&t){const t=e.$implicit,o=e.index,n=g.jc(4);g.Fb(1),g.Uc(" ",g.lc(2,2,t.getTitle()),""),g.Fb(2),g.rc("ngIf",o<n.poll.groups.length-1)}}function G(t,e){if(1&t&&(g.Xb(0,"small"),g.Sc(1),g.kc(2,"translate"),g.Qc(3,H,4,4,"span",25),g.Wb()),2&t){const t=g.jc(3);g.Fb(1),g.Uc(" ",g.lc(2,2,"Groups"),": "),g.Fb(2),g.rc("ngForOf",t.poll.groups)}}function J(t,e){if(1&t&&(g.Vb(0),g.Xb(1,"h1"),g.Sc(2),g.kc(3,"translate"),g.Wb(),g.Xb(4,"div"),g.Qc(5,R,3,3,"span",2),g.Xb(6,"span"),g.Sc(7),g.kc(8,"translate"),g.Wb(),g.Wb(),g.Sb(9,"os-motion-poll-detail-content",13),g.Qc(10,z,6,5,"div",14),g.Xb(11,"div",15),g.Qc(12,G,4,4,"small",2),g.Xb(13,"small"),g.Sc(14),g.kc(15,"translate"),g.kc(16,"translate"),g.Wb(),g.Wb(),g.Ub()),2&t){const t=g.jc(2);g.Fb(2),g.Tc(g.lc(3,8,t.poll.title)),g.Fb(3),g.rc("ngIf","analog"!==t.poll.type),g.Fb(2),g.Uc(" ",g.lc(8,10,t.poll.stateVerbose)," "),g.Fb(2),g.rc("poll",t.poll),g.Fb(1),g.rc("ngIf",t.showResults&&t.poll.stateHasVotes&&"named"===t.poll.type),g.Fb(2),g.rc("ngIf",t.poll.groups&&t.poll.type&&"analog"!==t.poll.type),g.Fb(2),g.Vc("",g.lc(15,12,"100% base"),": ",g.lc(16,14,t.poll.percentBaseVerbose),"")}}function K(t,e){if(1&t&&g.Qc(0,J,17,16,"ng-container",2),2&t){const t=g.jc();g.rc("ngIf",t.poll)}}function E(t,e){if(1&t&&g.Sb(0,"os-projector-button",26),2&t){const t=g.jc();g.rc("menuItem",!0)("object",t.poll)}}function q(t,e){if(1&t){const t=g.Yb();g.Xb(0,"button",27),g.fc("click",(function(){g.Gc(t);const e=g.jc();return e.openDialog(e.poll)})),g.Xb(1,"mat-icon"),g.Sc(2,"edit"),g.Wb(),g.Xb(3,"span"),g.Sc(4),g.kc(5,"translate"),g.Wb(),g.Wb()}2&t&&(g.Fb(4),g.Tc(g.lc(5,1,"Edit")))}function Z(t,e){if(1&t){const t=g.Yb();g.Xb(0,"button",27),g.fc("click",(function(){return g.Gc(t),g.jc().pseudoanonymizePoll()})),g.Xb(1,"mat-icon"),g.Sc(2,"warning"),g.Wb(),g.Xb(3,"span"),g.Sc(4),g.kc(5,"translate"),g.Wb(),g.Wb()}2&t&&(g.Fb(4),g.Tc(g.lc(5,1,"Anonymize votes")))}function $(t,e){if(1&t){const t=g.Yb();g.Xb(0,"button",27),g.fc("click",(function(){return g.Gc(t),g.jc().deletePoll()})),g.Xb(1,"mat-icon",28),g.Sc(2,"delete"),g.Wb(),g.Xb(3,"span"),g.Sc(4),g.kc(5,"translate"),g.Wb(),g.Wb()}2&t&&(g.Fb(4),g.Tc(g.lc(5,1,"Delete")))}let tt=(()=>{class t extends f.a{constructor(t,e,o,n,c,i,l,s,a,r,b,u,p,d){super(t,e,o,n,c,i,l,s,a,r,u,d),this.operator=u,this.router=p,this.cd=d,this.columnDefinition=[{prop:"user",width:"auto",label:"Participant"},{prop:"vote",width:"auto",label:"Vote"}],this.filterProps=["user.getFullName","valueVerbose"],b.get("users_activate_vote_weight").subscribe(t=>this.isVoteWeightActive=t)}get showResults(){return this.hasPerms()||this.poll.isPublished}createVotesData(){this.setVotesData(this.poll.options[0].votes)}openDialog(){this.pollDialog.openDialog(this.poll)}onDeleted(){this.router.navigate(["motions",this.poll.motion_id])}hasPerms(){return this.operator.hasPerms(s.b.motionsCanManagePolls)}}return t.\u0275fac=function(e){return new(e||t)(g.Rb(m.c),g.Rb(v.k),g.Rb(S.a),g.Rb(a.a),g.Rb(l.a),g.Rb(b.a),g.Rb(p.a),g.Rb(d.a),g.Rb(h.a),g.Rb(r.a),g.Rb(u.a),g.Rb(s.a),g.Rb(l.f),g.Rb(g.h))},t.\u0275cmp=g.Lb({type:t,selectors:[["os-motion-poll-detail"]],features:[g.Cb],decls:15,vars:10,consts:[[3,"goBack","nav"],[1,"title-slot"],[4,"ngIf"],["class","menu-slot",4,"osPerms"],[1,"os-card","spacer-bottom-60"],[3,"ngTemplateOutlet"],["viewTemplate",""],["pollDetailMenu","matMenu"],[3,"menuItem","object",4,"osPerms"],["mat-menu-item","",3,"click",4,"osPerms"],["mat-menu-item","",3,"click",4,"osPerms","osPermsAnd"],[1,"menu-slot"],["type","button","mat-icon-button","",3,"matMenuTriggerFor"],[3,"poll"],["class","named-result-table",4,"ngIf"],[1,"poll-content"],[1,"named-result-table"],["class","single-votes-table","listStorageKey","motion-poll-vote",3,"listObservable","columns","filterProps","allowProjector","fullScreen","vScrollFixed",4,"ngIf"],["listStorageKey","motion-poll-vote",1,"single-votes-table",3,"listObservable","columns","filterProps","allowProjector","fullScreen","vScrollFixed"],[4,"pblNgridHeaderCellDef"],[4,"pblNgridCellDef"],["class","vote-cell",4,"pblNgridCellDef"],[1,"user-subtitle"],[1,"vote-cell"],[1,"vote-cell-icon-container",3,"ngClass"],[4,"ngFor","ngForOf"],[3,"menuItem","object"],["mat-menu-item","",3,"click"],["color","warn"]],template:function(t,e){if(1&t&&(g.Xb(0,"os-head-bar",0),g.Xb(1,"div",1),g.Qc(2,V,3,4,"h2",2),g.Wb(),g.Qc(3,T,4,1,"div",3),g.Wb(),g.Xb(4,"mat-card",4),g.Tb(5,5),g.Wb(),g.Qc(6,K,1,1,"ng-template",null,6,g.Rc),g.Xb(8,"mat-menu",null,7),g.Qc(10,E,1,2,"os-projector-button",8),g.Qc(11,q,6,3,"button",9),g.Qc(12,Z,6,3,"button",10),g.Sb(13,"mat-divider"),g.Qc(14,$,6,3,"button",9),g.Wb()),2&t){const t=g.Cc(7);g.rc("goBack",!0)("nav",!1),g.Fb(2),g.rc("ngIf",e.poll),g.Fb(1),g.rc("osPerms","motions.can_manage_polls"),g.Fb(2),g.rc("ngTemplateOutlet",t),g.Fb(5),g.rc("osPerms","core.can_manage_projector"),g.Fb(1),g.rc("osPerms","motions.can_manage_polls"),g.Fb(1),g.rc("osPerms","motions.can_manage_polls")("osPermsAnd",e.poll&&"named"===e.poll.type),g.Fb(2),g.rc("osPerms","motions.can_manage_polls")}},directives:[F.a,n.t,k.a,y.a,n.A,W.f,P.a,w.b,W.e,X.a,j.a,O.a,C.g,C.b,n.q,n.s,D.a,W.c],pipes:[v.j],styles:[".yes{color:#4caf50}.no{color:#cc6c5b}.abstain{color:#a6a6a6}.voted-yes{background-color:#4caf50;color:#fff}.voted-no{background-color:#cc6c5b;color:#fff}.voted-abstain{background-color:#a6a6a6;color:#fff}.start-poll-button{color:#4caf50}.stop-poll-button{color:#ff5252}.publish-poll-button{color:#e6b100}.poll-content{text-align:right;display:grid;padding-top:20px}.named-result-table{grid-area:names}.named-result-table .mat-form-field{font-size:14px;width:100%}.named-result-table .vote-cell,.named-result-table .vote-cell .vote-cell-icon-container{display:-ms-flexbox;display:flex;-ms-flex-align:center;align-items:center}.named-result-table .vote-cell .vote-cell-icon-container{margin-right:7px}.single-votes-table{display:block;height:500px}.single-votes-table .list-view-frame{height:100%}.openslides-theme .pbl-ngrid-no-data{top:10%}"],encapsulation:2,changeDetection:0}),t})();const et=[{path:"new",component:tt},{path:":id",component:tt}];let ot=(()=>{class t{}return t.\u0275mod=g.Pb({type:t}),t.\u0275inj=g.Ob({factory:function(e){return new(e||t)},imports:[[l.j.forChild(et)],l.j]}),t})(),nt=(()=>{class t{}return t.\u0275mod=g.Pb({type:t}),t.\u0275inj=g.Ob({factory:function(e){return new(e||t)},imports:[[n.c,c.a,ot,i.PollsModule]]}),t})()},wL0i:function(t,e,o){"use strict";o.d(e,"a",(function(){return c}));var n=o("mV3u");class c extends n.a{constructor(t,e,o,n){super(t,e,o),this.storage=n,this.canMultiSelect=!1,this._multiSelectMode=!1,this.singleButtonWidth="40px",this.badgeButtonWidth="45px",this.selectedRows=[]}onDataSourceChange(t){this.dataSource=t}toggleMultiSelect(){!this.canMultiSelect||this.isMultiSelect?(this._multiSelectMode=!1,this.deselectAll()):this._multiSelectMode=!0}selectAll(){this.dataSource.selection.select(...this.dataSource.filteredData)}deselectAll(){this.dataSource&&this.dataSource.selection.clear()}get isMultiSelect(){return this._multiSelectMode}}}}]);