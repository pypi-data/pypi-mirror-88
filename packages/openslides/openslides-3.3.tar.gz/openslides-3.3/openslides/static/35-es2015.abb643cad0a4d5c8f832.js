(window.webpackJsonp=window.webpackJsonp||[]).push([[35,42],{F48D:function(t,e,n){"use strict";n.d(e,"a",(function(){return l}));var c=n("mrSG"),i=n("LBBb"),o=n("8Y7J"),a=n("iELJ");let l=(()=>{class t{constructor(t){this.dialog=t}open(t,e=""){return Object(c.a)(this,void 0,void 0,(function*(){return this.dialog.open(i.a,{width:"290px",data:{title:t,content:e}}).afterClosed().toPromise()}))}}return t.\u0275fac=function(e){return new(e||t)(o.bc(a.b))},t.\u0275prov=o.Nb({token:t,factory:t.\u0275fac,providedIn:"root"}),t})()},LBBb:function(t,e,n){"use strict";n.d(e,"a",(function(){return s}));var c=n("iELJ"),i=n("8Y7J"),o=n("SVse"),a=n("Dxy4"),l=n("TSSN");function r(t,e){if(1&t&&(i.Xb(0,"div"),i.Xb(1,"h2",1),i.Sc(2),i.Wb(),i.Sb(3,"mat-dialog-content",2),i.Xb(4,"mat-dialog-actions"),i.Xb(5,"button",3),i.Sc(6),i.kc(7,"translate"),i.Wb(),i.Xb(8,"button",4),i.Sc(9),i.kc(10,"translate"),i.Wb(),i.Wb(),i.Wb()),2&t){const t=i.jc();i.Fb(2),i.Tc(t.data.title),i.Fb(1),i.rc("innerHTML",t.data.content,i.Hc),i.Fb(2),i.rc("mat-dialog-close",!0),i.Fb(1),i.Tc(i.lc(7,6,"OK")),i.Fb(2),i.rc("mat-dialog-close",!1),i.Fb(1),i.Tc(i.lc(10,8,"Cancel"))}}let s=(()=>{class t{constructor(t,e){this.dialogRef=t,this.data=e}}return t.\u0275fac=function(e){return new(e||t)(i.Rb(c.h),i.Rb(c.a))},t.\u0275cmp=i.Lb({type:t,selectors:[["os-prompt-dialog"]],decls:1,vars:1,consts:[[4,"ngIf"],["mat-dialog-title",""],[3,"innerHTML"],["mat-button","","color","warn",3,"mat-dialog-close"],["mat-button","",3,"mat-dialog-close"]],template:function(t,e){1&t&&i.Qc(0,r,11,10,"div",0),2&t&&i.rc("ngIf",e.data)},directives:[o.t,c.i,c.f,c.c,a.b,c.d],pipes:[l.j],encapsulation:2}),t})()},moyA:function(t,e,n){"use strict";n.r(e),n.d(e,"MotionWorkflowModule",(function(){return yt}));var c=n("SVse"),i=n("PCNd"),o=n("iInd"),a=n("OaSA"),l=n("lJxs"),r=n("ZvXm"),s=n("s3dr"),b=n("F48D"),m=n("gtli"),u=n("Izkr"),d=n("mV3u"),f=n("8Y7J"),g=n("cUpR"),p=n("TSSN"),h=n("zHaW"),w=n("iELJ"),k=n("mksl"),v=n("Dxy4"),W=n("Tj54"),M=n("rJgo"),C=n("pMoy"),S=n("f44v"),F=n("Q2Ze"),X=n("e6WT"),_=n("s7LF"),O=n("IZUe");const P=["workflowDialog"];function j(t,e){if(1&t&&(f.Xb(0,"h2"),f.Sc(1),f.kc(2,"translate"),f.Wb()),2&t){const t=f.jc();f.Fb(1),f.Uc(" ",f.lc(2,1,t.workflow.name)," ")}}function y(t,e){1&t&&(f.Xb(0,"th",20),f.Sc(1),f.kc(2,"translate"),f.Wb()),2&t&&(f.Fb(1),f.Tc(f.lc(2,1,"Permissions")))}function D(t,e){if(1&t&&(f.Xb(0,"td",21),f.Xb(1,"div",22),f.Sc(2),f.kc(3,"translate"),f.Wb(),f.Wb()),2&t){const t=e.$implicit;f.Fb(2),f.Uc(" ",f.lc(3,1,t.name)," ")}}function R(t,e){if(1&t){const t=f.Yb();f.Xb(0,"th",25),f.fc("click",(function(){f.Gc(t);const e=f.jc().$implicit;return f.jc(2).onClickStateName(e)})),f.Xb(1,"div",26),f.Xb(2,"div",27),f.Sc(3),f.kc(4,"translate"),f.Wb(),f.Wb(),f.Wb()}if(2&t){const t=f.jc().$implicit;f.Fb(3),f.Uc(" ",f.lc(4,1,t.name)," ")}}function x(t,e){if(1&t){const t=f.Yb();f.Xb(0,"div",27),f.Xb(1,"mat-checkbox",29),f.fc("change",(function(e){f.Gc(t);const n=f.jc().$implicit,c=f.jc().$implicit;return f.jc(2).onToggleStatePerm(c,n.selector,e)})),f.Wb(),f.Wb()}if(2&t){const t=f.jc().$implicit,e=f.jc().$implicit;f.Fb(1),f.rc("checked",e[t.selector])}}function T(t,e){if(1&t){const t=f.Yb();f.Xb(0,"div"),f.Xb(1,"div",27),f.Sc(2),f.kc(3,"translate"),f.Wb(),f.Xb(4,"div",30),f.fc("click",(function(){f.Gc(t);const e=f.jc().$implicit,n=f.jc().$implicit;return f.jc(2).onClickInputPerm(e,n)})),f.Wb(),f.Wb()}if(2&t){const t=f.jc().$implicit,e=f.jc().$implicit;f.Fb(2),f.Uc(" ",f.lc(3,1,e[t.selector])||"\u2013"," ")}}const I=function(t){return{state:t}};function Q(t,e){if(1&t&&(f.Xb(0,"div",27),f.Xb(1,"mat-basic-chip",31),f.Sc(2),f.kc(3,"translate"),f.Wb(),f.Wb()),2&t){const t=f.jc().$implicit,e=f.jc().$implicit;f.jc(2);const n=f.Cc(11);f.Fb(1),f.rc("matMenuTriggerFor",n)("matMenuTriggerData",f.xc(7,I,e))("disableRipple",!0)("ngClass",e[t.selector]),f.Fb(1),f.Uc(" ",f.lc(3,5,e[t.selector])," ")}}function E(t,e){1&t&&(f.Xb(0,"div"),f.Sc(1," - "),f.Wb())}function $(t,e){1&t&&(f.Xb(0,"span"),f.Sc(1,",\xa0"),f.Wb())}function L(t,e){if(1&t&&(f.Xb(0,"div"),f.Sc(1),f.kc(2,"translate"),f.Qc(3,$,2,0,"span",2),f.Wb()),2&t){const t=e.$implicit,n=e.last;f.Fb(1),f.Uc(" ",f.lc(2,2,t.name),""),f.Fb(2),f.rc("ngIf",!n)}}function N(t,e){if(1&t&&(f.Xb(0,"div"),f.Qc(1,L,4,4,"div",33),f.Wb()),2&t){const t=f.jc(3).$implicit;f.Fb(1),f.rc("ngForOf",t.next_states)}}function B(t,e){if(1&t&&(f.Xb(0,"div"),f.Xb(1,"div",27),f.Qc(2,E,2,0,"div",2),f.Qc(3,N,2,1,"div",2),f.Wb(),f.Sb(4,"div",32),f.Wb()),2&t){const t=f.jc(2).$implicit;f.jc(2);const e=f.Cc(14);f.Fb(2),f.rc("ngIf",!t.next_states.length),f.Fb(1),f.rc("ngIf",t.next_states.length),f.Fb(1),f.rc("matMenuTriggerFor",e)("matMenuTriggerData",f.xc(4,I,t))}}function A(t,e){if(1&t&&(f.Xb(0,"div"),f.Xb(1,"div",27),f.Sc(2),f.kc(3,"translate"),f.Wb(),f.Sb(4,"div",32),f.Wb()),2&t){const t=f.jc(2).$implicit,e=f.jc(2),n=f.Cc(20);f.Fb(2),f.Uc(" ",f.lc(3,3,e.getMergeAmendmentLabel(t.merge_amendment_into_final))," "),f.Fb(2),f.rc("matMenuTriggerFor",n)("matMenuTriggerData",f.xc(5,I,t))}}function Y(t,e){1&t&&(f.Xb(0,"div"),f.Sc(1," - "),f.Wb())}function U(t,e){1&t&&(f.Xb(0,"span"),f.Sc(1,",\xa0"),f.Wb())}function G(t,e){if(1&t&&(f.Xb(0,"div"),f.Sc(1),f.kc(2,"translate"),f.Qc(3,U,2,0,"span",2),f.Wb()),2&t){const t=e.$implicit,n=e.last,c=f.jc(6);f.Fb(1),f.Uc(" ",f.lc(2,2,c.getRestrictionLabel(t))," "),f.Fb(2),f.rc("ngIf",!n)}}function J(t,e){if(1&t&&(f.Xb(0,"div"),f.Qc(1,G,4,4,"div",33),f.Wb()),2&t){const t=f.jc(3).$implicit;f.Fb(1),f.rc("ngForOf",t.restriction)}}function H(t,e){if(1&t&&(f.Xb(0,"div"),f.Xb(1,"div",27),f.Qc(2,Y,2,0,"div",2),f.Qc(3,J,2,1,"div",2),f.Wb(),f.Sb(4,"div",32),f.Wb()),2&t){const t=f.jc(2).$implicit;f.jc(2);const e=f.Cc(17);f.Fb(2),f.rc("ngIf",!t.restriction.length),f.Fb(1),f.rc("ngIf",t.restriction.length),f.Fb(1),f.rc("matMenuTriggerFor",e)("matMenuTriggerData",f.xc(4,I,t))}}function V(t,e){if(1&t&&(f.Xb(0,"td",21),f.Qc(1,x,2,1,"div",28),f.Qc(2,T,5,3,"div",2),f.Qc(3,Q,4,9,"div",28),f.Qc(4,B,5,6,"div",2),f.Qc(5,A,5,7,"div",2),f.Qc(6,H,5,6,"div",2),f.Wb()),2&t){const t=e.$implicit;f.Fb(1),f.rc("ngIf","check"===t.type),f.Fb(1),f.rc("ngIf","input"===t.type),f.Fb(1),f.rc("ngIf","color"===t.type),f.Fb(1),f.rc("ngIf","state"===t.type),f.Fb(1),f.rc("ngIf","amendment"===t.type),f.Fb(1),f.rc("ngIf","restriction"===t.type)}}function z(t,e){if(1&t&&(f.Vb(0,23),f.Qc(1,R,5,3,"th",24),f.Qc(2,V,7,6,"td",16),f.Ub()),2&t){const t=e.$implicit,n=f.jc(2);f.rc("matColumnDef",n.getColumnDef(t))}}function q(t,e){1&t&&f.Sb(0,"tr",34)}function Z(t,e){1&t&&f.Sb(0,"tr",35)}function K(t,e){if(1&t&&(f.Xb(0,"div"),f.Xb(1,"div",11),f.Xb(2,"strong"),f.Xb(3,"span"),f.Sc(4),f.kc(5,"translate"),f.Wb(),f.Sc(6,": "),f.Xb(7,"span"),f.Sc(8),f.kc(9,"translate"),f.Wb(),f.Wb(),f.Wb(),f.Xb(10,"div",12),f.Xb(11,"table",13),f.Vb(12,14),f.Qc(13,y,3,3,"th",15),f.Qc(14,D,4,3,"td",16),f.Ub(),f.Qc(15,z,3,1,"ng-container",17),f.Qc(16,q,1,0,"tr",18),f.Qc(17,Z,1,0,"tr",19),f.Wb(),f.Wb(),f.Wb()),2&t){const t=f.jc();f.Fb(4),f.Tc(f.lc(5,7,"First state")),f.Fb(4),f.Tc(f.lc(9,9,t.workflow.first_state.name)),f.Fb(3),f.rc("dataSource",t.getTableDataSource()),f.Fb(4),f.rc("ngForOf",t.workflow.states)("ngForTrackBy",t.trackByIndex),f.Fb(1),f.rc("matHeaderRowDef",t.headerRowDef),f.Fb(1),f.rc("matRowDefColumns",t.headerRowDef)}}const tt=function(){return{action:"delete"}};function et(t,e){1&t&&(f.Xb(0,"button",43),f.Xb(1,"span"),f.Sc(2),f.kc(3,"translate"),f.Wb(),f.Wb()),2&t&&(f.rc("mat-dialog-close",f.wc(4,tt)),f.Fb(2),f.Tc(f.lc(3,2,"Delete")))}const nt=function(t){return{action:"update",value:t}};function ct(t,e){if(1&t){const t=f.Yb();f.Xb(0,"h1",36),f.Xb(1,"span"),f.Sc(2),f.kc(3,"translate"),f.Wb(),f.Wb(),f.Xb(4,"div",37),f.Xb(5,"p"),f.Sc(6),f.kc(7,"translate"),f.Wb(),f.Xb(8,"mat-form-field"),f.Xb(9,"input",38),f.fc("ngModelChange",(function(e){return f.Gc(t),f.jc().dialogData.value=e})),f.Wb(),f.Wb(),f.Wb(),f.Xb(10,"div",39),f.Xb(11,"button",40),f.Xb(12,"span"),f.Sc(13),f.kc(14,"translate"),f.Wb(),f.Wb(),f.Xb(15,"button",41),f.Xb(16,"span"),f.Sc(17),f.kc(18,"translate"),f.Wb(),f.Wb(),f.Qc(19,et,4,5,"button",42),f.Wb()}if(2&t){const t=f.jc();f.Fb(2),f.Tc(f.lc(3,9,t.dialogData.title)),f.Fb(4),f.Tc(f.lc(7,11,t.dialogData.description)),f.Fb(3),f.rc("ngModel",t.dialogData.value),f.Fb(2),f.rc("disabled",""===t.dialogData.value&&!t.dialogData.allowEmpty)("mat-dialog-close",f.xc(17,nt,t.dialogData.value)),f.Fb(2),f.Tc(f.lc(14,13,"Save")),f.Fb(2),f.rc("mat-dialog-close",null),f.Fb(2),f.Tc(f.lc(18,15,"Cancel")),f.Fb(2),f.rc("ngIf",t.dialogData.deletable)}}function it(t,e){1&t&&(f.Xb(0,"mat-icon"),f.Sc(1,"check"),f.Wb())}function ot(t,e){if(1&t){const t=f.Yb();f.Xb(0,"button",45),f.fc("click",(function(){f.Gc(t);const n=e.$implicit,c=f.jc().state;return f.jc().onSelectColor(c,n)})),f.Qc(1,it,2,0,"mat-icon",2),f.Xb(2,"span"),f.Sc(3),f.kc(4,"translate"),f.Wb(),f.Wb()}if(2&t){const t=e.$implicit,n=f.jc().state;f.Fb(1),f.rc("ngIf",t===n.css_class),f.Fb(2),f.Tc(f.lc(4,2,t))}}function at(t,e){if(1&t&&f.Qc(0,ot,5,4,"button",44),2&t){const t=f.jc();f.rc("ngForOf",t.labelColors)}}function lt(t,e){1&t&&(f.Xb(0,"mat-icon"),f.Sc(1,"check"),f.Wb())}function rt(t,e){if(1&t){const t=f.Yb();f.Xb(0,"button",45),f.fc("click",(function(){f.Gc(t);const e=f.jc().$implicit,n=f.jc().state;return f.jc().onSetNextState(e,n)})),f.Qc(1,lt,2,0,"mat-icon",2),f.Xb(2,"span"),f.Sc(3),f.kc(4,"translate"),f.Wb(),f.Wb()}if(2&t){const t=f.jc().$implicit,e=f.jc().state;f.Fb(1),f.rc("ngIf",e.next_states_id.includes(t.id)),f.Fb(2),f.Tc(f.lc(4,2,t.name))}}function st(t,e){if(1&t&&(f.Xb(0,"div"),f.Qc(1,rt,5,4,"button",46),f.Wb()),2&t){const t=e.$implicit,n=f.jc().state;f.Fb(1),f.rc("ngIf",t.name!==n.name)}}function bt(t,e){if(1&t&&f.Qc(0,st,2,1,"div",33),2&t){const t=f.jc();f.rc("ngForOf",t.workflow.states)}}function mt(t,e){1&t&&(f.Xb(0,"mat-icon"),f.Sc(1,"check"),f.Wb())}function ut(t,e){if(1&t){const t=f.Yb();f.Xb(0,"button",45),f.fc("click",(function(){f.Gc(t);const n=e.$implicit,c=f.jc().state;return f.jc().onSetRestriction(n.key,c)})),f.Qc(1,mt,2,0,"mat-icon",2),f.Xb(2,"span"),f.Sc(3),f.kc(4,"translate"),f.Wb(),f.Wb()}if(2&t){const t=e.$implicit,n=f.jc().state;f.Fb(1),f.rc("ngIf",n.restriction.includes(t.key)),f.Fb(2),f.Tc(f.lc(4,2,t.label))}}function dt(t,e){if(1&t&&f.Qc(0,ut,5,4,"button",44),2&t){const t=f.jc();f.rc("ngForOf",t.restrictions)}}function ft(t,e){1&t&&(f.Xb(0,"mat-icon"),f.Sc(1,"check"),f.Wb())}function gt(t,e){if(1&t){const t=f.Yb();f.Xb(0,"div"),f.Xb(1,"button",45),f.fc("click",(function(){f.Gc(t);const n=e.$implicit,c=f.jc().state;return f.jc().setMergeAmendment(n.merge,c)})),f.Qc(2,ft,2,0,"mat-icon",2),f.Xb(3,"span"),f.Sc(4),f.kc(5,"translate"),f.Wb(),f.Wb(),f.Wb()}if(2&t){const t=e.$implicit,n=f.jc().state;f.Fb(2),f.rc("ngIf",t.merge===n.merge_amendment_into_final),f.Fb(2),f.Tc(f.lc(5,2,t.label))}}function pt(t,e){if(1&t&&f.Qc(0,gt,6,4,"div",33),2&t){const t=f.jc();f.rc("ngForOf",t.amendmentIntoFinal)}}let ht=(()=>{class t extends d.a{constructor(t,e,n,c,i,o,a,l,r){super(t,e,n),this.translate=e,this.promptService=c,this.dialog=i,this.workflowRepo=o,this.stateRepo=a,this.route=l,this.cd=r,this.headerRowDef=[],this.labelColors=["grey","red","green","lightblue","yellow"],this.statePermissionsList=[{name:"Recommendation label",selector:"recommendation_label",type:"input"},{name:"Allow support",selector:"allow_support",type:"check"},{name:"Allow create poll",selector:"allow_create_poll",type:"check"},{name:"Allow submitter edit",selector:"allow_submitter_edit",type:"check"},{name:"Do not set identifier",selector:"dont_set_identifier",type:"check"},{name:"Show state extension field",selector:"show_state_extension_field",type:"check"},{name:"Show recommendation extension field",selector:"show_recommendation_extension_field",type:"check"},{name:"Show amendment in parent motion",selector:"merge_amendment_into_final",type:"amendment"},{name:"Restrictions",selector:"restriction",type:"restriction"},{name:"Label color",selector:"css_class",type:"color"},{name:"Next states",selector:"next_states_id",type:"state"}],this.restrictions=[{key:m.b.motionsCanManage,label:"Can manage motions"},{key:m.b.motionsCanSeeInternal,label:"Can see motions in internal state"},{key:m.b.motionsCanManageMetadata,label:"Can manage motion metadata"},{key:m.b.motionsIsSubmitter,label:"Submitters"}],this.amendmentIntoFinal=[{merge:m.a.NO,label:"No"},{merge:m.a.UNDEFINED,label:"-"},{merge:m.a.YES,label:"Yes"}]}ngOnInit(){const t=parseInt(this.route.snapshot.paramMap.get("id"),10);this.subscriptions.push(this.workflowRepo.getViewModelObservable(t).subscribe(t=>{t&&(this.workflow=t,this.updateRowDef(),this.cd.markForCheck())}),this.stateRepo.getViewModelListObservable().pipe(Object(l.a)(t=>t.filter(t=>this.workflow.states_id.includes(t.id)))).subscribe(t=>{t&&this.cd.markForCheck()}))}onClickStateName(t){this.openEditDialog(t.name,"Rename state","",!0).subscribe(e=>{if(e)if(this.cd.detectChanges(),"update"===e.action)this.stateRepo.update({name:e.value},t).then(()=>{},this.raiseError);else if("delete"===e.action){const e=this.translate.instant("Delete")+` ${t.name}?`;this.promptService.open("Are you sure",e).then(e=>{e&&this.stateRepo.delete(t).then(()=>{},this.raiseError)})}})}onNewStateButton(){this.openEditDialog("",this.translate.instant("New state"),this.translate.instant("Name")).subscribe(t=>{if(t&&"update"===t.action){const e=new m.c({name:t.value,workflow_id:this.workflow.id});this.stateRepo.create(e).then(()=>{},this.raiseError)}})}onEditWorkflowButton(){this.openEditDialog(this.workflow.name,"Edit name","Please enter a new workflow name:").subscribe(t=>{t&&"update"===t.action&&this.workflowRepo.update({name:t.value},this.workflow).then(()=>{},this.raiseError)})}onClickInputPerm(t,e){this.openEditDialog(e[t.selector],"Edit",t.name,!1,!0).subscribe(n=>{""===n.value&&(n.value=null),n&&"update"===n.action&&this.stateRepo.update({[t.selector]:n.value},e).then(()=>{},this.raiseError)})}onToggleStatePerm(t,e,n){this.stateRepo.update({[e]:n.checked},t).then(()=>{},this.raiseError)}onSelectColor(t,e){this.stateRepo.update({css_class:e},t).then(()=>{},this.raiseError)}onSetNextState(t,e){const n=e.next_states_id.map(t=>t),c=n.findIndex(e=>e===t.id);c<0?n.push(t.id):n.splice(c,1),this.stateRepo.update({next_states_id:n},e).then(()=>{},this.raiseError)}onSetRestriction(t,e){const n=e.restriction.map(t=>t),c=n.findIndex(e=>e===t);c<0?n.push(t):n.splice(c,1),this.stateRepo.update({restriction:n},e).then(()=>{},this.raiseError)}getRestrictionLabel(t){const e=this.restrictions.find(e=>e.key===t);return e?e.label:""}setMergeAmendment(t,e){this.stateRepo.update({merge_amendment_into_final:t},e).then(()=>{},this.raiseError)}openEditDialog(t,e,n,c,i){return this.dialogData={title:e||"",description:n||"",value:t,deletable:c,allowEmpty:i},this.dialog.open(this.workflowDialog,u.a).afterClosed()}getMergeAmendmentLabel(t){return this.amendmentIntoFinal.find(e=>e.merge===t).label}getTableDataSource(){const t=new a.p;return t.data=this.statePermissionsList,t}updateRowDef(){this.headerRowDef=["perm"],this.workflow&&this.workflow.states.forEach(t=>{this.headerRowDef.push(this.getColumnDef(t))})}getColumnDef(t){return`${t.name}${t.id}`}trackElement(t){return t}}return t.\u0275fac=function(e){return new(e||t)(f.Rb(g.c),f.Rb(p.k),f.Rb(h.a),f.Rb(b.a),f.Rb(w.b),f.Rb(s.a),f.Rb(r.a),f.Rb(o.a),f.Rb(f.h))},t.\u0275cmp=f.Lb({type:t,selectors:[["os-workflow-detail"]],viewQuery:function(t,e){var n;1&t&&f.Mc(P,!0),2&t&&f.Bc(n=f.gc())&&(e.workflowDialog=n.first)},features:[f.Cb],decls:22,vars:4,consts:[[3,"nav","hasMainButton","mainEvent"],[1,"title-slot"],[4,"ngIf"],[1,"extra-controls-slot"],["mat-icon-button","",3,"click"],["workflowDialog",""],["matMenuContent",""],["colorMenu","matMenu"],["nextStatesMenu","matMenu"],["restrictionMenu","matMenu"],["mergeAmendmentMenu","matMenu"],[1,"title-line"],[1,"scrollable-matrix"],["mat-table","",3,"dataSource"],["matColumnDef","perm","sticky",""],["mat-header-cell","","class","group-head-table-cell",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],[3,"matColumnDef",4,"ngFor","ngForOf","ngForTrackBy"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["mat-header-cell","",1,"group-head-table-cell"],["mat-cell",""],[1,"permission-name"],[3,"matColumnDef"],["mat-header-cell","",3,"click",4,"matHeaderCellDef"],["mat-header-cell","",3,"click"],[1,"clickable-cell","stretch-to-fill-parent"],[1,"inner-table"],["class","inner-table",4,"ngIf"],[3,"checked","change"],[1,"clickable-cell","stretch-to-fill-parent",3,"click"],[3,"matMenuTriggerFor","matMenuTriggerData","disableRipple","ngClass"],[1,"clickable-cell","stretch-to-fill-parent",3,"matMenuTriggerFor","matMenuTriggerData"],[4,"ngFor","ngForOf"],["mat-header-row",""],["mat-row",""],["mat-dialog-title",""],["mat-dialog-content","",1,"os-form-card-mobile"],["matInput","","osAutofocus","",3,"ngModel","ngModelChange"],["mat-dialog-actions",""],["type","submit","mat-button","","color","accent",3,"disabled","mat-dialog-close"],["type","button","mat-button","",3,"mat-dialog-close"],["type","button","mat-button","","color","warn",3,"mat-dialog-close",4,"ngIf"],["type","button","mat-button","","color","warn",3,"mat-dialog-close"],["mat-menu-item","",3,"click",4,"ngFor","ngForOf"],["mat-menu-item","",3,"click"],["mat-menu-item","",3,"click",4,"ngIf"]],template:function(t,e){1&t&&(f.Xb(0,"os-head-bar",0),f.fc("mainEvent",(function(){return e.onNewStateButton()})),f.Xb(1,"div",1),f.Qc(2,j,3,3,"h2",2),f.Wb(),f.Xb(3,"div",3),f.Xb(4,"button",4),f.fc("click",(function(){return e.onEditWorkflowButton()})),f.Xb(5,"mat-icon"),f.Sc(6,"edit"),f.Wb(),f.Wb(),f.Wb(),f.Wb(),f.Qc(7,K,18,11,"div",2),f.Qc(8,ct,20,19,"ng-template",null,5,f.Rc),f.Xb(10,"mat-menu",6,7),f.Qc(12,at,1,1,"ng-template",6),f.Wb(),f.Xb(13,"mat-menu",6,8),f.Qc(15,bt,1,1,"ng-template",6),f.Wb(),f.Xb(16,"mat-menu",6,9),f.Qc(18,dt,1,1,"ng-template",6),f.Wb(),f.Xb(19,"mat-menu",6,10),f.Qc(21,pt,1,1,"ng-template",6),f.Wb()),2&t&&(f.rc("nav",!1)("hasMainButton",!0),f.Fb(2),f.rc("ngIf",e.workflow),f.Fb(5),f.rc("ngIf",e.workflow))},directives:[k.a,c.t,v.b,W.a,M.f,M.b,a.o,a.c,a.i,a.b,c.s,a.k,a.n,a.h,a.a,C.a,S.a,M.e,c.q,a.j,a.m,w.i,w.f,F.c,X.b,_.d,O.a,_.t,_.w,w.c,w.d,M.c],pipes:[p.j],styles:[".title-line[_ngcontent-%COMP%]{font-weight:500;font-size:16px}.title-line[_ngcontent-%COMP%]   .icon-prefix[_ngcontent-%COMP%]   .mat-icon[_ngcontent-%COMP%]{display:-ms-inline-flexbox;display:inline-flex;vertical-align:middle;font-size:16px;height:16px;width:16px}.title-line[_ngcontent-%COMP%]   .favorite-star[_ngcontent-%COMP%]{padding-right:3px}.mat-table[_ngcontent-%COMP%]{width:100%}.mat-table[_ngcontent-%COMP%]   .mat-header-row[_ngcontent-%COMP%]   .mat-column-anchor[_ngcontent-%COMP%]{display:none}.mat-table[_ngcontent-%COMP%]   .mat-row[_ngcontent-%COMP%]{position:relative}.mat-table[_ngcontent-%COMP%]   .mat-row[_ngcontent-%COMP%]   .mat-column-anchor[_ngcontent-%COMP%]{position:absolute!important;top:0;right:0;bottom:0;left:0;opacity:.1;z-index:1}.mat-table[_ngcontent-%COMP%]   .mat-row[_ngcontent-%COMP%]   .mat-column-anchor[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{display:block;height:100%;width:100%}.mat-table[_ngcontent-%COMP%]   .mat-cell[_ngcontent-%COMP%]{position:relative}.mat-table[_ngcontent-%COMP%]   .mat-cell[_ngcontent-%COMP%]   .fill[_ngcontent-%COMP%]{position:absolute;display:inherit;height:100%;width:100%;line-height:0}.mat-table[_ngcontent-%COMP%]   .mat-cell[_ngcontent-%COMP%]   .fill[_ngcontent-%COMP%]   *[_ngcontent-%COMP%]{margin-top:auto;margin-bottom:auto}.mat-table[_ngcontent-%COMP%]   .mat-cell[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]{z-index:2}.mat-table[_ngcontent-%COMP%]   .mat-table-sticky[_ngcontent-%COMP%]{z-index:3!important}.title-line[_ngcontent-%COMP%]{margin:20px 25px}table[_ngcontent-%COMP%]   .mat-cell[_ngcontent-%COMP%], table[_ngcontent-%COMP%]   .mat-header-cell[_ngcontent-%COMP%]{min-width:200px;position:relative}table[_ngcontent-%COMP%]   .clickable-cell[_ngcontent-%COMP%]{display:-ms-flexbox;display:flex;cursor:pointer}table[_ngcontent-%COMP%]   .clickable-cell[_ngcontent-%COMP%]:hover{background-color:rgba(0,0,0,.025)}table[_ngcontent-%COMP%]   .inner-table[_ngcontent-%COMP%]{text-align:center;-ms-flex-align:center;align-items:center;margin:auto;overflow:hidden;padding:0 10px}table[_ngcontent-%COMP%]   .mat-column-perm[_ngcontent-%COMP%]{min-width:150px}table[_ngcontent-%COMP%]   .mat-column-perm[_ngcontent-%COMP%]   .permission-name[_ngcontent-%COMP%]{margin-right:10px}.mat-chip[_ngcontent-%COMP%]:hover{cursor:pointer}.scrollable-matrix[_ngcontent-%COMP%]{overflow-y:scroll;overflow-x:auto;height:calc(100vh - 128px)}"],changeDetection:0}),t})();var wt=n("mrSG"),kt=n("AqIO"),vt=n("hsNs"),Wt=n("wL0i"),Mt=n("0Obk"),Ct=n("4LpT");function St(t,e){if(1&t&&f.Sb(0,"a",7),2&t){const t=f.jc().row;f.rc("routerLink",t.id)}}function Ft(t,e){if(1&t&&(f.Xb(0,"div",5),f.Qc(1,St,1,1,"a",6),f.Xb(2,"div"),f.Sc(3),f.kc(4,"translate"),f.Wb(),f.Wb()),2&t){const t=e.value,n=f.jc();f.Fb(1),f.rc("ngIf",!n.isMultiSelect),f.Fb(2),f.Tc(f.lc(4,2,t))}}function Xt(t,e){if(1&t){const t=f.Yb();f.Xb(0,"div",5),f.Xb(1,"button",8),f.fc("click",(function(){f.Gc(t);const n=e.row;return f.jc().onDeleteWorkflow(n)})),f.Xb(2,"mat-icon",9),f.Sc(3,"delete"),f.Wb(),f.Wb(),f.Wb()}}function _t(t,e){if(1&t){const t=f.Yb();f.Xb(0,"h1",10),f.Xb(1,"span"),f.Sc(2),f.kc(3,"translate"),f.Wb(),f.Wb(),f.Xb(4,"div",11),f.Xb(5,"p"),f.Sc(6),f.kc(7,"translate"),f.Wb(),f.Xb(8,"mat-form-field"),f.Xb(9,"input",12),f.fc("ngModelChange",(function(e){return f.Gc(t),f.jc().newWorkflowTitle=e})),f.Wb(),f.Wb(),f.Wb(),f.Xb(10,"div",13),f.Xb(11,"button",14),f.Xb(12,"span"),f.Sc(13),f.kc(14,"translate"),f.Wb(),f.Wb(),f.Xb(15,"button",15),f.Xb(16,"span"),f.Sc(17),f.kc(18,"translate"),f.Wb(),f.Wb(),f.Wb()}if(2&t){const t=f.jc();f.Fb(2),f.Tc(f.lc(3,8,"New workflow")),f.Fb(4),f.Tc(f.lc(7,10,"Please enter a name for the new workflow:")),f.Fb(3),f.rc("ngModel",t.newWorkflowTitle),f.Fb(2),f.rc("disabled",""===t.newWorkflowTitle)("mat-dialog-close",t.newWorkflowTitle),f.Fb(2),f.Tc(f.lc(14,12,"Save")),f.Fb(2),f.rc("mat-dialog-close",null),f.Fb(2),f.Tc(f.lc(18,14,"Cancel"))}}const Ot=function(){return["menu"]},Pt=[{path:"",component:(()=>{class t extends Wt.a{constructor(t,e,n,c,i,o,a){super(t,e,n,c),this.translate=e,this.dialog=i,this.workflowRepo=o,this.promptService=a,this.tableColumnDefinition=[{prop:"name",width:"auto"},{prop:"delete"}],this.filterProps=["name","states"]}ngOnInit(){super.setTitle("Workflows")}onNewButton(t){this.newWorkflowTitle="",this.dialog.open(t,u.a).afterClosed().subscribe(t=>{t&&this.workflowRepo.create(new vt.a({name:t})).then(()=>{},this.raiseError)})}onDeleteWorkflow(t){return Object(wt.a)(this,void 0,void 0,(function*(){const e=this.translate.instant("Are you sure you want to delete this workflow?"),n=t.getTitle();(yield this.promptService.open(e,n))&&this.workflowRepo.delete(t).then(()=>{},this.raiseError)}))}}return t.\u0275fac=function(e){return new(e||t)(f.Rb(g.c),f.Rb(p.k),f.Rb(h.a),f.Rb(kt.a),f.Rb(w.b),f.Rb(s.a),f.Rb(b.a))},t.\u0275cmp=f.Lb({type:t,selectors:[["os-workflow-list"]],features:[f.Cb],decls:10,vars:14,consts:[["prevUrl","../..",3,"nav","hasMainButton","mainEvent"],[1,"title-slot"],["listStorageKey","workflow",3,"listObservableProvider","columns","allowProjector","hiddenInMobile","showListOfSpeakers","filterProps","dataSourceChange"],["class","cell-slot fill",4,"pblNgridCellDef"],["newWorkflowDialog",""],[1,"cell-slot","fill"],["class","detail-link",3,"routerLink",4,"ngIf"],[1,"detail-link",3,"routerLink"],["type","button","mat-icon-button","",3,"click"],["color","warn"],["mat-dialog-title",""],["mat-dialog-content",""],["matInput","","osAutofocus","","required","",3,"ngModel","ngModelChange"],["mat-dialog-actions",""],["type","submit","mat-button","","color","accent",3,"disabled","mat-dialog-close"],["type","button","mat-button","",3,"mat-dialog-close"]],template:function(t,e){if(1&t){const t=f.Yb();f.Xb(0,"os-head-bar",0),f.fc("mainEvent",(function(){f.Gc(t);const n=f.Cc(9);return e.onNewButton(n)})),f.Xb(1,"div",1),f.Xb(2,"h2"),f.Sc(3),f.kc(4,"translate"),f.Wb(),f.Wb(),f.Wb(),f.Xb(5,"os-list-view-table",2),f.fc("dataSourceChange",(function(t){return e.onDataSourceChange(t)})),f.Qc(6,Ft,5,4,"div",3),f.Qc(7,Xt,4,0,"div",3),f.Wb(),f.Qc(8,_t,19,16,"ng-template",null,4,f.Rc)}2&t&&(f.rc("nav",!1)("hasMainButton",!0),f.Fb(3),f.Tc(f.lc(4,11,"Workflows")),f.Fb(2),f.rc("listObservableProvider",e.workflowRepo)("columns",e.tableColumnDefinition)("allowProjector",!1)("hiddenInMobile",f.wc(13,Ot))("showListOfSpeakers",!1)("filterProps",e.filterProps),f.Fb(1),f.rc("pblNgridCellDef","name"),f.Fb(1),f.rc("pblNgridCellDef","delete"))},directives:[k.a,Mt.a,Ct.b,c.t,o.i,v.b,W.a,w.i,w.f,F.c,X.b,_.d,O.a,_.E,_.t,_.w,w.c,w.d],pipes:[p.j],styles:[""]}),t})(),pathMatch:"full"},{path:":id",component:ht}];let jt=(()=>{class t{}return t.\u0275mod=f.Pb({type:t}),t.\u0275inj=f.Ob({factory:function(e){return new(e||t)},imports:[[o.j.forChild(Pt)],o.j]}),t})(),yt=(()=>{class t{}return t.\u0275mod=f.Pb({type:t}),t.\u0275inj=f.Ob({factory:function(e){return new(e||t)},imports:[[c.c,jt,i.a]]}),t})()},wL0i:function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));var c=n("mV3u");class i extends c.a{constructor(t,e,n,c){super(t,e,n),this.storage=c,this.canMultiSelect=!1,this._multiSelectMode=!1,this.singleButtonWidth="40px",this.badgeButtonWidth="45px",this.selectedRows=[]}onDataSourceChange(t){this.dataSource=t}toggleMultiSelect(){!this.canMultiSelect||this.isMultiSelect?(this._multiSelectMode=!1,this.deselectAll()):this._multiSelectMode=!0}selectAll(){this.dataSource.selection.select(...this.dataSource.filteredData)}deselectAll(){this.dataSource&&this.dataSource.selection.clear()}get isMultiSelect(){return this._multiSelectMode}}}}]);