(window.webpackJsonp=window.webpackJsonp||[]).push([[3,42],{Ei9z:function(t,e,n){t.exports=n.p+"0-es2015.008b3c821338db41e13a.worker.js"},F48D:function(t,e,n){"use strict";n.d(e,"a",(function(){return s}));var i=n("mrSG"),r=n("LBBb"),a=n("8Y7J"),o=n("iELJ");let s=(()=>{class t{constructor(t){this.dialog=t}open(t,e=""){return Object(i.a)(this,void 0,void 0,(function*(){return this.dialog.open(r.a,{width:"290px",data:{title:t,content:e}}).afterClosed().toPromise()}))}}return t.\u0275fac=function(e){return new(e||t)(a.bc(o.b))},t.\u0275prov=a.Nb({token:t,factory:t.\u0275fac,providedIn:"root"}),t})()},LBBb:function(t,e,n){"use strict";n.d(e,"a",(function(){return l}));var i=n("iELJ"),r=n("8Y7J"),a=n("SVse"),o=n("Dxy4"),s=n("TSSN");function c(t,e){if(1&t&&(r.Xb(0,"div"),r.Xb(1,"h2",1),r.Sc(2),r.Wb(),r.Sb(3,"mat-dialog-content",2),r.Xb(4,"mat-dialog-actions"),r.Xb(5,"button",3),r.Sc(6),r.kc(7,"translate"),r.Wb(),r.Xb(8,"button",4),r.Sc(9),r.kc(10,"translate"),r.Wb(),r.Wb(),r.Wb()),2&t){const t=r.jc();r.Fb(2),r.Tc(t.data.title),r.Fb(1),r.rc("innerHTML",t.data.content,r.Hc),r.Fb(2),r.rc("mat-dialog-close",!0),r.Fb(1),r.Tc(r.lc(7,6,"OK")),r.Fb(2),r.rc("mat-dialog-close",!1),r.Fb(1),r.Tc(r.lc(10,8,"Cancel"))}}let l=(()=>{class t{constructor(t,e){this.dialogRef=t,this.data=e}}return t.\u0275fac=function(e){return new(e||t)(r.Rb(i.h),r.Rb(i.a))},t.\u0275cmp=r.Lb({type:t,selectors:[["os-prompt-dialog"]],decls:1,vars:1,consts:[[4,"ngIf"],["mat-dialog-title",""],[3,"innerHTML"],["mat-button","","color","warn",3,"mat-dialog-close"],["mat-button","",3,"mat-dialog-close"]],template:function(t,e){1&t&&r.Qc(0,c,11,10,"div",0),2&t&&r.rc("ngIf",e.data)},directives:[a.t,i.i,i.f,i.c,o.b,i.d],pipes:[s.j],encapsulation:2}),t})()},a9GI:function(t,e,n){"use strict";(function(t){n.d(e,"d",(function(){return f})),n.d(e,"a",(function(){return h})),n.d(e,"c",(function(){return p})),n.d(e,"b",(function(){return u}));var i=n("mrSG"),r=n("Iab2"),a=n("Y3lY"),o=n("+KbT"),s=n("Hila"),c=n("x4ls"),l=n("8Y7J"),d=n("TSSN"),g=n("zHaW"),f=function(t){return t.DEFAULT="tocEntry",t.SUBTITLE="subtitle",t.SUB_ENTRY="tocSubEntry",t.CATEGORY_SECTION="tocCategorySection",t}({}),h=function(t){return t.DEFAULT="noBorders",t.LIGHT_HORIZONTAL_LINES="lightHorizontalLines",t.HEADER_ONLY="headerLineOnly",t}({});class p extends Error{constructor(t){super(t),this.message=t;const e=new.target.prototype;this.__proto__=e}}let u=(()=>{class e{constructor(t,e,n,i,r){this.translate=t,this.configService=e,this.httpService=n,this.matSnackBar=i,this.progressService=r,this.imageUrls=[]}initVfs(){return Object(i.a)(this,void 0,void 0,(function*(){const t=Array.from(new Set(this.configService.instant("fonts_available").map(t=>this.configService.instant(t)).map(t=>t.path||"/"+t.default))).map(t=>this.httpService.downloadAsBase64(t).then(e=>({[t.split("/").pop()]:e}))),e=yield Promise.all(t);let n={};return e.map(t=>{n=Object.assign(Object.assign({},n),t)}),n}))}getFontName(t){const e=this.configService.instant(t);return(e.path||"/"+e.default).split("/").pop()}getStandardPaper(t,e,n,r,a,o){return Object(i.a)(this,void 0,void 0,(function*(){this.imageUrls=r||[];const i=this.configService.instant("general_export_pdf_pagesize");return{pageSize:i||"A4",pageOrientation:o?"landscape":"portrait",pageMargins:a||("A5"===i?[45,30,45,45]:[75,90,75,75]),defaultStyle:{font:"PdfFont",fontSize:this.configService.instant("general_export_pdf_fontsize")},header:this.getHeader(a?[a[0],a[2]]:null),tmpfooter:this.getFooter(a?[a[0],a[2]]:null,n),info:e,content:t,styles:this.getStandardPaperStyles()}}))}getBallotPaper(t,e){return Object(i.a)(this,void 0,void 0,(function*(){return this.imageUrls=e?[e]:[],{pageSize:"A4",pageMargins:[0,0,0,0],defaultStyle:{font:"PdfFont",fontSize:10},content:t,styles:this.getBlankPaperStyles()}}))}getPdfFonts(){return{normal:this.getFontName("font_regular"),bold:this.getFontName("font_bold"),italics:this.getFontName("font_italic"),bolditalics:this.getFontName("font_bold_italic")}}getHeader(t){let e,n=this.configService.instant("logo_pdf_header_L").path,i=this.configService.instant("logo_pdf_header_R").path;const r=[];return n&&(0===n.indexOf("/")&&(n=n.substr(1)),r.push({image:n,fit:[180,40],width:"20%"}),this.imageUrls.push(n)),e=n&&i?"":[[this.translate.instant(this.configService.instant("general_event_name")),this.translate.instant(this.configService.instant("general_event_description"))].filter(Boolean).join(" - "),[this.configService.instant("general_event_location"),this.configService.instant("general_event_date")].filter(Boolean).join(", ")].join("\n"),r.push({text:e,style:"headerText",alignment:i?"left":"right"}),i&&(0===i.indexOf("/")&&(i=i.substr(1)),r.push({image:i,fit:[180,40],alignment:"right",width:"20%"}),this.imageUrls.push(i)),{color:"#555",fontSize:9,margin:[t?t[0]:75,30,t?t[0]:75,10],columns:r,columnGap:10}}getFooter(t,e){const n=[],i=!e||!e.pdfOptions||e.pdfOptions.includes("page"),r=!(!e||!e.pdfOptions)&&e.pdfOptions.includes("date");let a,o,s;const c=this.configService.instant("logo_pdf_footer_L").path,l=this.configService.instant("logo_pdf_footer_R").path;let d="";i&&(d+="%PAGENR%");let g={};return r&&(g={text:`${this.translate.instant("As of")}: ${(new Date).toLocaleDateString(this.translate.currentLang)}`,fontSize:6}),c&&l?(a="20%",s=[180,40]):(a="80%",s=[400,50]),o=c&&l?"center":c&&!l?"right":l&&!c?"left":this.configService.instant("general_export_pdf_pagenumber_alignment"),c&&(n.push({image:c,fit:s,width:a,alignment:"left"}),this.imageUrls.push(c)),n.push({stack:[d,g],style:"footerPageNumber",alignment:o}),l&&(n.push({image:l,fit:s,width:a,alignment:"right"}),this.imageUrls.push(l)),{margin:[t?t[0]:75,0,t?t[0]:75,10],columns:n,columnGap:10}}showProgress(){this.matSnackBar.openFromComponent(a.a,{duration:0}).onAction().subscribe(()=>{this.cancelPdfCreation()}),this.progressService.message=this.translate.instant("Creating PDF file ..."),this.progressService.progressMode="determinate"}download(t,e,n,i){this.showProgress(),this.getStandardPaper(t,n,i).then(t=>{this.createPdf(t,e)})}downloadLandscape(t,e,n){this.showProgress(),this.getStandardPaper(t,n,null,null,[50,80,50,75],!0).then(t=>{this.createPdf(t,e)})}downloadWithBallotPaper(t,e,n){this.showProgress(),this.getBallotPaper(t,n).then(t=>{this.createPdf(t,e)})}createPdf(e,n){return Object(i.a)(this,void 0,void 0,(function*(){const i=n+".pdf",a=this.getPdfFonts(),o=yield this.initVfs();yield this.loadAllImages(o);const s=/msie\s|trident\//i.test(window.navigator.userAgent);"undefined"==typeof Worker||s?(this.matSnackBar.dismiss(),this.matSnackBar.open(this.translate.instant("Cannot create PDF files on this browser."),"",{duration:0})):(this.pdfWorker=new Worker(t,void 0),this.pdfWorker.onmessage=({data:t})=>{if("number"==typeof t){const e=Math.ceil(100*t);this.progressService.progressAmount=e}"object"==typeof t&&(this.matSnackBar.dismiss(),Object(r.saveAs)(t,i,{autoBOM:!0}),this.pdfWorker=null)},this.pdfWorker.postMessage({doc:JSON.parse(JSON.stringify(e)),fonts:a,vfs:o}))}))}cancelPdfCreation(){this.pdfWorker&&(this.pdfWorker.terminate(),this.pdfWorker=null)}getStandardPaperStyles(){const t=this.configService.instant("general_export_pdf_pagesize");return{title:{fontSize:"A5"===t?14:16,margin:[0,0,0,20],bold:!0},subtitle:{fontSize:9,margin:[0,-20,0,20],color:"grey"},preamble:{margin:[0,0,0,10]},headerText:{fontSize:10,margin:[0,10,0,0]},footerPageNumber:{fontSize:8,margin:[0,15,0,0],color:"#555"},boldText:{bold:!0},smallText:{fontSize:8},heading2:{fontSize:"A5"===t?12:14,margin:[0,0,0,10],bold:!0},heading3:{fontSize:"A5"===t?10:12,margin:[0,10,0,0],bold:!0},userDataHeading:{fontSize:14,margin:[0,10],bold:!0},userDataTopic:{fontSize:12,margin:[0,5]},userDataValue:{fontSize:12,margin:[15,5]},tocEntry:{fontSize:"A5"===t?10:11,margin:[0,0,0,0],bold:!1},tocHeaderRow:{fontSize:7},tocSubEntry:{fontSize:"A5"===t?9:10,color:"#404040"},tocCategoryEntry:{fontSize:"A5"===t?10:11,margin:[10,0,0,0],bold:!1},tocCategoryTitle:{fontSize:"A5"===t?10:11,margin:[0,0,0,4],bold:!0},tocSubcategoryTitle:{fontSize:"A5"===t?9:10,margin:[0,0,0,4],bold:!0},tocCategorySection:{margin:[0,0,0,10]},userDataTitle:{fontSize:26,margin:[0,0,0,0],bold:!0},tableHeader:{bold:!0,fillColor:"white"},listParent:{fontSize:14,margin:[0,5]},listChild:{fontSize:12,margin:[0,5]},textItem:{fontSize:11,margin:[0,7]}}}getBlankPaperStyles(){return{title:{fontSize:14,bold:!0,margin:[30,30,0,0]},description:{fontSize:11,margin:[30,0,0,0]}}}loadAllImages(t){return Object(i.a)(this,void 0,void 0,(function*(){const e=this.imageUrls.map(e=>this.addImageToVfS(e,t));yield Promise.all(e)}))}addImageToVfS(t,e){return Object(i.a)(this,void 0,void 0,(function*(){if(0===t.indexOf("/")&&(t=t.substr(1)),!e[t]){const n=yield this.httpService.downloadAsBase64(t);e[t]=n}}))}createTitle(t){return{text:this.translate.instant(this.configService.instant(t)),style:"title"}}createPreamble(t){const e=this.configService.instant(t);return e?{text:e,style:"preamble"}:{}}getPageBreak(){return{text:"",pageBreak:"after"}}getSpacer(){return{text:"",margin:[0,10]}}createTocTableDef(t,e=f.DEFAULT,n=h.DEFAULT,...i){return{table:{headerRows:i[0]?i.length:0,keepWithHeaderRows:i[0]?i.length:0,dontBreakRows:!0,widths:["auto","*","auto"],body:i[0]?[...i,...t]:t},layout:n,style:e}}createTocLine(t,e,n,i=f.DEFAULT,...r){return[{text:t,style:i},{text:[e,...r],style:"tocEntry"},{pageReference:n,style:"tocEntry",alignment:"right"}]}createTocLineInline(t,e=!1){return{text:"\n"+t,style:f.SUB_ENTRY,italics:e}}drawCircle(t,e){return[{type:"ellipse",x:0,y:t,lineColor:"black",r1:e,r2:e}]}}return e.\u0275fac=function(t){return new(t||e)(l.bc(d.k),l.bc(o.a),l.bc(s.a),l.bc(g.a),l.bc(c.a))},e.\u0275prov=l.Nb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})()}).call(this,n("Ei9z"))}}]);