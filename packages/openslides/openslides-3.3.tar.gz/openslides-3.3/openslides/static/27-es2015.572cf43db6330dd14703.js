(window.webpackJsonp=window.webpackJsonp||[]).push([[27,42],{"68w7":function(t,e,n){"use strict";n.r(e),n.d(e,"CategoryModule",(function(){return yt}));var o=n("SVse"),i=n("PCNd"),c=n("iInd"),a=n("+QJK"),s=n("mrSG"),r=n("iTQr"),l=n("F48D"),b=n("/tkw"),d=n("mV3u"),u=n("8Y7J"),m=n("cUpR"),h=n("TSSN"),g=n("zHaW"),f=n("mksl"),p=n("PDjf");const v=["osSortedTree"];function C(t,e){1&t&&u.Sc(0),2&t&&u.Uc(" ",e.item.getTitle()," ")}let S=(()=>{class t extends d.a{constructor(t,e,n,o,i){super(t,e,n),this.categoryRepo=o,this.promptService=i,this.hasChanged=!1,this.categoriesObservable=this.categoryRepo.getViewModelListObservable()}onSave(){return Object(s.a)(this,void 0,void 0,(function*(){yield this.categoryRepo.sortCategories(this.osSortTree.getTreeData()).then(()=>this.osSortTree.setSubscription(),this.raiseError)}))}onCancel(){return Object(s.a)(this,void 0,void 0,(function*(){(yield this.canDeactivate())&&this.osSortTree.setSubscription()}))}receiveChanges(t){this.hasChanged=t}canDeactivate(){return Object(s.a)(this,void 0,void 0,(function*(){if(this.hasChanged){const t=this.translate.instant("Do you really want to exit this page?"),e=this.translate.instant("You made changes.");return yield this.promptService.open(t,e)}return!0}))}}return t.\u0275fac=function(e){return new(e||t)(u.Rb(m.c),u.Rb(h.k),u.Rb(g.a),u.Rb(r.a),u.Rb(l.a))},t.\u0275cmp=u.Lb({type:t,selectors:[["os-categories-sort"]],viewQuery:function(t,e){var n;1&t&&u.Mc(v,!0),2&t&&u.Bc(n=u.gc())&&(e.osSortTree=n.first)},features:[u.Cb],decls:10,vars:6,consts:[[3,"editMode","nav","saveEvent","mainEvent"],[1,"title-slot"],["parentKey","parent_id","weightKey","weight",3,"model","hasChanged"],["osSortedTree",""],["innerNode",""]],template:function(t,e){1&t&&(u.Xb(0,"os-head-bar",0),u.fc("saveEvent",(function(){return e.onSave()}))("mainEvent",(function(){return e.onCancel()})),u.Xb(1,"div",1),u.Xb(2,"h2"),u.Sc(3),u.kc(4,"translate"),u.Wb(),u.Wb(),u.Wb(),u.Xb(5,"mat-card"),u.Xb(6,"os-sorting-tree",2,3),u.fc("hasChanged",(function(t){return e.receiveChanges(t)})),u.Qc(8,C,1,1,"ng-template",null,4,u.Rc),u.Wb(),u.Wb()),2&t&&(u.rc("editMode",e.hasChanged)("nav",!1),u.Fb(3),u.Tc(u.lc(4,4,"Sort categories")),u.Fb(3),u.rc("model",e.categoriesObservable))},directives:[f.a,p.a,b.a],pipes:[h.j],styles:[".line[_ngcontent-%COMP%]{display:table;width:100%;font-size:14px;min-height:50px;margin-bottom:5px}.line[_ngcontent-%COMP%]   .left[_ngcontent-%COMP%]{max-width:100%}.line[_ngcontent-%COMP%]   .left[_ngcontent-%COMP%], .line[_ngcontent-%COMP%]   .right[_ngcontent-%COMP%]{display:table-cell;vertical-align:middle}.line[_ngcontent-%COMP%]   .right[_ngcontent-%COMP%]{padding-right:10px;width:auto;white-space:nowrap}"]}),t})();var M=n("s7LF"),O=n("OaSA"),y=n("OwvW"),F=n("dOok"),P=n("Izkr"),W=n("iELJ"),X=n("3Xi6"),w=n("rJgo"),_=n("Tj54"),k=n("BSbQ"),x=n("Dxy4"),R=n("f44v"),j=n("Q2Ze"),D=n("e6WT"),T=n("IZUe");const I=["editForm"],L=["editDialog"];function Q(t,e){if(1&t&&(u.Xb(0,"h2"),u.Sc(1),u.Wb()),2&t){const t=u.jc();u.Fb(1),u.Uc(" ",t.selectedCategory.prefixedName," ")}}function E(t,e){if(1&t&&(u.Xb(0,"div"),u.Xb(1,"button",11),u.Xb(2,"mat-icon"),u.Sc(3,"more_vert"),u.Wb(),u.Wb(),u.Wb()),2&t){u.jc();const t=u.Cc(8);u.Fb(1),u.rc("matMenuTriggerFor",t)}}function B(t,e){1&t&&(u.Xb(0,"mat-header-cell"),u.Xb(1,"span"),u.Sc(2),u.kc(3,"translate"),u.Wb(),u.Wb()),2&t&&(u.Fb(2),u.Tc(u.lc(3,1,"Motion")))}function N(t,e){if(1&t&&(u.Xb(0,"mat-cell"),u.Sc(1),u.Wb()),2&t){const t=e.$implicit;u.Fb(1),u.Uc(" ",t.getTitle()," ")}}function U(t,e){1&t&&(u.Xb(0,"mat-header-cell"),u.Xb(1,"span"),u.Sc(2),u.kc(3,"translate"),u.Wb(),u.Wb()),2&t&&(u.Fb(2),u.Tc(u.lc(3,1,"State")))}function G(t,e){if(1&t&&(u.Xb(0,"mat-cell",22),u.Xb(1,"mat-basic-chip",23),u.Sc(2),u.Wb(),u.Wb()),2&t){const t=e.$implicit,n=u.jc(2);u.Fb(1),u.rc("ngClass",t.stateCssColor),u.Fb(1),u.Uc(" ",n.getStateLabel(t)," ")}}function z(t,e){1&t&&(u.Xb(0,"mat-header-cell"),u.Xb(1,"span"),u.Sc(2),u.kc(3,"translate"),u.Wb(),u.Wb()),2&t&&(u.Fb(2),u.Tc(u.lc(3,1,"Recommendation")))}function V(t,e){if(1&t&&(u.Xb(0,"mat-basic-chip",25),u.Sc(1),u.Wb()),2&t){const t=u.jc().$implicit,e=u.jc(2);u.Fb(1),u.Uc(" ",e.getRecommendationLabel(t)," ")}}function J(t,e){if(1&t&&(u.Xb(0,"mat-cell",22),u.Qc(1,V,2,1,"mat-basic-chip",24),u.Wb()),2&t){const t=e.$implicit;u.Fb(1),u.rc("ngIf",t.recommendation)}}function Y(t,e){1&t&&u.Sb(0,"mat-header-cell")}const A=function(){return{back:"true"}};function K(t,e){if(1&t&&(u.Xb(0,"mat-cell"),u.Sb(1,"a",26),u.Wb()),2&t){const t=e.$implicit;u.Fb(1),u.rc("routerLink",t.getDetailStateURL())("state",u.wc(2,A))}}function q(t,e){1&t&&u.Sb(0,"mat-header-row")}function H(t,e){1&t&&u.Sb(0,"mat-row")}function $(t,e){if(1&t&&(u.Xb(0,"div"),u.Xb(1,"h2"),u.Xb(2,"span"),u.Sc(3),u.Wb(),u.Sc(4),u.Wb(),u.Xb(5,"table",12),u.Vb(6,13),u.Qc(7,B,4,3,"mat-header-cell",14),u.Qc(8,N,2,1,"mat-cell",15),u.Ub(),u.Vb(9,16),u.Qc(10,U,4,3,"mat-header-cell",14),u.Qc(11,G,3,2,"mat-cell",17),u.Ub(),u.Vb(12,18),u.Qc(13,z,4,3,"mat-header-cell",14),u.Qc(14,J,2,1,"mat-cell",17),u.Ub(),u.Vb(15,19),u.Qc(16,Y,1,0,"mat-header-cell",14),u.Qc(17,K,2,3,"mat-cell",15),u.Ub(),u.Qc(18,q,1,0,"mat-header-row",20),u.Qc(19,H,1,0,"mat-row",21),u.Wb(),u.Wb()),2&t){const t=e.$implicit,n=u.jc();u.Fb(3),u.Tc(n.getLevelDashes(t)),u.Fb(1),u.Uc(" ",t.prefixedName," "),u.Fb(1),u.rc("dataSource",n.dataSources[t.id]),u.Fb(13),u.rc("matHeaderRowDef",n.getColumnDefinition()),u.Fb(1),u.rc("matRowDefColumns",n.getColumnDefinition())}}function Z(t,e){if(1&t){const t=u.Yb();u.Xb(0,"h1",27),u.Xb(1,"span"),u.Sc(2),u.kc(3,"translate"),u.Wb(),u.Wb(),u.Xb(4,"div",28),u.Xb(5,"form",29),u.fc("ngSubmit",(function(){return u.Gc(t),u.jc().save()}))("keydown",(function(e){return u.Gc(t),u.jc().onKeyDown(e)})),u.Xb(6,"mat-form-field"),u.Sb(7,"input",30),u.kc(8,"translate"),u.Wb(),u.Xb(9,"mat-form-field"),u.Sb(10,"input",31),u.kc(11,"translate"),u.Wb(),u.Wb(),u.Wb(),u.Xb(12,"div",32),u.Xb(13,"button",33),u.fc("click",(function(){return u.Gc(t),u.jc().save()})),u.Xb(14,"span"),u.Sc(15),u.kc(16,"translate"),u.Wb(),u.Wb(),u.Xb(17,"button",34),u.Xb(18,"span"),u.Sc(19),u.kc(20,"translate"),u.Wb(),u.Wb(),u.Wb()}if(2&t){const t=u.jc();u.Fb(2),u.Vc("",u.lc(3,9,"Edit details for")," ",t.selectedCategory.prefixedName,""),u.Fb(3),u.rc("formGroup",t.editForm),u.Fb(2),u.sc("placeholder",u.lc(8,11,"Prefix")),u.Fb(3),u.sc("placeholder",u.lc(11,13,"Name")),u.Fb(3),u.rc("disabled",!t.editForm.valid),u.Fb(2),u.Tc(u.lc(16,15,"Save")),u.Fb(2),u.rc("mat-dialog-close",null),u.Fb(2),u.Tc(u.lc(20,17,"Cancel"))}}let tt=(()=>{class t extends d.a{constructor(t,e,n,o,i,c,a,s,r,l,b){super(t,e,n),this.translate=e,this.route=o,this.operator=i,this.router=c,this.repo=a,this.motionRepo=s,this.promptService=r,this.fb=l,this.dialog=b,this.dataSources={}}get canEdit(){return this.operator.hasPerms(y.b.motionsCanManage)}ngOnInit(){const t=parseInt(this.route.snapshot.params.id,10);this.subscriptions.push(this.repo.getViewModelListObservable().subscribe(e=>{const n=e.findIndex(e=>e.id===t);if(n<0)return;let o;for(this.selectedCategory=e[n],super.setTitle(this.selectedCategory.prefixedName),o=n+1;o<e.length&&e[o].level>this.selectedCategory.level;o++);this.categories=e.slice(n,o),this.categories.forEach(t=>{const e=new O.p;e.data=t.motions,this.dataSources[t.id]=e})}))}getColumnDefinition(){return["title","state","recommendation","anchor"]}onDeleteButton(){return Object(s.a)(this,void 0,void 0,(function*(){const t=this.translate.instant("Are you sure you want to delete this category and all subcategories?"),e=this.selectedCategory.prefixedName;(yield this.promptService.open(t,e))&&(yield this.repo.delete(this.selectedCategory),this.router.navigate(["../"],{relativeTo:this.route}))}))}onKeyDown(t){"Escape"===t.key&&this.dialogRef.close(),"Enter"===t.key&&this.save()}save(){this.repo.update(this.editForm.value,this.selectedCategory).then(()=>this.dialogRef.close()).catch(this.raiseError)}toggleEditMode(){this.editForm=this.fb.group({prefix:[this.selectedCategory.prefix],name:[this.selectedCategory.name,M.H.required]}),this.dialogRef=this.dialog.open(this.editDialog,P.a)}getRecommendationLabel(t){return this.motionRepo.getExtendedRecommendationLabel(t)}getStateLabel(t){return this.motionRepo.getExtendedStateLabel(t)}getLevelDashes(t){return"\u2013".repeat(t.level-this.selectedCategory.level)}numberMotions(){return Object(s.a)(this,void 0,void 0,(function*(){const t=this.translate.instant("Are you sure you want to renumber all motions of this category?"),e=this.selectedCategory.getTitle();(yield this.promptService.open(t,e))&&(yield this.repo.numberMotionsInCategory(this.selectedCategory).catch(this.raiseError))}))}}return t.\u0275fac=function(e){return new(e||t)(u.Rb(m.c),u.Rb(h.k),u.Rb(g.a),u.Rb(c.a),u.Rb(y.a),u.Rb(c.f),u.Rb(r.a),u.Rb(F.a),u.Rb(l.a),u.Rb(M.g),u.Rb(W.b))},t.\u0275cmp=u.Lb({type:t,selectors:[["os-category-detail"]],viewQuery:function(t,e){var n;1&t&&(u.Mc(I,!0),u.Mc(L,!0)),2&t&&(u.Bc(n=u.gc())&&(e.editForm=n.first),u.Bc(n=u.gc())&&(e.editDialog=n.first))},features:[u.Cb],decls:36,vars:17,consts:[[3,"nav"],[1,"title-slot"],[4,"ngIf"],[1,"menu-slot"],[4,"osPerms"],[4,"ngFor","ngForOf"],["categoryMenu","matMenu"],["mat-menu-item","",3,"click"],["mat-menu-item","",3,"routerLink"],["mat-menu-item","",1,"red-warning-text",3,"click"],["editDialog",""],["type","button","mat-icon-button","",3,"matMenuTriggerFor"],["mat-table","",1,"os-headed-listview-table",3,"dataSource"],["matColumnDef","title"],[4,"matHeaderCellDef"],[4,"matCellDef"],["matColumnDef","state"],["class","chip-container",4,"matCellDef"],["matColumnDef","recommendation"],["matColumnDef","anchor"],[4,"matHeaderRowDef"],[4,"matRowDef","matRowDefColumns"],[1,"chip-container"],["disableRipple","",3,"ngClass"],["disableRipple","","class","bluegrey",4,"ngIf"],["disableRipple","",1,"bluegrey"],[3,"routerLink","state"],["mat-dialog-title",""],["mat-dialog-content","",1,"os-form-card-mobile"],[1,"edit-form",3,"formGroup","ngSubmit","keydown"],["matInput","","osAutofocus","","formControlName","prefix",3,"placeholder"],["matInput","","osAutofocus","","formControlName","name","required","",3,"placeholder"],["mat-dialog-actions",""],["type","submit","mat-button","","color","accent",3,"disabled","click"],["type","button","mat-button","",3,"mat-dialog-close"]],template:function(t,e){1&t&&(u.Xb(0,"os-head-bar",0),u.Xb(1,"div",1),u.Qc(2,Q,2,1,"h2",2),u.Wb(),u.Xb(3,"div",3),u.Qc(4,E,4,1,"div",4),u.Wb(),u.Wb(),u.Xb(5,"mat-card"),u.Qc(6,$,20,5,"div",5),u.Wb(),u.Xb(7,"mat-menu",null,6),u.Xb(9,"button",7),u.fc("click",(function(){return e.toggleEditMode()})),u.Xb(10,"mat-icon"),u.Sc(11,"edit"),u.Wb(),u.Xb(12,"span"),u.Sc(13),u.kc(14,"translate"),u.Wb(),u.Wb(),u.Xb(15,"button",8),u.Xb(16,"mat-icon"),u.Sc(17,"sort"),u.Wb(),u.Xb(18,"span"),u.Sc(19),u.kc(20,"translate"),u.Wb(),u.Wb(),u.Xb(21,"button",7),u.fc("click",(function(){return e.numberMotions()})),u.Xb(22,"mat-icon"),u.Sc(23,"format_list_numbered"),u.Wb(),u.Xb(24,"span"),u.Sc(25),u.kc(26,"translate"),u.Wb(),u.Wb(),u.Sb(27,"mat-divider"),u.Xb(28,"button",9),u.fc("click",(function(){return e.onDeleteButton()})),u.Xb(29,"mat-icon"),u.Sc(30,"delete"),u.Wb(),u.Xb(31,"span"),u.Sc(32),u.kc(33,"translate"),u.Wb(),u.Wb(),u.Wb(),u.Qc(34,Z,21,19,"ng-template",null,10,u.Rc)),2&t&&(u.rc("nav",!1),u.Fb(2),u.rc("ngIf",e.selectedCategory),u.Fb(2),u.rc("osPerms","motions.can_manage"),u.Fb(2),u.rc("ngForOf",e.categories),u.Fb(7),u.Tc(u.lc(14,9,"Edit")),u.Fb(2),u.rc("routerLink","./sort"),u.Fb(4),u.Tc(u.lc(20,11,"Sort motions")),u.Fb(6),u.Tc(u.lc(26,13,"Number motions")),u.Fb(7),u.Tc(u.lc(33,15,"Delete")))},directives:[f.a,o.t,X.a,p.a,o.s,w.f,w.c,_.a,c.g,k.a,x.b,w.e,O.o,O.c,O.i,O.b,O.k,O.n,O.h,O.a,R.a,o.q,c.i,O.j,O.m,W.i,W.f,M.J,M.u,M.l,j.c,D.b,M.d,T.a,M.t,M.j,M.E,W.c,W.d],pipes:[h.j],styles:[".title-line[_ngcontent-%COMP%]{font-weight:500;font-size:16px}.title-line[_ngcontent-%COMP%]   .icon-prefix[_ngcontent-%COMP%]   .mat-icon[_ngcontent-%COMP%]{display:-ms-inline-flexbox;display:inline-flex;vertical-align:middle;font-size:16px;height:16px;width:16px}.title-line[_ngcontent-%COMP%]   .favorite-star[_ngcontent-%COMP%]{padding-right:3px}.mat-table[_ngcontent-%COMP%]{width:100%}.mat-table[_ngcontent-%COMP%]   .mat-header-row[_ngcontent-%COMP%]   .mat-column-anchor[_ngcontent-%COMP%]{display:none}.mat-table[_ngcontent-%COMP%]   .mat-row[_ngcontent-%COMP%]{position:relative}.mat-table[_ngcontent-%COMP%]   .mat-row[_ngcontent-%COMP%]   .mat-column-anchor[_ngcontent-%COMP%]{position:absolute!important;top:0;right:0;bottom:0;left:0;opacity:.1;z-index:1}.mat-table[_ngcontent-%COMP%]   .mat-row[_ngcontent-%COMP%]   .mat-column-anchor[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{display:block;height:100%;width:100%}.mat-table[_ngcontent-%COMP%]   .mat-cell[_ngcontent-%COMP%]{position:relative}.mat-table[_ngcontent-%COMP%]   .mat-cell[_ngcontent-%COMP%]   .fill[_ngcontent-%COMP%]{position:absolute;display:inherit;height:100%;width:100%;line-height:0}.mat-table[_ngcontent-%COMP%]   .mat-cell[_ngcontent-%COMP%]   .fill[_ngcontent-%COMP%]   *[_ngcontent-%COMP%]{margin-top:auto;margin-bottom:auto}.mat-table[_ngcontent-%COMP%]   .mat-cell[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]{z-index:2}.mat-table[_ngcontent-%COMP%]   .mat-table-sticky[_ngcontent-%COMP%]{z-index:3!important}.block-title[_ngcontent-%COMP%]{padding:40px 40px 40px 25px;line-height:180%;font-size:120%;color:#317796}.block-title[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{margin:0;font-weight:400}.block-card[_ngcontent-%COMP%]{margin:0 20px;padding:25px}.block-card[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]   .mat-icon[_ngcontent-%COMP%]{margin-right:5px}.chip-container[_ngcontent-%COMP%]{display:block;min-height:0}.os-headed-listview-table[_ngcontent-%COMP%]   .mat-column-title[_ngcontent-%COMP%]{-ms-flex:4 0 0px;flex:4 0 0}.os-headed-listview-table[_ngcontent-%COMP%]   .mat-column-recommendation[_ngcontent-%COMP%], .os-headed-listview-table[_ngcontent-%COMP%]   .mat-column-state[_ngcontent-%COMP%]{-ms-flex:2 0 0px;flex:2 0 0}.os-headed-listview-table[_ngcontent-%COMP%]   .mat-column-remove[_ngcontent-%COMP%]{-ms-flex:1 0 0px;flex:1 0 0;-ms-flex-pack:end!important;justify-content:flex-end!important}.edit-form[_ngcontent-%COMP%]{overflow:hidden}"]}),t})();var et=n("AqIO"),nt=n("wL0i"),ot=n("0Obk"),it=n("4LpT"),ct=n("ZFy/");const at=["newCategoryDialog"];function st(t,e){if(1&t&&(u.Xb(0,"div",8),u.Xb(1,"button",9),u.Xb(2,"mat-icon"),u.Sc(3,"more_vert"),u.Wb(),u.Wb(),u.Wb()),2&t){u.jc();const t=u.Cc(10);u.Fb(1),u.rc("matMenuTriggerFor",t)}}function rt(t,e){if(1&t&&(u.Xb(0,"div",10),u.Sb(1,"a",11),u.Xb(2,"div"),u.Sc(3),u.Wb(),u.Wb()),2&t){const t=e.row,n=u.jc();u.Fb(1),u.rc("routerLink",t.id),u.Fb(1),u.Nc("margin-left",n.getMargin(t)),u.Fb(1),u.Tc(t.prefixedName)}}function lt(t,e){if(1&t&&(u.Xb(0,"div",10),u.Xb(1,"span",12),u.kc(2,"translate"),u.Sc(3),u.Wb(),u.Wb()),2&t){const t=e.row;u.Fb(1),u.sc("matTooltip",u.lc(2,2,"Motions")),u.Fb(2),u.Tc(t.motions.length)}}function bt(t,e){1&t&&(u.Xb(0,"mat-error"),u.Sc(1),u.kc(2,"translate"),u.Wb()),2&t&&(u.Fb(1),u.Uc(" ",u.lc(2,1,"A name is required")," "))}function dt(t,e){if(1&t){const t=u.Yb();u.Xb(0,"h1",13),u.Xb(1,"span"),u.Sc(2),u.kc(3,"translate"),u.Wb(),u.Wb(),u.Xb(4,"div",14),u.Xb(5,"form",15),u.fc("keydown",(function(e){return u.Gc(t),u.jc().onKeyDown(e)})),u.Xb(6,"p"),u.Xb(7,"mat-form-field"),u.Sb(8,"input",16),u.kc(9,"translate"),u.Wb(),u.Wb(),u.Xb(10,"p"),u.Xb(11,"mat-form-field"),u.Sb(12,"input",17),u.kc(13,"translate"),u.Qc(14,bt,3,3,"mat-error",18),u.Wb(),u.Wb(),u.Wb(),u.Wb(),u.Xb(15,"div",19),u.Xb(16,"button",20),u.Xb(17,"span"),u.Sc(18),u.kc(19,"translate"),u.Wb(),u.Wb(),u.Xb(20,"button",21),u.Xb(21,"span"),u.Sc(22),u.kc(23,"translate"),u.Wb(),u.Wb(),u.Wb()}if(2&t){const t=u.jc();u.Fb(2),u.Tc(u.lc(3,10,"New category")),u.Fb(3),u.rc("formGroup",t.createForm),u.Fb(3),u.sc("placeholder",u.lc(9,12,"Prefix")),u.Fb(4),u.sc("placeholder",u.lc(13,14,"Name")),u.Fb(2),u.rc("ngIf",!t.createForm.controls.name.valid),u.Fb(2),u.rc("disabled",!t.createForm.valid)("mat-dialog-close",!0),u.Fb(2),u.Tc(u.lc(19,16,"Save")),u.Fb(2),u.rc("mat-dialog-close",!1),u.Fb(2),u.Tc(u.lc(23,18,"Cancel"))}}const ut=function(){return["menu"]};let mt=(()=>{class t extends nt.a{constructor(t,e,n,o,i,c,a,s){super(t,e,n,o),this.repo=i,this.formBuilder=c,this.dialog=a,this.operator=s,this.tableColumnDefinition=[{prop:"title",width:"auto"},{prop:"amount",width:this.singleButtonWidth}],this.filterProps=["prefixedName"],this.createForm=this.formBuilder.group({prefix:[""],name:["",M.H.required],parent_id:[""]})}get canEdit(){return this.operator.hasPerms(y.b.motionsCanManage)}ngOnInit(){super.setTitle("Categories")}onPlusButton(){this.createForm.reset(),this.dialogRef=this.dialog.open(this.newCategoryDialog,P.a),this.dialogRef.afterClosed().subscribe(t=>{t&&this.save()})}save(){this.createForm.valid&&this.repo.create(this.createForm.value).catch(this.raiseError)}onKeyDown(t){"Enter"===t.key&&(this.save(),this.dialogRef.close()),"Escape"===t.key&&this.dialogRef.close()}getMargin(t){return 20*t.level+"px"}}return t.\u0275fac=function(e){return new(e||t)(u.Rb(m.c),u.Rb(h.k),u.Rb(g.a),u.Rb(et.a),u.Rb(r.a),u.Rb(M.g),u.Rb(W.b),u.Rb(y.a))},t.\u0275cmp=u.Lb({type:t,selectors:[["os-category-list"]],viewQuery:function(t,e){var n;1&t&&u.Mc(at,!0),2&t&&u.Bc(n=u.gc())&&(e.newCategoryDialog=n.first)},features:[u.Cb],decls:19,vars:20,consts:[["prevUrl","../..",3,"nav","hasMainButton","mainEvent"],[1,"title-slot"],["class","menu-slot",4,"osPerms"],["listStorageKey","category",3,"vScrollFixed","listObservableProvider","allowProjector","showListOfSpeakers","columns","filterProps","hiddenInMobile","dataSourceChange"],["class","cell-slot fill",4,"pblNgridCellDef"],["categoryMenu","matMenu"],["mat-menu-item","",3,"routerLink"],["newCategoryDialog",""],[1,"menu-slot"],["type","button","mat-icon-button","",3,"matMenuTriggerFor"],[1,"cell-slot","fill"],[1,"detail-link",3,"routerLink"],[1,"os-amount-chip",3,"matTooltip"],["mat-dialog-title",""],["mat-dialog-content","",1,"os-form-card-mobile"],[3,"formGroup","keydown"],["formControlName","prefix","matInput","",3,"placeholder"],["formControlName","name","matInput","","required","",3,"placeholder"],[4,"ngIf"],["mat-dialog-actions",""],["mat-button","",3,"disabled","mat-dialog-close"],["mat-button","",3,"mat-dialog-close"]],template:function(t,e){1&t&&(u.Xb(0,"os-head-bar",0),u.fc("mainEvent",(function(){return e.onPlusButton()})),u.Xb(1,"div",1),u.Xb(2,"h2"),u.Sc(3),u.kc(4,"translate"),u.Wb(),u.Wb(),u.Qc(5,st,4,1,"div",2),u.Wb(),u.Xb(6,"os-list-view-table",3),u.fc("dataSourceChange",(function(t){return e.onDataSourceChange(t)})),u.Qc(7,rt,4,4,"div",4),u.Qc(8,lt,4,4,"div",4),u.Wb(),u.Xb(9,"mat-menu",null,5),u.Xb(11,"button",6),u.Xb(12,"mat-icon"),u.Sc(13,"sort"),u.Wb(),u.Xb(14,"span"),u.Sc(15),u.kc(16,"translate"),u.Wb(),u.Wb(),u.Wb(),u.Qc(17,dt,24,20,"ng-template",null,7,u.Rc)),2&t&&(u.rc("nav",!1)("hasMainButton",e.canEdit),u.Fb(3),u.Tc(u.lc(4,15,"Categories")),u.Fb(2),u.rc("osPerms","motions.can_manage"),u.Fb(1),u.rc("vScrollFixed",64)("listObservableProvider",e.repo)("allowProjector",!1)("showListOfSpeakers",!1)("columns",e.tableColumnDefinition)("filterProps",e.filterProps)("hiddenInMobile",u.wc(19,ut)),u.Fb(1),u.rc("pblNgridCellDef","title"),u.Fb(1),u.rc("pblNgridCellDef","amount"),u.Fb(3),u.rc("routerLink","./sort"),u.Fb(4),u.Tc(u.lc(16,17,"Sort categories")))},directives:[f.a,X.a,ot.a,it.b,w.f,w.c,c.g,_.a,x.b,w.e,c.i,ct.c,W.i,W.f,M.J,M.u,M.l,j.c,M.d,D.b,M.t,M.j,M.E,o.t,W.c,W.d,j.b],pipes:[h.j],styles:[".title-line[_ngcontent-%COMP%]{font-weight:500;font-size:16px}.title-line[_ngcontent-%COMP%]   .icon-prefix[_ngcontent-%COMP%]   .mat-icon[_ngcontent-%COMP%]{display:-ms-inline-flexbox;display:inline-flex;vertical-align:middle;font-size:16px;height:16px;width:16px}.title-line[_ngcontent-%COMP%]   .favorite-star[_ngcontent-%COMP%]{padding-right:3px}.mat-table[_ngcontent-%COMP%]{width:100%}.mat-table[_ngcontent-%COMP%]   .mat-header-row[_ngcontent-%COMP%]   .mat-column-anchor[_ngcontent-%COMP%]{display:none}.mat-table[_ngcontent-%COMP%]   .mat-row[_ngcontent-%COMP%]{position:relative}.mat-table[_ngcontent-%COMP%]   .mat-row[_ngcontent-%COMP%]   .mat-column-anchor[_ngcontent-%COMP%]{position:absolute!important;top:0;right:0;bottom:0;left:0;opacity:.1;z-index:1}.mat-table[_ngcontent-%COMP%]   .mat-row[_ngcontent-%COMP%]   .mat-column-anchor[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{display:block;height:100%;width:100%}.mat-table[_ngcontent-%COMP%]   .mat-cell[_ngcontent-%COMP%]{position:relative}.mat-table[_ngcontent-%COMP%]   .mat-cell[_ngcontent-%COMP%]   .fill[_ngcontent-%COMP%]{position:absolute;display:inherit;height:100%;width:100%;line-height:0}.mat-table[_ngcontent-%COMP%]   .mat-cell[_ngcontent-%COMP%]   .fill[_ngcontent-%COMP%]   *[_ngcontent-%COMP%]{margin-top:auto;margin-bottom:auto}.mat-table[_ngcontent-%COMP%]   .mat-cell[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]{z-index:2}.mat-table[_ngcontent-%COMP%]   .mat-table-sticky[_ngcontent-%COMP%]{z-index:3!important}"]}),t})();var ht=n("2Vo4"),gt=n("Jc+d"),ft=n("IBZR");const pt=["sorter"];function vt(t,e){if(1&t&&(u.Xb(0,"h2"),u.Sc(1),u.kc(2,"translate"),u.Wb()),2&t){const t=u.jc();u.Fb(1),u.Vc("",u.lc(2,2,"Sort motions")," (",t.category.prefixedName,")")}}function Ct(t,e){if(1&t){const t=u.Yb();u.Xb(0,"div"),u.Xb(1,"span"),u.Sc(2),u.Wb(),u.Xb(3,"span"),u.Sc(4),u.kc(5,"translate"),u.Wb(),u.Xb(6,"button",6),u.fc("click",(function(){return u.Gc(t),u.jc().moveToPosition()})),u.Xb(7,"span"),u.Sc(8),u.kc(9,"translate"),u.Wb(),u.Wb(),u.Wb()}if(2&t){const t=u.jc();u.Fb(2),u.Uc("",t.sortSelector.multiSelectedIndex.length,"\xa0"),u.Fb(2),u.Tc(u.lc(5,3,"selected")),u.Fb(4),u.Tc(u.lc(9,5,"move ..."))}}function St(t,e){if(1&t&&(u.Xb(0,"mat-basic-chip",7),u.kc(1,"translate"),u.Sc(2),u.Wb()),2&t){const t=e.$implicit;u.sc("matTooltip",u.lc(1,2,"Sequential number")),u.Fb(2),u.Uc(" ",t.id," ")}}const Mt=[{path:"",component:mt,pathMatch:"full"},{path:":id/sort",component:(()=>{class t extends d.a{constructor(t,e,n,o,i,c,a,s){super(t,e,n),this.translate=e,this.promptService=o,this.repo=i,this.route=c,this.motionRepo=a,this.choiceService=s,this.motionsSubject=new ht.a([]),this.motionsCount=0,this.hasChanged=!1,this.motionsCopy=[],this.motionsBackup=[]}get isMultiSelect(){return this.sortSelector.multiSelectedIndex.length>0}get motionObservable(){return this.motionsSubject.asObservable()}ngOnInit(){const t=+this.route.snapshot.params.id;this.repo.getViewModelObservable(t).subscribe(t=>{this.category=t}),this.motionRepo.getViewModelListObservable().subscribe(e=>{const n=e.filter(e=>e.category_id===t);this.motionsBackup=[...n],this.motionsCount=n.length,0===this.motionsCopy.length?this.initializeList(n):this.motionsSubject.next(this.handleMotionUpdates(n))})}initializeList(t){t.sort((t,e)=>t.category_weight-e.category_weight),this.motionsSubject.next(t),this.motionsCopy=t}onListUpdate(t){this.hasChanged=!0,this.motionsCopy=t}onCancel(){return Object(s.a)(this,void 0,void 0,(function*(){(yield this.canDeactivate())&&(this.motionsSubject.next([]),this.initializeList(this.motionsBackup),this.hasChanged=!1)}))}sendUpdate(){return Object(s.a)(this,void 0,void 0,(function*(){const t=this.translate.instant("Do you really want to save your changes?");if(yield this.promptService.open(t)){const t=this.motionsCopy.map(t=>t.id);this.repo.sortMotionsInCategory(this.category.category,t),this.hasChanged=!1}}))}handleMotionUpdates(t){const e=this.motionsCopy;if(t.length>e.length)for(const n of t)this.motionsCopy.includes(n)||e.push(n);else if(t.length<e.length)for(const n of e)t.includes(n)||e.splice(e.indexOf(n),1);else for(const n of e)if(!t.includes(n)){const o=t.find(t=>t.id===n.id);e.splice(e.indexOf(n),1,o)}return e}canDeactivate(){return Object(s.a)(this,void 0,void 0,(function*(){if(this.hasChanged){const t=this.translate.instant("Do you really want to exit this page?"),e=this.translate.instant("You made changes.");return yield this.promptService.open(t,e)}return!0}))}moveToPosition(){return Object(s.a)(this,void 0,void 0,(function*(){if(this.sortSelector.multiSelectedIndex.length){const t=this.translate.instant("Move selected items ..."),e=this.sortSelector.sortedItems.filter(t=>!this.sortSelector.multiSelectedIndex.includes(t.id)),n=[this.translate.instant("Insert before"),this.translate.instant("Insert behind")],o=yield this.choiceService.open(t,e,!1,n);o&&this.sortSelector.drop({currentIndex:o.items,previousIndex:null},o.action===n[1])}}))}}return t.\u0275fac=function(e){return new(e||t)(u.Rb(m.c),u.Rb(h.k),u.Rb(g.a),u.Rb(l.a),u.Rb(r.a),u.Rb(c.a),u.Rb(F.a),u.Rb(gt.a))},t.\u0275cmp=u.Lb({type:t,selectors:[["os-category-motions-sort"]],viewQuery:function(t,e){var n;1&t&&u.Mc(pt,!0),2&t&&u.Bc(n=u.gc())&&(e.sortSelector=n.first)},features:[u.Cb],decls:8,vars:5,consts:[[3,"editMode","nav","saveEvent","mainEvent"],[1,"title-slot"],[4,"ngIf"],[1,"os-form-card"],[3,"input","sortEvent"],["sorter",""],["mat-button","",3,"click"],["disableRipple","",1,"bluegrey",3,"matTooltip"]],template:function(t,e){1&t&&(u.Xb(0,"os-head-bar",0),u.fc("saveEvent",(function(){return e.sendUpdate()}))("mainEvent",(function(){return e.onCancel()})),u.Xb(1,"div",1),u.Qc(2,vt,3,4,"h2",2),u.Wb(),u.Wb(),u.Xb(3,"mat-card",3),u.Qc(4,Ct,10,7,"div",2),u.Xb(5,"os-sorting-list",4,5),u.fc("sortEvent",(function(t){return e.onListUpdate(t)})),u.Qc(7,St,3,4,"ng-template"),u.Wb(),u.Wb()),2&t&&(u.rc("editMode",e.hasChanged)("nav",!1),u.Fb(2),u.rc("ngIf",e.category),u.Fb(2),u.rc("ngIf",e.isMultiSelect),u.Fb(1),u.rc("input",e.motionObservable))},directives:[f.a,o.t,p.a,ft.a,x.b,R.a,ct.c],pipes:[h.j],styles:[""]}),t})(),canDeactivate:[a.a]},{path:"sort",component:S,canDeactivate:[a.a]},{path:":id",component:tt}];let Ot=(()=>{class t{}return t.\u0275mod=u.Pb({type:t}),t.\u0275inj=u.Ob({factory:function(e){return new(e||t)},imports:[[c.j.forChild(Mt)],c.j]}),t})(),yt=(()=>{class t{}return t.\u0275mod=u.Pb({type:t}),t.\u0275inj=u.Ob({factory:function(e){return new(e||t)},imports:[[o.c,Ot,i.a]]}),t})()},F48D:function(t,e,n){"use strict";n.d(e,"a",(function(){return s}));var o=n("mrSG"),i=n("LBBb"),c=n("8Y7J"),a=n("iELJ");let s=(()=>{class t{constructor(t){this.dialog=t}open(t,e=""){return Object(o.a)(this,void 0,void 0,(function*(){return this.dialog.open(i.a,{width:"290px",data:{title:t,content:e}}).afterClosed().toPromise()}))}}return t.\u0275fac=function(e){return new(e||t)(c.bc(a.b))},t.\u0275prov=c.Nb({token:t,factory:t.\u0275fac,providedIn:"root"}),t})()},"Jc+d":function(t,e,n){"use strict";n.d(e,"a",(function(){return M}));var o=n("mrSG"),i=n("Izkr"),c=n("iELJ"),a=n("8Y7J"),s=n("s7LF"),r=n("SVse"),l=n("Dxy4"),b=n("oqD5"),d=n("TSSN");function u(t,e){if(1&t&&(a.Xb(0,"h2",2),a.Sc(1),a.kc(2,"translate"),a.Wb()),2&t){const t=a.jc();a.Fb(1),a.Tc(a.lc(2,1,t.data.title))}}function m(t,e){if(1&t&&(a.Xb(0,"div",9),a.Sb(1,"os-search-value-selector",10),a.Wb()),2&t){const t=a.jc(2);a.Fb(1),a.rc("multiple",t.data.multiSelect)("formControl",t.selectForm.get("select"))("inputListValues",t.data.choices)}}function h(t,e){if(1&t){const t=a.Yb();a.Xb(0,"button",12),a.fc("click",(function(){a.Gc(t);const n=e.$implicit;return a.jc(3).closeDialog(!0,n)})),a.Xb(1,"span"),a.Sc(2),a.kc(3,"translate"),a.Wb(),a.Wb()}if(2&t){const t=e.$implicit,n=a.jc(3);a.rc("disabled",!n.hasSelection),a.Fb(2),a.Tc(a.lc(3,2,t))}}function g(t,e){if(1&t&&(a.Xb(0,"div"),a.Qc(1,h,4,4,"button",11),a.Wb()),2&t){const t=a.jc(2);a.Fb(1),a.rc("ngForOf",t.data.actionButtons)}}function f(t,e){if(1&t){const t=a.Yb();a.Xb(0,"button",12),a.fc("click",(function(){return a.Gc(t),a.jc(3).closeDialog(!0)})),a.Xb(1,"span"),a.Sc(2,"OK"),a.Wb(),a.Wb()}if(2&t){const t=a.jc(3);a.rc("disabled",!t.hasSelection)}}function p(t,e){if(1&t&&(a.Xb(0,"div"),a.Qc(1,f,3,1,"button",13),a.Wb()),2&t){const t=a.jc(2);a.Fb(1),a.rc("ngIf",!t.data.multiSelect||t.data.choices)}}function v(t,e){if(1&t){const t=a.Yb();a.Xb(0,"button",8),a.fc("click",(function(){a.Gc(t);const e=a.jc(2);return e.closeDialog(!0,e.data.clearChoice)})),a.Xb(1,"span"),a.Sc(2),a.Wb(),a.Wb()}if(2&t){const t=a.jc(2);a.Fb(2),a.Tc(t.data.clearChoice)}}function C(t,e){if(1&t){const t=a.Yb();a.Xb(0,"form",3),a.Qc(1,m,2,3,"div",4),a.Xb(2,"div",5),a.Qc(3,g,2,1,"div",6),a.Qc(4,p,2,1,"div",6),a.Qc(5,v,3,1,"button",7),a.Xb(6,"button",8),a.fc("click",(function(){return a.Gc(t),a.jc().closeDialog(!1)})),a.Xb(7,"span"),a.Sc(8),a.kc(9,"translate"),a.Wb(),a.Wb(),a.Wb(),a.Wb()}if(2&t){const t=a.jc();a.rc("formGroup",t.selectForm),a.Fb(1),a.rc("ngIf",t.data.choices),a.Fb(2),a.rc("ngIf",t.data.actionButtons),a.Fb(1),a.rc("ngIf",!t.data.actionButtons),a.Fb(1),a.rc("ngIf",t.data.clearChoice),a.Fb(3),a.Tc(a.lc(9,6,"Cancel"))}}let S=(()=>{class t{constructor(t,e,n){this.dialogRef=t,this.formBuilder=e,this.data=n,this.selectedMultiChoices=[],this.selectForm=this.formBuilder.group({select:[]})}get hasSelection(){return!(this.data&&this.data.choices&&(!this.selectForm.get("select").value||!this.selectForm.get("select").value&&!this.selectForm.get("select").value.length))}closeDialog(t,e){this.data.multiSelect||null!==this.selectedChoice||(e=this.data.clearChoice),t?this.dialogRef.close({action:e||null,items:this.selectForm.get("select").value}):this.dialogRef.close()}}return t.\u0275fac=function(e){return new(e||t)(a.Rb(c.h),a.Rb(s.g),a.Rb(c.a))},t.\u0275cmp=a.Lb({type:t,selectors:[["os-choice-dialog"]],decls:2,vars:2,consts:[["mat-dialog-title","",4,"ngIf"],[3,"formGroup",4,"ngIf"],["mat-dialog-title",""],[3,"formGroup"],["mat-dialog-content","",4,"ngIf"],["mat-dialog-actions",""],[4,"ngIf"],["mat-button","",3,"click",4,"ngIf"],["mat-button","",3,"click"],["mat-dialog-content",""],["ngDefaultControl","",3,"multiple","formControl","inputListValues"],["mat-button","",3,"disabled","click",4,"ngFor","ngForOf"],["mat-button","",3,"disabled","click"],["mat-button","",3,"disabled","click",4,"ngIf"]],template:function(t,e){1&t&&(a.Qc(0,u,3,3,"h2",0),a.Qc(1,C,10,8,"form",1)),2&t&&(a.rc("ngIf",e.data),a.Fb(1),a.rc("ngIf",e.data))},directives:[r.t,c.i,s.J,s.u,s.l,c.c,l.b,c.f,b.a,s.d,s.t,s.i,r.s],pipes:[d.j],styles:[".mat-form-field{width:100%}"],encapsulation:2}),t})(),M=(()=>{class t{constructor(t){this.dialog=t}open(t,e,n=!1,c,a){return Object(o.a)(this,void 0,void 0,(function*(){return this.dialog.open(S,Object.assign(Object.assign({},i.a),{data:{title:t,choices:e,multiSelect:n,actionButtons:c,clearChoice:a}})).afterClosed().toPromise()}))}}return t.\u0275fac=function(e){return new(e||t)(a.bc(c.b))},t.\u0275prov=a.Nb({token:t,factory:t.\u0275fac,providedIn:"root"}),t})()},LBBb:function(t,e,n){"use strict";n.d(e,"a",(function(){return l}));var o=n("iELJ"),i=n("8Y7J"),c=n("SVse"),a=n("Dxy4"),s=n("TSSN");function r(t,e){if(1&t&&(i.Xb(0,"div"),i.Xb(1,"h2",1),i.Sc(2),i.Wb(),i.Sb(3,"mat-dialog-content",2),i.Xb(4,"mat-dialog-actions"),i.Xb(5,"button",3),i.Sc(6),i.kc(7,"translate"),i.Wb(),i.Xb(8,"button",4),i.Sc(9),i.kc(10,"translate"),i.Wb(),i.Wb(),i.Wb()),2&t){const t=i.jc();i.Fb(2),i.Tc(t.data.title),i.Fb(1),i.rc("innerHTML",t.data.content,i.Hc),i.Fb(2),i.rc("mat-dialog-close",!0),i.Fb(1),i.Tc(i.lc(7,6,"OK")),i.Fb(2),i.rc("mat-dialog-close",!1),i.Fb(1),i.Tc(i.lc(10,8,"Cancel"))}}let l=(()=>{class t{constructor(t,e){this.dialogRef=t,this.data=e}}return t.\u0275fac=function(e){return new(e||t)(i.Rb(o.h),i.Rb(o.a))},t.\u0275cmp=i.Lb({type:t,selectors:[["os-prompt-dialog"]],decls:1,vars:1,consts:[[4,"ngIf"],["mat-dialog-title",""],[3,"innerHTML"],["mat-button","","color","warn",3,"mat-dialog-close"],["mat-button","",3,"mat-dialog-close"]],template:function(t,e){1&t&&i.Qc(0,r,11,10,"div",0),2&t&&i.rc("ngIf",e.data)},directives:[c.t,o.i,o.f,o.c,a.b,o.d],pipes:[s.j],encapsulation:2}),t})()},wL0i:function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));var o=n("mV3u");class i extends o.a{constructor(t,e,n,o){super(t,e,n),this.storage=o,this.canMultiSelect=!1,this._multiSelectMode=!1,this.singleButtonWidth="40px",this.badgeButtonWidth="45px",this.selectedRows=[]}onDataSourceChange(t){this.dataSource=t}toggleMultiSelect(){!this.canMultiSelect||this.isMultiSelect?(this._multiSelectMode=!1,this.deselectAll()):this._multiSelectMode=!0}selectAll(){this.dataSource.selection.select(...this.dataSource.filteredData)}deselectAll(){this.dataSource&&this.dataSource.selection.clear()}get isMultiSelect(){return this._multiSelectMode}}}}]);