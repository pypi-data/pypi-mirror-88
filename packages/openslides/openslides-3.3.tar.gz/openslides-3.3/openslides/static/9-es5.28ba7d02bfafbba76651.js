!function(){function t(t){return function(t){if(Array.isArray(t))return e(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||function(t,n){if(!t)return;if("string"==typeof t)return e(t,n);var o=Object.prototype.toString.call(t).slice(8,-1);"Object"===o&&t.constructor&&(o=t.constructor.name);if("Map"===o||"Set"===o)return Array.from(t);if("Arguments"===o||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o))return e(t,n)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function e(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,o=new Array(e);n<e;n++)o[n]=t[n];return o}function n(t,e,o){return(n="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var o=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=b(t)););return t}(t,e);if(o){var r=Object.getOwnPropertyDescriptor(o,e);return r.get?r.get.call(n):r.value}})(t,e,o||t)}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function i(t,e,n){return e&&r(t.prototype,e),n&&r(t,n),t}function c(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&a(t,e)}function a(t,e){return(a=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function l(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,o=b(t);if(e){var r=b(this).constructor;n=Reflect.construct(o,arguments,r)}else n=o.apply(this,arguments);return s(this,n)}}function s(t,e){return!e||"object"!=typeof e&&"function"!=typeof e?u(t):e}function u(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function b(t){return(b=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}(window.webpackJsonp=window.webpackJsonp||[]).push([[9,44],{"76GY":function(t,e,n){"use strict";n.d(e,"a",(function(){return X}));var r=n("w7eE"),a=n("OwvW"),s=n("qnZ9"),u=n("ykax"),b=n("8Y7J"),p=n("cUpR"),f=n("TSSN"),d=n("SVse"),v=n("iCsr"),h=n("vYAO"),g=n("j7f2"),m=n("6ako"),y=n("QUb3");function k(t,e){if(1&t&&(b.Xb(0,"os-icon-container",10),b.Sc(1),b.kc(2,"translate"),b.kc(3,"pollKeyVerbose"),b.Wb()),2&t){var n=b.jc().$implicit,o=b.jc(3);b.rc("icon",n.value[0].icon)("size",o.iconSize),b.Fb(1),b.Uc(" ",b.lc(2,3,b.lc(3,5,n.votingOption))," ")}}function S(t,e){if(1&t&&(b.Xb(0,"span"),b.Sc(1),b.kc(2,"translate"),b.kc(3,"pollKeyVerbose"),b.Wb()),2&t){var n=b.jc().$implicit;b.Fb(1),b.Uc(" ",b.lc(2,1,b.lc(3,3,n.votingOption))," ")}}function F(t,e){if(1&t&&(b.Xb(0,"span"),b.Sc(1),b.kc(2,"pollPercentBase"),b.Wb()),2&t){var n=b.jc().$implicit,o=b.jc(3);b.Fb(1),b.Uc(" ",b.nc(2,1,n.value[0].amount,o.poll,"motion")," ")}}function w(t,e){if(1&t&&(b.Xb(0,"tr"),b.Xb(1,"td"),b.Qc(2,k,4,7,"os-icon-container",8),b.Qc(3,S,4,5,"span",2),b.Wb(),b.Xb(4,"td",9),b.Qc(5,F,3,5,"span",2),b.Wb(),b.Xb(6,"td",9),b.Sc(7),b.kc(8,"parsePollNumber"),b.Wb(),b.Wb()),2&t){var n=e.$implicit;b.Hb(n.votingOption),b.Fb(2),b.rc("ngIf",n.value[0].icon),b.Fb(1),b.rc("ngIf",!n.value[0].icon),b.Fb(2),b.rc("ngIf",n.value[0].showPercent),b.Fb(2),b.Uc(" ",b.lc(8,6,n.value[0].amount)," ")}}function O(t,e){if(1&t&&(b.Vb(0),b.Xb(1,"table",3),b.Xb(2,"tbody"),b.Xb(3,"tr"),b.Sb(4,"th"),b.Xb(5,"th",4),b.Sc(6),b.kc(7,"translate"),b.Wb(),b.Wb(),b.Qc(8,w,9,8,"tr",5),b.Wb(),b.Wb(),b.Xb(9,"div",6),b.Sb(10,"os-charts",7),b.Wb(),b.Ub()),2&t){var n=b.jc(2);b.Fb(6),b.Tc(b.lc(7,4,"Votes")),b.Fb(2),b.rc("ngForOf",n.tableData)("ngForTrackBy",n.trackByIndex),b.Fb(2),b.rc("data",n.chartData)}}function P(t,e){1&t&&(b.Xb(0,"div"),b.Xb(1,"i"),b.Sc(2),b.kc(3,"translate"),b.Wb(),b.Wb()),2&t&&(b.Fb(2),b.Uc(" ",b.lc(3,1,"No results yet.")," "))}function j(t,e){1&t&&(b.Xb(0,"div"),b.Xb(1,"i"),b.Sc(2),b.kc(3,"translate"),b.Wb(),b.Wb()),2&t&&(b.Fb(2),b.Uc(" ",b.lc(3,1,"Counting of votes is in progress ...")," "))}function W(t,e){if(1&t&&(b.Xb(0,"div",1),b.Qc(1,O,11,6,"ng-container",2),b.Qc(2,P,4,3,"div",2),b.Qc(3,j,4,3,"div",2),b.Wb()),2&t){var n=b.jc();b.Fb(1),b.rc("ngIf",n.hasResults&&n.canSeeResults),b.Fb(1),b.rc("ngIf",!n.hasResults),b.Fb(1),b.rc("ngIf",n.hasResults&&!n.canSeeResults)}}var X=function(){var t=function(t){c(n,t);var e=l(n);function n(t,r,i,c,a){var l;return o(this,n),(l=e.call(this,t,r)).pollService=i,l.cd=c,l.operator=a,l.iconSize="large",l}return i(n,[{key:"setTableData",value:function(){this.tableData=this.pollService.generateTableData(this.poll)}},{key:"setChartData",value:function(){this.chartData=this.pollService.generateChartData(this.poll)}},{key:"poll",set:function(t){this._poll=t,this.setTableData(),this.setChartData(),this.cd.markForCheck()},get:function(){return this._poll}},{key:"state",get:function(){return this.poll.state}},{key:"hasResults",get:function(){return this.isFinished||this.isPublished}},{key:"isFinished",get:function(){return this.state===s.e.Finished}},{key:"isPublished",get:function(){return this.state===s.e.Published}},{key:"canSeeResults",get:function(){return this.operator.hasPerms(this.permission.motionsCanManagePolls)||this.isPublished}}]),n}(r.a);return t.\u0275fac=function(e){return new(e||t)(b.Rb(p.c),b.Rb(f.k),b.Rb(u.a),b.Rb(b.h),b.Rb(a.a))},t.\u0275cmp=b.Lb({type:t,selectors:[["os-motion-poll-detail-content"]],inputs:{poll:"poll",iconSize:"iconSize"},features:[b.Cb],decls:1,vars:1,consts:[["class","result-wrapper",4,"ngIf"],[1,"result-wrapper"],[4,"ngIf"],[1,"result-table"],["colspan","2"],[3,"class",4,"ngFor","ngForOf","ngForTrackBy"],[1,"doughnut-chart"],["type","doughnut",3,"data"],[3,"icon","size",4,"ngIf"],[1,"result-cell-definition"],[3,"icon","size"]],template:function(t,e){1&t&&b.Qc(0,W,4,3,"div",0),2&t&&b.rc("ngIf",e.poll)},directives:[d.t,d.s,v.a,h.a],pipes:[f.j,g.a,m.a,y.a],styles:[".yes[_ngcontent-%COMP%]{color:#4caf50}.no[_ngcontent-%COMP%]{color:#cc6c5b}.abstain[_ngcontent-%COMP%]{color:#a6a6a6}.voted-yes[_ngcontent-%COMP%]{background-color:#4caf50;color:#fff}.voted-no[_ngcontent-%COMP%]{background-color:#cc6c5b;color:#fff}.voted-abstain[_ngcontent-%COMP%]{background-color:#a6a6a6;color:#fff}.start-poll-button[_ngcontent-%COMP%]{color:#4caf50}.stop-poll-button[_ngcontent-%COMP%]{color:#ff5252}.publish-poll-button[_ngcontent-%COMP%]{color:#e6b100}.result-wrapper[_ngcontent-%COMP%]{display:grid;grid-gap:2em;margin:2em;grid-template-columns:repeat(auto-fit,minmax(150px,1fr))}.result-wrapper[_ngcontent-%COMP%]   .result-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{text-align:right;font-weight:400}.result-wrapper[_ngcontent-%COMP%]   .result-table[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]{height:48px;border-bottom:none!important}.result-wrapper[_ngcontent-%COMP%]   .result-table[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   .result-cell-definition[_ngcontent-%COMP%]{text-align:right}.result-wrapper[_ngcontent-%COMP%]   .doughnut-chart[_ngcontent-%COMP%]{display:block}"],changeDetection:0}),t}()},DNKu:function(t,e,n){"use strict";n.d(e,"a",(function(){return b}));var r=n("mrSG"),c=n("TG9O"),a=n("qnZ9"),l=n("Izkr"),s=n("8Y7J"),u=n("iELJ"),b=function(){var t=function(){function t(e,n){o(this,t),this.dialog=e,this.mapper=n}return i(t,[{key:"openDialog",value:function(t){return Object(r.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){var n,o,r,i;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=this.dialog.open(this.dialogComponent,Object.assign({data:t},l.c)),e.next=3,n.afterClosed().toPromise();case 3:if(!(o=e.sent)){e.next=15;break}if(r=this.mapper.getRepository(t.collectionString),!t.poll){e.next=13;break}return i=o,t.state!==a.e.Created&&(i={title:o.title,onehundred_percent_base:o.onehundred_percent_base,majority_method:o.majority_method,description:o.description},t.type===a.f.Analog&&(i=Object.assign(Object.assign({},i),{votes:o.votes,publish_immediately:o.publish_immediately}))),e.next=11,r.patch(i,t);case 11:e.next=15;break;case 13:return e.next=15,r.create(o);case 15:case"end":return e.stop()}}),e,this)})))}}]),t}();return t.\u0275fac=function(e){return new(e||t)(s.bc(u.b),s.bc(c.a))},t.\u0275prov=s.Nb({token:t,factory:t.\u0275fac,providedIn:"root"}),t}()},SHqy:function(t,e,n){"use strict";n.d(e,"a",(function(){return b}));var r=n("TG9O"),i=n("DNKu"),a=n("cMzF"),s=n("8Y7J"),u=n("iELJ"),b=function(){var t=function(t){c(n,t);var e=l(n);function n(t,r){var i;return o(this,n),(i=e.call(this,t,r)).dialogComponent=a.a,i}return n}(i.a);return t.\u0275fac=function(e){return new(e||t)(s.bc(u.b),s.bc(r.a))},t.\u0275prov=s.Nb({token:t,factory:t.\u0275fac,providedIn:"root"}),t}()},bVYn:function(t,e,r){"use strict";r.r(e),r.d(e,"PollsModule",(function(){return B}));var a,s=r("SVse"),p=r("iInd"),f=r("AqIO"),d=r("M0z7"),v=r("wL0i"),h=r("D/ll"),g=r("+8Rz"),m=r("qnZ9"),y=r("8Y7J"),k=r("TSSN"),S=((a=function(t){c(n,t);var e=l(n);function n(t,r,i){var c;return o(this,n),(c=e.call(this,t,r)).translate=i,c.storageKey="PollList",c}return i(n,[{key:"preFilter",value:function(t){return t.filter((function(t){return!t.isAnalog}))}},{key:"getFilterDefinitions",value:function(){return[{property:"state",label:this.translate.instant("State"),options:[{condition:m.e.Created,label:this.translate.instant("created")},{condition:m.e.Started,label:this.translate.instant("started")},{condition:m.e.Finished,label:this.translate.instant("finished (unpublished)")},{condition:m.e.Published,label:this.translate.instant("published")}]},{property:"hasVote",label:this.translate.instant("Votings"),options:[{condition:!1,label:this.translate.instant("Voting is currently in progress.")},{condition:!0,label:this.translate.instant("You have already voted.")}]}]}}]),n}(g.a)).\u0275fac=function(t){return new(t||a)(y.bc(f.a),y.bc(h.a),y.bc(k.k))},a.\u0275prov=y.Nb({token:a,factory:a.\u0275fac,providedIn:"root"}),a),F=r("PoOO"),w=r("cUpR"),O=r("zHaW"),P=r("mksl"),j=r("0Obk"),W=r("4LpT"),X=r("Tj54"),C=r("ZFy/");function D(t,e){if(1&t&&y.Sb(0,"a",5),2&t){var n=y.jc().row;y.rc("routerLink",n.parentLink)}}function R(t,e){if(1&t&&(y.Xb(0,"div",3),y.Qc(1,D,1,1,"a",4),y.Xb(2,"span"),y.Sc(3),y.Wb(),y.Wb()),2&t){var n=e.row,o=y.jc();y.Fb(1),y.rc("ngIf",!o.isMultiSelect),y.Fb(2),y.Tc(n.title)}}function V(t,e){if(1&t&&y.Sb(0,"a",5),2&t){var n=y.jc().row;y.rc("routerLink",n.parentLink)}}function T(t,e){if(1&t&&(y.Xb(0,"div",3),y.Qc(1,V,1,1,"a",4),y.Xb(2,"span"),y.Sc(3),y.Wb(),y.Wb()),2&t){var n=e.row,o=y.jc();y.Fb(1),y.rc("ngIf",!o.isMultiSelect),y.Fb(2),y.Tc(n.getContentObject().getListTitle())}}function _(t,e){if(1&t&&y.Sb(0,"a",5),2&t){var n=y.jc().row;y.rc("routerLink",n.parentLink)}}function x(t,e){if(1&t&&(y.Xb(0,"div",3),y.Qc(1,_,1,1,"a",4),y.Xb(2,"span"),y.Sc(3),y.kc(4,"translate"),y.Wb(),y.Wb()),2&t){var n=e.row,o=y.jc();y.Fb(1),y.rc("ngIf",!o.isMultiSelect),y.Fb(2),y.Tc(y.lc(4,2,n.stateVerbose))}}function M(t,e){1&t&&(y.Xb(0,"mat-icon",8),y.kc(1,"translate"),y.Sc(2," check_circle "),y.Wb()),2&t&&y.sc("matTooltip",y.lc(1,1,"You have already voted."))}function I(t,e){1&t&&(y.Xb(0,"mat-icon",9),y.kc(1,"translate"),y.Sc(2," warning "),y.Wb()),2&t&&y.sc("matTooltip",y.lc(1,1,"Voting is currently in progress."))}function Q(t,e){if(1&t&&(y.Xb(0,"div",3),y.Qc(1,M,3,3,"mat-icon",6),y.Qc(2,I,3,3,"mat-icon",7),y.Wb()),2&t){var n=e.row;y.Fb(1),y.rc("ngIf",n.hasVote),y.Fb(1),y.rc("ngIf",!n.hasVote&&null!==n.hasVote)}}var N,L,A,U=[{path:"",component:(N=function(t){c(r,t);var e=l(r);function r(t,i,c,a,l,s,p){var f,d;return o(this,r),(d=e.call(this,l,s,p,a)).polls=t,d.filterService=i,d.votingService=c,d.storage=a,d.tableColumnDefinition=[{prop:"title",width:"auto"},{prop:"classType",width:"auto"},{prop:"state",width:"auto"},{prop:"votability",width:"25px"}],d.filterProps=["title","state"],n((f=u(d),b(r.prototype)),"setTitle",f).call(f,"List of electronic votes"),d}return r}(v.a),N.\u0275fac=function(t){return new(t||N)(y.Rb(F.a),y.Rb(S),y.Rb(d.b),y.Rb(f.a),y.Rb(w.c),y.Rb(k.k),y.Rb(O.a))},N.\u0275cmp=y.Lb({type:N,selectors:[["os-poll-list"]],features:[y.Cb],decls:9,vars:12,consts:[[1,"title-slot"],["listStorageKey","polls",3,"listObservableProvider","vScrollFixed","columns","filterProps","filterService"],["class","cell-slot fill",4,"pblNgridCellDef"],[1,"cell-slot","fill"],["class","detail-link",3,"routerLink",4,"ngIf"],[1,"detail-link",3,"routerLink"],["color","accent",3,"matTooltip",4,"ngIf"],["color","warn",3,"matTooltip",4,"ngIf"],["color","accent",3,"matTooltip"],["color","warn",3,"matTooltip"]],template:function(t,e){1&t&&(y.Xb(0,"os-head-bar"),y.Xb(1,"div",0),y.Sc(2),y.kc(3,"translate"),y.Wb(),y.Wb(),y.Xb(4,"os-list-view-table",1),y.Qc(5,R,4,2,"div",2),y.Qc(6,T,4,2,"div",2),y.Qc(7,x,5,4,"div",2),y.Qc(8,Q,3,2,"div",2),y.Wb()),2&t&&(y.Fb(2),y.Tc(y.lc(3,10,"List of electronic votes")),y.Fb(2),y.rc("listObservableProvider",e.polls)("vScrollFixed",64)("columns",e.tableColumnDefinition)("filterProps",e.filterProps)("filterService",e.filterService),y.Fb(1),y.rc("pblNgridCellDef","title"),y.Fb(1),y.rc("pblNgridCellDef","classType"),y.Fb(1),y.rc("pblNgridCellDef","state"),y.Fb(1),y.rc("pblNgridCellDef","votability"))},directives:[P.a,j.a,W.b,s.t,p.i,X.a,C.c],pipes:[k.j],styles:[""]}),N),pathMatch:"full"}],Y=((L=function t(){o(this,t)}).\u0275mod=y.Pb({type:L}),L.\u0275inj=y.Ob({factory:function(t){return new(t||L)},imports:[[p.j.forChild(U)],p.j]}),L),z=r("PCNd"),B=((A=function t(){o(this,t)}).\u0275mod=y.Pb({type:A}),A.\u0275inj=y.Ob({factory:function(t){return new(t||A)},imports:[[s.c,Y,z.a]]}),A)},cMzF:function(t,e,n){"use strict";n.d(e,"a",(function(){return W}));var r=n("s7LF"),a=n("iELJ"),s=n("qnZ9"),u=n("ykax"),b=n("b1ae"),p=n("5NaA"),f=n("8fOK"),d=n("8Y7J"),v=n("cUpR"),h=n("TSSN"),g=n("zHaW"),m=n("SVse"),y=n("Dxy4"),k=n("acT5"),S=n("pMoy"),F=n("Q2Ze"),w=["pollForm"];function O(t,e){1&t&&(d.Xb(0,"mat-error"),d.Sc(1),d.kc(2,"translate"),d.Wb()),2&t&&(d.Fb(1),d.Uc(" ",d.lc(2,1,"Error in form field."),""))}function P(t,e){if(1&t){var n=d.Yb();d.Xb(0,"div"),d.Xb(1,"mat-checkbox",14),d.fc("ngModelChange",(function(t){return d.Gc(n),d.jc(2).publishImmediately=t}))("change",(function(t){return d.Gc(n),d.jc(2).publishStateChanged(t.checked)})),d.Xb(2,"span"),d.Sc(3),d.kc(4,"translate"),d.Wb(),d.Wb(),d.Qc(5,O,3,3,"mat-error",2),d.Wb()}if(2&t){var o=d.jc(2);d.Fb(1),d.rc("ngModel",o.publishImmediately),d.Fb(2),d.Tc(d.lc(4,3,"Publish immediately")),d.Fb(2),d.rc("ngIf",!o.dialogVoteForm.valid)}}function j(t,e){if(1&t&&(d.Vb(0),d.Xb(1,"div",6),d.Xb(2,"form",7),d.Sb(3,"os-check-input",8),d.kc(4,"translate"),d.kc(5,"translate"),d.Sb(6,"os-check-input",9),d.kc(7,"translate"),d.kc(8,"translate"),d.Sb(9,"os-check-input",10),d.kc(10,"translate"),d.kc(11,"translate"),d.Sb(12,"os-check-input",11),d.kc(13,"translate"),d.Sb(14,"os-check-input",12),d.kc(15,"translate"),d.Sb(16,"os-check-input",13),d.kc(17,"translate"),d.Wb(),d.Wb(),d.Qc(18,P,6,5,"div",2),d.Ub()),2&t){var n=d.jc();d.Fb(2),d.rc("formGroup",n.dialogVoteForm),d.Fb(1),d.rc("placeholder",d.lc(4,14,"Yes"))("checkboxValue",-1)("checkboxLabel",d.lc(5,16,"majority")),d.Fb(3),d.rc("placeholder",d.lc(7,18,"No"))("checkboxValue",-1)("checkboxLabel",d.lc(8,20,"majority")),d.Fb(3),d.rc("placeholder",d.lc(10,22,"Abstain"))("checkboxValue",-1)("checkboxLabel",d.lc(11,24,"majority")),d.Fb(3),d.rc("placeholder",d.lc(13,26,"Valid votes")),d.Fb(2),d.rc("placeholder",d.lc(15,28,"Invalid votes")),d.Fb(2),d.rc("placeholder",d.lc(17,30,"Total votes cast")),d.Fb(2),d.rc("ngIf",!n.pollData.isPublished)}}var W=function(){var t=function(t){c(n,t);var e=l(n);function n(t,r,i,c,a,l,s){var u;return o(this,n),(u=e.call(this,t,r,i,a)).motionPollService=c,u.dialogRef=a,u.formBuilder=l,u.pollData=s,u.PercentBaseVerbose=f.b,u}return i(n,[{key:"ngOnInit",value:function(){this.createDialog()}},{key:"updateDialogVoteForm",value:function(t){if(this.dialogVoteForm){var e=this.undoReplaceEmptyValues({Y:t.options[0].yes,N:t.options[0].no,A:t.options[0].abstain,votesvalid:t.votesvalid,votesinvalid:t.votesinvalid,votescast:t.votescast});this.dialogVoteForm.setValue(e)}}},{key:"createDialog",value:function(){this.dialogVoteForm=this.formBuilder.group({Y:["",[r.H.min(s.b)]],N:["",[r.H.min(s.b)]],A:["",[r.H.min(s.b)]],votesvalid:["",[r.H.min(s.b)]],votesinvalid:["",[r.H.min(s.b)]],votescast:["",[r.H.min(s.b)]]}),this.pollData&&this.pollData.poll&&this.updateDialogVoteForm(this.pollData)}}]),n}(b.a);return t.\u0275fac=function(e){return new(e||t)(d.Rb(v.c),d.Rb(h.k),d.Rb(g.a),d.Rb(u.a),d.Rb(a.h),d.Rb(r.g),d.Rb(a.a))},t.\u0275cmp=d.Lb({type:t,selectors:[["os-motion-poll-dialog"]],viewQuery:function(t,e){var n;1&t&&d.Yc(w,!0),2&t&&d.Bc(n=d.gc())&&(e.pollForm=n.first)},features:[d.Cb],decls:12,vars:12,consts:[[3,"data","pollService","percentBases"],["pollForm",""],[4,"ngIf"],["mat-dialog-actions",""],["mat-button","",3,"disabled","click"],["mat-button","",3,"mat-dialog-close"],["mat-dialog-content","",1,"os-form-card-mobile"],[3,"formGroup"],["inputType","number","formControlName","Y",3,"placeholder","checkboxValue","checkboxLabel"],["inputType","number","formControlName","N",3,"placeholder","checkboxValue","checkboxLabel"],["inputType","number","formControlName","A",3,"placeholder","checkboxValue","checkboxLabel"],["inputType","number","formControlName","votesvalid",3,"placeholder"],["inputType","number","formControlName","votesinvalid",3,"placeholder"],["inputType","number","formControlName","votescast",3,"placeholder"],[3,"ngModel","ngModelChange","change"]],template:function(t,e){if(1&t&&(d.Sb(0,"os-poll-form",0,1),d.Qc(2,j,19,32,"ng-container",2),d.Xb(3,"div",3),d.Xb(4,"button",4),d.fc("click",(function(){return e.submitPoll()})),d.Xb(5,"span"),d.Sc(6),d.kc(7,"translate"),d.Wb(),d.Wb(),d.Xb(8,"button",5),d.Xb(9,"span"),d.Sc(10),d.kc(11,"translate"),d.Wb(),d.Wb(),d.Wb()),2&t){var n=d.Cc(1);d.rc("data",e.pollData)("pollService",e.motionPollService)("percentBases",e.PercentBaseVerbose),d.Fb(2),d.rc("ngIf","analog"===n.contentForm.get("type").value),d.Fb(2),d.rc("disabled",n.contentForm.invalid||e.dialogVoteForm.invalid),d.Fb(2),d.Tc(d.lc(7,8,"Save")),d.Fb(2),d.rc("mat-dialog-close",!1),d.Fb(2),d.Tc(d.lc(11,10,"Cancel"))}},directives:[p.a,m.t,a.c,y.b,a.d,a.f,r.J,r.u,r.l,k.a,r.t,r.j,S.a,r.w,F.b],pipes:[h.j],styles:[""]}),t}()},g4jF:function(t,e,n){"use strict";n.d(e,"a",(function(){return d}));var r=n("mrSG"),a=n("Cfvw"),s=n("pLZG"),u=n("lJxs"),b=(n("OwvW"),n("g96W")),p=(n("iN2a"),n("R+Vs"),n("DNKu"),n("F48D"),n("mV3u")),f=(n("0NHH"),n("8Y7J")),d=function(){var t=function(t){c(n,t);var e=l(n);function n(t,r,i,c,a,l,s,u,p,f,d,v){var h;return o(this,n),(h=e.call(this,t,r,i)).translate=r,h.repo=c,h.route=a,h.groupRepo=l,h.promptService=s,h.pollDialog=u,h.pollService=p,h.votesRepo=f,h.operator=d,h.cd=v,h.userGroups=[],h.groupObservable=null,h.voteOptionStyle={Y:{css:"yes",icon:"thumb_up"},N:{css:"no",icon:"thumb_down"},A:{css:"abstain",icon:"trip_origin"}},h.poll=null,h.labels=[],h.optionsLoaded=new b.a,h.setup(),h}return i(n,[{key:"setup",value:function(){return Object(r.a)(this,void 0,void 0,regeneratorRuntime.mark((function t(){var e=this;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.optionsLoaded;case 2:this.votesRepo.getViewModelListObservable().pipe(Object(s.a)((function(){return e.poll&&e.canSeeVotes})),Object(u.a)((function(t){return t.filter((function(t){return t.option.poll_id===e.poll.id}))})),Object(s.a)((function(t){return!!t.length}))).subscribe((function(){e.createVotesData()}));case 3:case"end":return t.stop()}}),t,this)})))}},{key:"ngOnInit",value:function(){var t=this;this.findComponentById(),this.groupObservable=this.groupRepo.getViewModelListObservable(),this.subscriptions.push(this.groupRepo.getViewModelListObservable().subscribe((function(e){return t.userGroups=e})))}},{key:"deletePoll",value:function(){return Object(r.a)(this,void 0,void 0,regeneratorRuntime.mark((function t(){var e,n=this;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=this.translate.instant("Are you sure you want to delete this vote?"),t.next=3,this.promptService.open(e);case 3:if(t.t0=t.sent,!t.t0){t.next=6;break}this.repo.delete(this.poll).then((function(){return n.onDeleted()}),this.raiseError);case 6:case"end":return t.stop()}}),t,this)})))}},{key:"pseudoanonymizePoll",value:function(){return Object(r.a)(this,void 0,void 0,regeneratorRuntime.mark((function t(){var e;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=this.translate.instant("Are you sure you want to anonymize all votes? This cannot be undone."),t.next=3,this.promptService.open(e);case 3:if(t.t0=t.sent,!t.t0){t.next=6;break}this.repo.pseudoanonymize(this.poll).catch(this.raiseError);case 6:case"end":return t.stop()}}),t,this)})))}},{key:"openDialog",value:function(t){this.pollDialog.openDialog(t)}},{key:"onStateChanged",value:function(){}},{key:"setVotesData",value:function(t){this.votesDataObservable=t.every((function(t){return!t.user}))?null:Object(a.a)([t])}},{key:"findComponentById",value:function(){var t=this,e=this.route.snapshot.params;e&&e.id&&this.subscriptions.push(this.repo.getViewModelObservable(e.id).subscribe((function(e){e&&(t.poll=e,t.createVotesData(),t.optionsLoaded.resolve(),t.cd.markForCheck())})))}},{key:"userHasVoteDelegation",value:function(t){return!!t.isVoteRightDelegated||!!this.operator.viewUser.canVoteFor(t)}},{key:"getUsersVoteDelegation",value:function(t){return t.voteDelegatedTo?t.voteDelegatedTo:this.operator.viewUser.canVoteFor(t)?this.operator.viewUser:void 0}},{key:"canSeeVotes",get:function(){return this.hasPerms&&this.poll.isFinished||this.poll.isPublished}}]),n}(p.a);return t.\u0275fac=function(t){f.ec()},t.\u0275dir=f.Mb({type:t,features:[f.Cb]}),t}()},tSYa:function(t,e,n){"use strict";n.r(e),n.d(e,"MotionPollModule",(function(){return ut}));var r=n("SVse"),a=n("PCNd"),s=n("bVYn"),u=n("iInd"),b=n("OwvW"),p=n("acQf"),f=n("chQs"),d=n("R+Vs"),v=n("+KbT"),h=n("F48D"),g=n("SHqy"),m=n("ykax"),y=n("g4jF"),k=n("8Y7J"),S=n("cUpR"),F=n("TSSN"),w=n("zHaW"),O=n("mksl"),P=n("3Xi6"),j=n("PDjf"),W=n("rJgo"),X=n("BSbQ"),C=n("Dxy4"),D=n("Tj54"),R=n("76GY"),V=n("0Obk"),T=n("4LpT"),_=n("Tp2j");function x(t,e){if(1&t&&(k.Xb(0,"h2"),k.Sc(1),k.kc(2,"translate"),k.Wb()),2&t){var n=k.jc();k.Fb(1),k.Vc("",k.lc(2,2,"Motion")," ",n.poll.motion.identifierOrTitle,"")}}function M(t,e){if(1&t&&(k.Xb(0,"div",11),k.Xb(1,"button",12),k.Xb(2,"mat-icon"),k.Sc(3,"more_vert"),k.Wb(),k.Wb(),k.Wb()),2&t){k.jc();var n=k.Cc(9);k.Fb(1),k.rc("matMenuTriggerFor",n)}}function I(t,e){if(1&t&&(k.Xb(0,"span"),k.Sc(1),k.kc(2,"translate"),k.Wb()),2&t){var n=k.jc(3);k.Fb(1),k.Uc(" ",k.lc(2,1,n.poll.typeVerbose)," \xb7 ")}}function Q(t,e){if(1&t&&(k.Xb(0,"div"),k.Sc(1),k.kc(2,"translate"),k.Wb()),2&t){var n=e.col;k.Fb(1),k.Uc(" ",k.lc(2,1,n.label)," ")}}function N(t,e){if(1&t&&(k.Xb(0,"div"),k.Sc(1),k.Wb()),2&t){var n=k.jc(2).row;k.Fb(1),k.Uc(" ",n.user.getLevelAndNumber()," ")}}function L(t,e){if(1&t&&(k.Xb(0,"div"),k.Sc(1),k.kc(2,"translate"),k.Wb()),2&t){var n=k.jc(2).row;k.Fb(1),k.Vc(" ",k.lc(2,2,"Vote weight"),": ",n.user.vote_weight," ")}}function A(t,e){if(1&t&&(k.Xb(0,"div"),k.Xb(1,"span"),k.Sc(2),k.kc(3,"translate"),k.Wb(),k.Wb()),2&t){var n=k.jc(2).row,o=k.jc(5);k.Fb(2),k.Vc(" (",k.lc(3,2,"represented by")," ",o.getUsersVoteDelegation(n.user).getShortName().trim(),") ")}}function U(t,e){if(1&t&&(k.Xb(0,"div"),k.Sc(1),k.Xb(2,"div",22),k.Qc(3,N,2,1,"div",2),k.Qc(4,L,3,4,"div",2),k.Qc(5,A,4,4,"div",2),k.Wb(),k.Wb()),2&t){var n=k.jc().row,o=k.jc(5);k.Fb(1),k.Uc(" ",n.user.getShortName()," "),k.Fb(2),k.rc("ngIf",n.user.getLevelAndNumber()),k.Fb(1),k.rc("ngIf",o.isVoteWeightActive),k.Fb(1),k.rc("ngIf",o.userHasVoteDelegation(n.user))}}function Y(t,e){1&t&&(k.Xb(0,"div"),k.Sc(1),k.kc(2,"translate"),k.Wb()),2&t&&(k.Fb(1),k.Tc(k.lc(2,1,"Anonymous")))}function z(t,e){if(1&t&&(k.Xb(0,"div"),k.Qc(1,U,6,4,"div",2),k.Qc(2,Y,3,3,"div",2),k.Wb()),2&t){var n=e.row;k.Fb(1),k.rc("ngIf",n.user),k.Fb(1),k.rc("ngIf",!n.user)}}function B(t,e){if(1&t&&(k.Xb(0,"div",23),k.Xb(1,"div",24),k.Xb(2,"mat-icon"),k.Sc(3),k.Wb(),k.Wb(),k.Xb(4,"div"),k.Sc(5),k.kc(6,"translate"),k.Wb(),k.Wb()),2&t){var n=e.row,o=k.jc(5);k.Fb(1),k.rc("ngClass",o.voteOptionStyle[n.value].css),k.Fb(2),k.Tc(o.voteOptionStyle[n.value].icon),k.Fb(2),k.Tc(k.lc(6,3,n.valueVerbose))}}function H(t,e){if(1&t&&(k.Xb(0,"os-list-view-table",18),k.Qc(1,Q,3,3,"div",19),k.Qc(2,z,3,2,"div",20),k.Qc(3,B,7,5,"div",21),k.Wb()),2&t){var n=k.jc(4);k.rc("listObservable",n.votesDataObservable)("columns",n.columnDefinition)("filterProps",n.filterProps)("allowProjector",!1)("fullScreen",!0)("vScrollFixed",-1),k.Fb(1),k.rc("pblNgridHeaderCellDef","*"),k.Fb(1),k.rc("pblNgridCellDef","user"),k.Fb(1),k.rc("pblNgridCellDef","vote")}}function G(t,e){1&t&&(k.Xb(0,"div"),k.Sc(1),k.kc(2,"translate"),k.Wb()),2&t&&(k.Fb(1),k.Uc(" ",k.lc(2,1,"The individual votes were anonymized.")," "))}function J(t,e){if(1&t&&(k.Xb(0,"div",16),k.Xb(1,"h2"),k.Sc(2),k.kc(3,"translate"),k.Wb(),k.Qc(4,H,4,9,"os-list-view-table",17),k.Qc(5,G,3,3,"div",2),k.Wb()),2&t){var n=k.jc(3);k.Fb(2),k.Tc(k.lc(3,3,"Single votes")),k.Fb(2),k.rc("ngIf",n.votesDataObservable),k.Fb(1),k.rc("ngIf",!n.votesDataObservable)}}function E(t,e){1&t&&(k.Xb(0,"span"),k.Sc(1,", "),k.Wb())}function K(t,e){if(1&t&&(k.Xb(0,"span"),k.Sc(1),k.kc(2,"translate"),k.Qc(3,E,2,0,"span",2),k.Wb()),2&t){var n=e.$implicit,o=e.index,r=k.jc(4);k.Fb(1),k.Uc(" ",k.lc(2,2,n.getTitle()),""),k.Fb(2),k.rc("ngIf",o<r.poll.groups.length-1)}}function q(t,e){if(1&t&&(k.Xb(0,"small"),k.Sc(1),k.kc(2,"translate"),k.Qc(3,K,4,4,"span",25),k.Wb()),2&t){var n=k.jc(3);k.Fb(1),k.Uc(" ",k.lc(2,2,"Groups"),": "),k.Fb(2),k.rc("ngForOf",n.poll.groups)}}function Z(t,e){if(1&t&&(k.Vb(0),k.Xb(1,"h1"),k.Sc(2),k.kc(3,"translate"),k.Wb(),k.Xb(4,"div"),k.Qc(5,I,3,3,"span",2),k.Xb(6,"span"),k.Sc(7),k.kc(8,"translate"),k.Wb(),k.Wb(),k.Sb(9,"os-motion-poll-detail-content",13),k.Qc(10,J,6,5,"div",14),k.Xb(11,"div",15),k.Qc(12,q,4,4,"small",2),k.Xb(13,"small"),k.Sc(14),k.kc(15,"translate"),k.kc(16,"translate"),k.Wb(),k.Wb(),k.Ub()),2&t){var n=k.jc(2);k.Fb(2),k.Tc(k.lc(3,8,n.poll.title)),k.Fb(3),k.rc("ngIf","analog"!==n.poll.type),k.Fb(2),k.Uc(" ",k.lc(8,10,n.poll.stateVerbose)," "),k.Fb(2),k.rc("poll",n.poll),k.Fb(1),k.rc("ngIf",n.showResults&&n.poll.stateHasVotes&&"named"===n.poll.type),k.Fb(2),k.rc("ngIf",n.poll.groups&&n.poll.type&&"analog"!==n.poll.type),k.Fb(2),k.Vc("",k.lc(15,12,"100% base"),": ",k.lc(16,14,n.poll.percentBaseVerbose),"")}}function $(t,e){if(1&t&&k.Qc(0,Z,17,16,"ng-container",2),2&t){var n=k.jc();k.rc("ngIf",n.poll)}}function tt(t,e){if(1&t&&k.Sb(0,"os-projector-button",26),2&t){var n=k.jc();k.rc("menuItem",!0)("object",n.poll)}}function et(t,e){if(1&t){var n=k.Yb();k.Xb(0,"button",27),k.fc("click",(function(){k.Gc(n);var t=k.jc();return t.openDialog(t.poll)})),k.Xb(1,"mat-icon"),k.Sc(2,"edit"),k.Wb(),k.Xb(3,"span"),k.Sc(4),k.kc(5,"translate"),k.Wb(),k.Wb()}2&t&&(k.Fb(4),k.Tc(k.lc(5,1,"Edit")))}function nt(t,e){if(1&t){var n=k.Yb();k.Xb(0,"button",27),k.fc("click",(function(){return k.Gc(n),k.jc().pseudoanonymizePoll()})),k.Xb(1,"mat-icon"),k.Sc(2,"warning"),k.Wb(),k.Xb(3,"span"),k.Sc(4),k.kc(5,"translate"),k.Wb(),k.Wb()}2&t&&(k.Fb(4),k.Tc(k.lc(5,1,"Anonymize votes")))}function ot(t,e){if(1&t){var n=k.Yb();k.Xb(0,"button",27),k.fc("click",(function(){return k.Gc(n),k.jc().deletePoll()})),k.Xb(1,"mat-icon",28),k.Sc(2,"delete"),k.Wb(),k.Xb(3,"span"),k.Sc(4),k.kc(5,"translate"),k.Wb(),k.Wb()}2&t&&(k.Fb(4),k.Tc(k.lc(5,1,"Delete")))}var rt,it,ct,at=((rt=function(t){c(n,t);var e=l(n);function n(t,r,i,c,a,l,s,u,b,p,f,d,v,h){var g;return o(this,n),(g=e.call(this,t,r,i,c,a,l,s,u,b,p,d,h)).operator=d,g.router=v,g.cd=h,g.columnDefinition=[{prop:"user",width:"auto",label:"Participant"},{prop:"vote",width:"auto",label:"Vote"}],g.filterProps=["user.getFullName","valueVerbose"],f.get("users_activate_vote_weight").subscribe((function(t){return g.isVoteWeightActive=t})),g}return i(n,[{key:"createVotesData",value:function(){this.setVotesData(this.poll.options[0].votes)}},{key:"openDialog",value:function(){this.pollDialog.openDialog(this.poll)}},{key:"onDeleted",value:function(){this.router.navigate(["motions",this.poll.motion_id])}},{key:"hasPerms",value:function(){return this.operator.hasPerms(b.b.motionsCanManagePolls)}},{key:"showResults",get:function(){return this.hasPerms()||this.poll.isPublished}}]),n}(y.a)).\u0275fac=function(t){return new(t||rt)(k.Rb(S.c),k.Rb(F.k),k.Rb(w.a),k.Rb(p.a),k.Rb(u.a),k.Rb(d.a),k.Rb(h.a),k.Rb(g.a),k.Rb(m.a),k.Rb(f.a),k.Rb(v.a),k.Rb(b.a),k.Rb(u.f),k.Rb(k.h))},rt.\u0275cmp=k.Lb({type:rt,selectors:[["os-motion-poll-detail"]],features:[k.Cb],decls:15,vars:10,consts:[[3,"goBack","nav"],[1,"title-slot"],[4,"ngIf"],["class","menu-slot",4,"osPerms"],[1,"os-card","spacer-bottom-60"],[3,"ngTemplateOutlet"],["viewTemplate",""],["pollDetailMenu","matMenu"],[3,"menuItem","object",4,"osPerms"],["mat-menu-item","",3,"click",4,"osPerms"],["mat-menu-item","",3,"click",4,"osPerms","osPermsAnd"],[1,"menu-slot"],["type","button","mat-icon-button","",3,"matMenuTriggerFor"],[3,"poll"],["class","named-result-table",4,"ngIf"],[1,"poll-content"],[1,"named-result-table"],["class","single-votes-table","listStorageKey","motion-poll-vote",3,"listObservable","columns","filterProps","allowProjector","fullScreen","vScrollFixed",4,"ngIf"],["listStorageKey","motion-poll-vote",1,"single-votes-table",3,"listObservable","columns","filterProps","allowProjector","fullScreen","vScrollFixed"],[4,"pblNgridHeaderCellDef"],[4,"pblNgridCellDef"],["class","vote-cell",4,"pblNgridCellDef"],[1,"user-subtitle"],[1,"vote-cell"],[1,"vote-cell-icon-container",3,"ngClass"],[4,"ngFor","ngForOf"],[3,"menuItem","object"],["mat-menu-item","",3,"click"],["color","warn"]],template:function(t,e){if(1&t&&(k.Xb(0,"os-head-bar",0),k.Xb(1,"div",1),k.Qc(2,x,3,4,"h2",2),k.Wb(),k.Qc(3,M,4,1,"div",3),k.Wb(),k.Xb(4,"mat-card",4),k.Tb(5,5),k.Wb(),k.Qc(6,$,1,1,"ng-template",null,6,k.Rc),k.Xb(8,"mat-menu",null,7),k.Qc(10,tt,1,2,"os-projector-button",8),k.Qc(11,et,6,3,"button",9),k.Qc(12,nt,6,3,"button",10),k.Sb(13,"mat-divider"),k.Qc(14,ot,6,3,"button",9),k.Wb()),2&t){var n=k.Cc(7);k.rc("goBack",!0)("nav",!1),k.Fb(2),k.rc("ngIf",e.poll),k.Fb(1),k.rc("osPerms","motions.can_manage_polls"),k.Fb(2),k.rc("ngTemplateOutlet",n),k.Fb(5),k.rc("osPerms","core.can_manage_projector"),k.Fb(1),k.rc("osPerms","motions.can_manage_polls"),k.Fb(1),k.rc("osPerms","motions.can_manage_polls")("osPermsAnd",e.poll&&"named"===e.poll.type),k.Fb(2),k.rc("osPerms","motions.can_manage_polls")}},directives:[O.a,r.t,P.a,j.a,r.A,W.f,X.a,C.b,W.e,D.a,R.a,V.a,T.g,T.b,r.q,r.s,_.a,W.c],pipes:[F.j],styles:[".yes{color:#4caf50}.no{color:#cc6c5b}.abstain{color:#a6a6a6}.voted-yes{background-color:#4caf50;color:#fff}.voted-no{background-color:#cc6c5b;color:#fff}.voted-abstain{background-color:#a6a6a6;color:#fff}.start-poll-button{color:#4caf50}.stop-poll-button{color:#ff5252}.publish-poll-button{color:#e6b100}.poll-content{text-align:right;display:grid;padding-top:20px}.named-result-table{grid-area:names}.named-result-table .mat-form-field{font-size:14px;width:100%}.named-result-table .vote-cell,.named-result-table .vote-cell .vote-cell-icon-container{display:-ms-flexbox;display:flex;-ms-flex-align:center;align-items:center}.named-result-table .vote-cell .vote-cell-icon-container{margin-right:7px}.single-votes-table{display:block;height:500px}.single-votes-table .list-view-frame{height:100%}.openslides-theme .pbl-ngrid-no-data{top:10%}"],encapsulation:2,changeDetection:0}),rt),lt=[{path:"new",component:at},{path:":id",component:at}],st=((ct=function t(){o(this,t)}).\u0275mod=k.Pb({type:ct}),ct.\u0275inj=k.Ob({factory:function(t){return new(t||ct)},imports:[[u.j.forChild(lt)],u.j]}),ct),ut=((it=function t(){o(this,t)}).\u0275mod=k.Pb({type:it}),it.\u0275inj=k.Ob({factory:function(t){return new(t||it)},imports:[[r.c,a.a,st,s.PollsModule]]}),it)},wL0i:function(e,n,r){"use strict";r.d(n,"a",(function(){return a}));var a=function(e){c(r,e);var n=l(r);function r(t,e,i,c){var a;return o(this,r),(a=n.call(this,t,e,i)).storage=c,a.canMultiSelect=!1,a._multiSelectMode=!1,a.singleButtonWidth="40px",a.badgeButtonWidth="45px",a.selectedRows=[],a}return i(r,[{key:"onDataSourceChange",value:function(t){this.dataSource=t}},{key:"toggleMultiSelect",value:function(){!this.canMultiSelect||this.isMultiSelect?(this._multiSelectMode=!1,this.deselectAll()):this._multiSelectMode=!0}},{key:"selectAll",value:function(){var e;(e=this.dataSource.selection).select.apply(e,t(this.dataSource.filteredData))}},{key:"deselectAll",value:function(){this.dataSource&&this.dataSource.selection.clear()}},{key:"isMultiSelect",get:function(){return this._multiSelectMode}}]),r}(r("mV3u").a)}}])}();